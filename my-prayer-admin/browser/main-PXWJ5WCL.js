import{b as Sl,c as wl,f as Du,g as Cl}from"./chunk-X5YLR3NI.js";import{$ as C,$a as $,A as Wa,Aa as gr,Ab as fl,B as ur,Ba as Ye,Bb as ye,C as Et,Ca as al,Cb as ml,D as Gs,Da as zt,Db as Xi,E as Ya,Ea as ll,Eb as pl,F as Ka,Fa as Xs,Fb as gl,G as Za,Ga as X,Gb as en,H as hr,Ha as oe,Hb as _l,I as qe,Ia as K,Ib as we,J as fr,Ja as eo,Jb as Ue,K as Se,Ka as Ke,Kb as ae,L as ie,La as Gt,Lb as vl,M as et,Ma as D,Mb as yl,N as k,Na as _r,Nb as oo,O as se,Oa as vr,Ob as bl,P as Ja,Pa as Ji,Pb as xl,Q as G,Qa as to,R as qs,Ra as io,S as N,Sa as qt,T as A,Ta as b,U as Ws,Ua as hi,V as Qa,Va as no,W as Bt,Wa as d,X as Xa,Xa as h,Y as Wi,Ya as ee,Z as tt,Za as it,_ as Mt,_a as nt,a as Ua,aa as T,ab as S,b as $a,ba as We,bb as y,c as Ba,ca as el,cb as yr,d as Us,da as ui,db as ro,e as $s,ea as tl,eb as p,f as Ve,fa as il,fb as ne,g as je,ga as fe,gb as ce,h as Ct,ha as Ie,hb as ve,i as Ce,ia as Ys,ib as R,j as V,ja as Ks,jb as O,k as qi,ka as Pe,kb as P,l as Ha,la as nl,lb as Te,m as za,ma as mr,mb as cl,n as z,na as rl,nb as Ze,o as li,oa as Ht,ob as It,p as Oe,pa as Zs,pb as kt,q as Bs,qa as Yi,qb as so,r as dr,ra as sl,rb as br,s as Hs,sa as Js,sb as fi,t as Ga,ta as Ki,tb as dl,u as $t,ua as Qs,ub as At,v as ci,va as ol,vb as Qi,w as di,wa as Zi,wb as Dt,x as qa,xa as _,xb as ul,y as zs,ya as I,yb as mi,z as Tt,za as pr,zb as hl}from"./chunk-JBPUC46J.js";import{a as E,b as Y,e as pt,g as ku,h as Au,i as f}from"./chunk-ODN5LVDJ.js";var ia=pt(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});var ea=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}};ta.default=ea});var ra=pt(In=>{"use strict";var Oc=In&&In.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(In,"__esModule",{value:!0});var Qf=Oc((Cl(),Au(Du))),Xf=Oc(ia()),na=class{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=Qf.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,e){return this.headers=Object.assign({},this.headers),this.headers[i]=e,this}then(i,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let t=this.fetch,r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>f(this,null,function*(){var o,l,a;let c=null,u=null,v=null,x=s.status,w=s.statusText;if(s.ok){if(this.method!=="HEAD"){let Z=yield s.text();Z===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=Z:u=JSON.parse(Z))}let M=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),F=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");M&&F&&F.length>1&&(v=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,v=null,x=406,w="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{let M=yield s.text();try{c=JSON.parse(M),Array.isArray(c)&&s.status===404&&(u=[],c=null,x=200,w="OK")}catch{s.status===404&&M===""?(x=204,w="No Content"):c={message:M}}if(c&&this.isMaybeSingle&&(!((a=c?.details)===null||a===void 0)&&a.includes("0 rows"))&&(c=null,x=200,w="OK"),c&&this.shouldThrowOnError)throw new Xf.default(c)}return{error:c,data:u,count:v,status:x,statusText:w}}));return this.shouldThrowOnError||(r=r.catch(s=>{var o,l,a;return{error:{message:`${(o=s?.name)!==null&&o!==void 0?o:"FetchError"}: ${s?.message}`,details:`${(l=s?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s?.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(i,e)}};In.default=na});var oa=pt(kn=>{"use strict";var em=kn&&kn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(kn,"__esModule",{value:!0});var tm=em(ra()),sa=class extends tm.default{select(i){let e=!1,t=(i??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:e=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){let o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${i}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:e,referencedTable:t=e}={}){let r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${i}`),this}range(i,e,{foreignTable:t,referencedTable:r=t}={}){let s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${i}`),this.url.searchParams.set(o,`${e-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:e=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var l;let a=[i?"analyze":null,e?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`,o==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};kn.default=sa});var Wr=pt(An=>{"use strict";var im=An&&An.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(An,"__esModule",{value:!0});var nm=im(oa()),aa=class extends nm.default{eq(i,e){return this.url.searchParams.append(i,`eq.${e}`),this}neq(i,e){return this.url.searchParams.append(i,`neq.${e}`),this}gt(i,e){return this.url.searchParams.append(i,`gt.${e}`),this}gte(i,e){return this.url.searchParams.append(i,`gte.${e}`),this}lt(i,e){return this.url.searchParams.append(i,`lt.${e}`),this}lte(i,e){return this.url.searchParams.append(i,`lte.${e}`),this}like(i,e){return this.url.searchParams.append(i,`like.${e}`),this}likeAllOf(i,e){return this.url.searchParams.append(i,`like(all).{${e.join(",")}}`),this}likeAnyOf(i,e){return this.url.searchParams.append(i,`like(any).{${e.join(",")}}`),this}ilike(i,e){return this.url.searchParams.append(i,`ilike.${e}`),this}ilikeAllOf(i,e){return this.url.searchParams.append(i,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(i,e){return this.url.searchParams.append(i,`ilike(any).{${e.join(",")}}`),this}is(i,e){return this.url.searchParams.append(i,`is.${e}`),this}in(i,e){let t=Array.from(new Set(e)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(i,`in.(${t})`),this}contains(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cs.{${e.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(e)}`),this}containedBy(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cd.{${e.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(e)}`),this}rangeGt(i,e){return this.url.searchParams.append(i,`sr.${e}`),this}rangeGte(i,e){return this.url.searchParams.append(i,`nxl.${e}`),this}rangeLt(i,e){return this.url.searchParams.append(i,`sl.${e}`),this}rangeLte(i,e){return this.url.searchParams.append(i,`nxr.${e}`),this}rangeAdjacent(i,e){return this.url.searchParams.append(i,`adj.${e}`),this}overlaps(i,e){return typeof e=="string"?this.url.searchParams.append(i,`ov.${e}`):this.url.searchParams.append(i,`ov.{${e.join(",")}}`),this}textSearch(i,e,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");let o=t===void 0?"":`(${t})`;return this.url.searchParams.append(i,`${s}fts${o}.${e}`),this}match(i){return Object.entries(i).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(i,e,t){return this.url.searchParams.append(i,`not.${e}.${t}`),this}or(i,{foreignTable:e,referencedTable:t=e}={}){let r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${i})`),this}filter(i,e,t){return this.url.searchParams.append(i,`${e}.${t}`),this}};An.default=aa});var ca=pt(Rn=>{"use strict";var rm=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Rn,"__esModule",{value:!0});var Dn=rm(Wr()),la=class{constructor(i,{headers:e={},schema:t,fetch:r}){this.url=i,this.headers=e,this.schema=t,this.fetch=r}select(i,{head:e=!1,count:t}={}){let r=e?"HEAD":"GET",s=!1,o=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Dn.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:e,defaultToNull:t=!0}={}){let r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(i)){let o=i.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){let l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Dn.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:e,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){let o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(i)){let a=i.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){let c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Dn.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:e}={}){let t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push(`count=${e}`),this.headers.Prefer=r.join(","),new Dn.default({method:t,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){let e="DELETE",t=[];return i&&t.push(`count=${i}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Dn.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Rn.default=la});var Pc=pt(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.version=void 0;Yr.version="0.0.0-automated"});var Nc=pt(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.DEFAULT_HEADERS=void 0;var sm=Pc();Kr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${sm.version}`}});var Lc=pt(On=>{"use strict";var Fc=On&&On.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(On,"__esModule",{value:!0});var om=Fc(ca()),am=Fc(Wr()),lm=Nc(),da=class n{constructor(i,{headers:e={},schema:t,fetch:r}={}){this.url=i,this.headers=Object.assign(Object.assign({},lm.DEFAULT_HEADERS),e),this.schemaName=t,this.fetch=r}from(i){let e=new URL(`${this.url}/${i}`);return new om.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,e={},{head:t=!1,get:r=!1,count:s}={}){let o,l=new URL(`${this.url}/rpc/${i}`),a;t||r?(o=t?"HEAD":"GET",Object.entries(e).filter(([u,v])=>v!==void 0).map(([u,v])=>[u,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([u,v])=>{l.searchParams.append(u,v)})):(o="POST",a=e);let c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new am.default({method:o,url:l,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};On.default=da});var zc=pt(xe=>{"use strict";var Mi=xe&&xe.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(xe,"__esModule",{value:!0});xe.PostgrestError=xe.PostgrestBuilder=xe.PostgrestTransformBuilder=xe.PostgrestFilterBuilder=xe.PostgrestQueryBuilder=xe.PostgrestClient=void 0;var Vc=Mi(Lc());xe.PostgrestClient=Vc.default;var jc=Mi(ca());xe.PostgrestQueryBuilder=jc.default;var Uc=Mi(Wr());xe.PostgrestFilterBuilder=Uc.default;var $c=Mi(oa());xe.PostgrestTransformBuilder=$c.default;var Bc=Mi(ra());xe.PostgrestBuilder=Bc.default;var Hc=Mi(ia());xe.PostgrestError=Hc.default;xe.default={PostgrestClient:Vc.default,PostgrestQueryBuilder:jc.default,PostgrestFilterBuilder:Uc.default,PostgrestTransformBuilder:$c.default,PostgrestBuilder:Bc.default,PostgrestError:Hc.default}});var lo=class extends fl{supportsDOMEvents=!0},co=class n extends lo{static makeCurrent(){hl(new n)}onAndCancel(i,e,t){return i.addEventListener(e,t),()=>{i.removeEventListener(e,t)}}dispatchEvent(i,e){i.dispatchEvent(e)}remove(i){i.remove()}createElement(i,e){return e=e||this.getDefaultDocument(),e.createElement(i)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(i){return i.nodeType===Node.ELEMENT_NODE}isShadowRoot(i){return i instanceof DocumentFragment}getGlobalEventTarget(i,e){return e==="window"?window:e==="document"?i:e==="body"?i.body:null}getBaseHref(i){let e=Ou();return e==null?null:Pu(e)}resetBaseElement(){tn=null}getUserAgent(){return window.navigator.userAgent}getCookie(i){return _l(document.cookie,i)}},tn=null;function Ou(){return tn=tn||document.querySelector("base"),tn?tn.getAttribute("href"):null}function Pu(n){return new URL(n,document.baseURI).pathname}var Nu=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),uo=new G(""),kl=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,t){this._zone=t,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,t,r){return this._findPluginFor(t).addEventListener(e,t,r)}getZone(){return this._zone}_findPluginFor(e){let t=this._eventNameToPlugin.get(e);if(t)return t;if(t=this._plugins.find(s=>s.supports(e)),!t)throw new ie(5101,!1);return this._eventNameToPlugin.set(e,t),t}static \u0275fac=function(t){return new(t||n)(N(uo),N(Ie))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),Sr=class{_doc;constructor(i){this._doc=i}manager},xr="ng-app-id";function Tl(n){for(let i of n)i.remove()}function El(n,i){let e=i.createElement("style");return e.textContent=n,e}function Fu(n,i,e,t){let r=n.head?.querySelectorAll(`style[${xr}="${i}"],link[${xr}="${i}"]`);if(r)for(let s of r)s.removeAttribute(xr),s instanceof HTMLLinkElement?t.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&e.set(s.textContent,{usage:0,elements:[s]})}function ho(n,i){let e=i.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var Al=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,t,r,s={}){this.doc=e,this.appId=t,this.nonce=r,this.isServer=oo(s),Fu(e,t,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,t){for(let r of e)this.addUsage(r,this.inline,El);t?.forEach(r=>this.addUsage(r,this.external,ho))}removeStyles(e,t){for(let r of e)this.removeUsage(r,this.inline);t?.forEach(r=>this.removeUsage(r,this.external))}addUsage(e,t,r){let s=t.get(e);s?s.usage++:t.set(e,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,r(e,this.doc)))})}removeUsage(e,t){let r=t.get(e);r&&(r.usage--,r.usage<=0&&(Tl(r.elements),t.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])Tl(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[t,{elements:r}]of this.inline)r.push(this.addElement(e,El(t,this.doc)));for(let[t,{elements:r}]of this.external)r.push(this.addElement(e,ho(t,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,t){return this.nonce&&t.setAttribute("nonce",this.nonce),this.isServer&&t.setAttribute(xr,this.appId),e.appendChild(t)}static \u0275fac=function(t){return new(t||n)(N(ye),N(mr),N(Yi,8),N(Ht))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),ao={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},po=/%COMP%/g,Dl="%COMP%",Lu=`_nghost-${Dl}`,Vu=`_ngcontent-${Dl}`,ju=!0,Uu=new G("",{providedIn:"root",factory:()=>ju});function $u(n){return Vu.replace(po,n)}function Bu(n){return Lu.replace(po,n)}function Rl(n,i){return i.map(e=>e.replace(po,n))}var wr=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,t,r,s,o,l,a,c=null){this.eventManager=e,this.sharedStylesHost=t,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=l,this.ngZone=a,this.nonce=c,this.platformIsServer=oo(l),this.defaultRenderer=new nn(e,o,a,this.platformIsServer)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;this.platformIsServer&&t.encapsulation===Ki.ShadowDom&&(t=Y(E({},t),{encapsulation:Ki.Emulated}));let r=this.getOrCreateRenderer(e,t);return r instanceof Cr?r.applyToHost(e):r instanceof rn&&r.applyStyles(),r}getOrCreateRenderer(e,t){let r=this.rendererByCompId,s=r.get(t.id);if(!s){let o=this.doc,l=this.ngZone,a=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,v=this.platformIsServer;switch(t.encapsulation){case Ki.Emulated:s=new Cr(a,c,t,this.appId,u,o,l,v);break;case Ki.ShadowDom:return new fo(a,c,e,t,o,l,this.nonce,v);default:s=new rn(a,c,t,u,o,l,v);break}r.set(t.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static \u0275fac=function(t){return new(t||n)(N(kl),N(Al),N(mr),N(Uu),N(ye),N(Ht),N(Ie),N(Yi))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),nn=class{eventManager;doc;ngZone;platformIsServer;data=Object.create(null);throwOnSyntheticProps=!0;constructor(i,e,t,r){this.eventManager=i,this.doc=e,this.ngZone=t,this.platformIsServer=r}destroy(){}destroyNode=null;createElement(i,e){return e?this.doc.createElementNS(ao[e]||e,i):this.doc.createElement(i)}createComment(i){return this.doc.createComment(i)}createText(i){return this.doc.createTextNode(i)}appendChild(i,e){(Ml(i)?i.content:i).appendChild(e)}insertBefore(i,e,t){i&&(Ml(i)?i.content:i).insertBefore(e,t)}removeChild(i,e){e.remove()}selectRootElement(i,e){let t=typeof i=="string"?this.doc.querySelector(i):i;if(!t)throw new ie(-5104,!1);return e||(t.textContent=""),t}parentNode(i){return i.parentNode}nextSibling(i){return i.nextSibling}setAttribute(i,e,t,r){if(r){e=r+":"+e;let s=ao[r];s?i.setAttributeNS(s,e,t):i.setAttribute(e,t)}else i.setAttribute(e,t)}removeAttribute(i,e,t){if(t){let r=ao[t];r?i.removeAttributeNS(r,e):i.removeAttribute(`${t}:${e}`)}else i.removeAttribute(e)}addClass(i,e){i.classList.add(e)}removeClass(i,e){i.classList.remove(e)}setStyle(i,e,t,r){r&(Zi.DashCase|Zi.Important)?i.style.setProperty(e,t,r&Zi.Important?"important":""):i.style[e]=t}removeStyle(i,e,t){t&Zi.DashCase?i.style.removeProperty(e):i.style[e]=""}setProperty(i,e,t){i!=null&&(i[e]=t)}setValue(i,e){i.nodeValue=e}listen(i,e,t){if(typeof i=="string"&&(i=mi().getGlobalEventTarget(this.doc,i),!i))throw new Error(`Unsupported event target ${i} for event ${e}`);return this.eventManager.addEventListener(i,e,this.decoratePreventDefault(t))}decoratePreventDefault(i){return e=>{if(e==="__ngUnwrap__")return i;(this.platformIsServer?this.ngZone.runGuarded(()=>i(e)):i(e))===!1&&e.preventDefault()}}};function Ml(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var fo=class extends nn{sharedStylesHost;hostEl;shadowRoot;constructor(i,e,t,r,s,o,l,a){super(i,s,o,a),this.sharedStylesHost=e,this.hostEl=t,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=Rl(r.id,r.styles);for(let v of c){let x=document.createElement("style");l&&x.setAttribute("nonce",l),x.textContent=v,this.shadowRoot.appendChild(x)}let u=r.getExternalStyles?.();if(u)for(let v of u){let x=ho(v,s);l&&x.setAttribute("nonce",l),this.shadowRoot.appendChild(x)}}nodeOrShadowRoot(i){return i===this.hostEl?this.shadowRoot:i}appendChild(i,e){return super.appendChild(this.nodeOrShadowRoot(i),e)}insertBefore(i,e,t){return super.insertBefore(this.nodeOrShadowRoot(i),e,t)}removeChild(i,e){return super.removeChild(null,e)}parentNode(i){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(i)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},rn=class extends nn{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(i,e,t,r,s,o,l,a){super(i,s,o,l),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=a?Rl(a,t.styles):t.styles,this.styleUrls=t.getExternalStyles?.(a)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Cr=class extends rn{contentAttr;hostAttr;constructor(i,e,t,r,s,o,l,a){let c=r+"-"+t.id;super(i,e,t,s,o,l,a,c),this.contentAttr=$u(c),this.hostAttr=Bu(c)}applyToHost(i){this.applyStyles(),this.setAttribute(i,this.hostAttr,"")}createElement(i,e){let t=super.createElement(i,e);return super.setAttribute(t,this.contentAttr,""),t}},Hu=(()=>{class n extends Sr{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,r){return e.addEventListener(t,r,!1),()=>this.removeEventListener(e,t,r)}removeEventListener(e,t,r){return e.removeEventListener(t,r)}static \u0275fac=function(t){return new(t||n)(N(ye))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),Il=["alt","control","meta","shift"],zu={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gu={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},qu=(()=>{class n extends Sr{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,t,r){let s=n.parseEventName(t),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mi().onAndCancel(e,s.domEventName,o))}static parseEventName(e){let t=e.toLowerCase().split("."),r=t.shift();if(t.length===0||!(r==="keydown"||r==="keyup"))return null;let s=n._normalizeKey(t.pop()),o="",l=t.indexOf("code");if(l>-1&&(t.splice(l,1),o="code."),Il.forEach(c=>{let u=t.indexOf(c);u>-1&&(t.splice(u,1),o+=c+".")}),o+=s,t.length!=0||s.length===0)return null;let a={};return a.domEventName=r,a.fullKey=o,a}static matchEventFullKeyCode(e,t){let r=zu[e.key]||e.key,s="";return t.indexOf("code.")>-1&&(r=e.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Il.forEach(o=>{if(o!==r){let l=Gu[o];l(e)&&(s+=o+".")}}),s+=r,s===t)}static eventCallback(e,t,r){return s=>{n.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>t(s))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(t){return new(t||n)(N(ye))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function Ol(n,i){return dl(E({rootComponent:n},Wu(i)))}function Wu(n){return{appProviders:[...Qu,...n?.providers??[]],platformProviders:Ju}}function Yu(){co.makeCurrent()}function Ku(){return new Ys}function Zu(){return nl(document),document}var Ju=[{provide:Ht,useValue:vl},{provide:rl,useValue:Yu,multi:!0},{provide:ye,useFactory:Zu,deps:[]}];var Qu=[{provide:Xa,useValue:"root"},{provide:Ys,useFactory:Ku,deps:[]},{provide:uo,useClass:Hu,multi:!0,deps:[ye,Ie,Ht]},{provide:uo,useClass:qu,multi:!0,deps:[ye]},wr,Al,kl,{provide:gr,useExisting:wr},{provide:xl,useClass:Nu,deps:[]},[]];var Pl=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(t){return new(t||n)(N(ye))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var U="primary",yn=Symbol("RouteTitle"),bo=class{params;constructor(i){this.params=i||{}}has(i){return Object.prototype.hasOwnProperty.call(this.params,i)}get(i){if(this.has(i)){let e=this.params[i];return Array.isArray(e)?e[0]:e}return null}getAll(i){if(this.has(i)){let e=this.params[i];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function bi(n){return new bo(n)}function th(n,i,e){let t=e.path.split("/");if(t.length>n.length||e.pathMatch==="full"&&(i.hasChildren()||t.length<n.length))return null;let r={};for(let s=0;s<t.length;s++){let o=t[s],l=n[s];if(o[0]===":")r[o.substring(1)]=l;else if(o!==l.path)return null}return{consumed:n.slice(0,t.length),posParams:r}}function ih(n,i){if(n.length!==i.length)return!1;for(let e=0;e<n.length;++e)if(!rt(n[e],i[e]))return!1;return!0}function rt(n,i){let e=n?xo(n):void 0,t=i?xo(i):void 0;if(!e||!t||e.length!=t.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!Wl(n[r],i[r]))return!1;return!0}function xo(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Wl(n,i){if(Array.isArray(n)&&Array.isArray(i)){if(n.length!==i.length)return!1;let e=[...n].sort(),t=[...i].sort();return e.every((r,s)=>t[s]===r)}else return n===i}function Yl(n){return n.length>0?n[n.length-1]:null}function Ot(n){return Ha(n)?n:vr(n)?Ce(Promise.resolve(n)):V(n)}var nh={exact:Zl,subset:Jl},Kl={exact:rh,subset:sh,ignored:()=>!0};function Nl(n,i,e){return nh[e.paths](n.root,i.root,e.matrixParams)&&Kl[e.queryParams](n.queryParams,i.queryParams)&&!(e.fragment==="exact"&&n.fragment!==i.fragment)}function rh(n,i){return rt(n,i)}function Zl(n,i,e){if(!Yt(n.segments,i.segments)||!Mr(n.segments,i.segments,e)||n.numberOfChildren!==i.numberOfChildren)return!1;for(let t in i.children)if(!n.children[t]||!Zl(n.children[t],i.children[t],e))return!1;return!0}function sh(n,i){return Object.keys(i).length<=Object.keys(n).length&&Object.keys(i).every(e=>Wl(n[e],i[e]))}function Jl(n,i,e){return Ql(n,i,i.segments,e)}function Ql(n,i,e,t){if(n.segments.length>e.length){let r=n.segments.slice(0,e.length);return!(!Yt(r,e)||i.hasChildren()||!Mr(r,e,t))}else if(n.segments.length===e.length){if(!Yt(n.segments,e)||!Mr(n.segments,e,t))return!1;for(let r in i.children)if(!n.children[r]||!Jl(n.children[r],i.children[r],t))return!1;return!0}else{let r=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!Yt(n.segments,r)||!Mr(n.segments,r,t)||!n.children[U]?!1:Ql(n.children[U],i,s,t)}}function Mr(n,i,e){return i.every((t,r)=>Kl[e](n[r].parameters,t.parameters))}var _t=class{root;queryParams;fragment;_queryParamMap;constructor(i=new q([],{}),e={},t=null){this.root=i,this.queryParams=e,this.fragment=t}get queryParamMap(){return this._queryParamMap??=bi(this.queryParams),this._queryParamMap}toString(){return lh.serialize(this)}},q=class{segments;children;parent=null;constructor(i,e){this.segments=i,this.children=e,Object.values(e).forEach(t=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ir(this)}},Wt=class{path;parameters;_parameterMap;constructor(i,e){this.path=i,this.parameters=e}get parameterMap(){return this._parameterMap??=bi(this.parameters),this._parameterMap}toString(){return ec(this)}};function oh(n,i){return Yt(n,i)&&n.every((e,t)=>rt(e.parameters,i[t].parameters))}function Yt(n,i){return n.length!==i.length?!1:n.every((e,t)=>e.path===i[t].path)}function ah(n,i){let e=[];return Object.entries(n.children).forEach(([t,r])=>{t===U&&(e=e.concat(i(r,t)))}),Object.entries(n.children).forEach(([t,r])=>{t!==U&&(e=e.concat(i(r,t)))}),e}var bn=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:()=>new xi,providedIn:"root"})}return n})(),xi=class{parse(i){let e=new wo(i);return new _t(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(i){let e=`/${sn(i.root,!0)}`,t=uh(i.queryParams),r=typeof i.fragment=="string"?`#${ch(i.fragment)}`:"";return`${e}${t}${r}`}},lh=new xi;function Ir(n){return n.segments.map(i=>ec(i)).join("/")}function sn(n,i){if(!n.hasChildren())return Ir(n);if(i){let e=n.children[U]?sn(n.children[U],!1):"",t=[];return Object.entries(n.children).forEach(([r,s])=>{r!==U&&t.push(`${r}:${sn(s,!1)}`)}),t.length>0?`${e}(${t.join("//")})`:e}else{let e=ah(n,(t,r)=>r===U?[sn(n.children[U],!1)]:[`${r}:${sn(t,!1)}`]);return Object.keys(n.children).length===1&&n.children[U]!=null?`${Ir(n)}/${e[0]}`:`${Ir(n)}/(${e.join("//")})`}}function Xl(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Tr(n){return Xl(n).replace(/%3B/gi,";")}function ch(n){return encodeURI(n)}function So(n){return Xl(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function kr(n){return decodeURIComponent(n)}function Fl(n){return kr(n.replace(/\+/g,"%20"))}function ec(n){return`${So(n.path)}${dh(n.parameters)}`}function dh(n){return Object.entries(n).map(([i,e])=>`;${So(i)}=${So(e)}`).join("")}function uh(n){let i=Object.entries(n).map(([e,t])=>Array.isArray(t)?t.map(r=>`${Tr(e)}=${Tr(r)}`).join("&"):`${Tr(e)}=${Tr(t)}`).filter(e=>e);return i.length?`?${i.join("&")}`:""}var hh=/^[^\/()?;#]+/;function go(n){let i=n.match(hh);return i?i[0]:""}var fh=/^[^\/()?;=#]+/;function mh(n){let i=n.match(fh);return i?i[0]:""}var ph=/^[^=?&#]+/;function gh(n){let i=n.match(ph);return i?i[0]:""}var _h=/^[^&#]+/;function vh(n){let i=n.match(_h);return i?i[0]:""}var wo=class{url;remaining;constructor(i){this.url=i,this.remaining=i}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new q([],{}):new q([],this.parseChildren())}parseQueryParams(){let i={};if(this.consumeOptional("?"))do this.parseQueryParam(i);while(this.consumeOptional("&"));return i}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let i=[];for(this.peekStartsWith("(")||i.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),i.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let t={};return this.peekStartsWith("(")&&(t=this.parseParens(!1)),(i.length>0||Object.keys(e).length>0)&&(t[U]=new q(i,e)),t}parseSegment(){let i=go(this.remaining);if(i===""&&this.peekStartsWith(";"))throw new ie(4009,!1);return this.capture(i),new Wt(kr(i),this.parseMatrixParams())}parseMatrixParams(){let i={};for(;this.consumeOptional(";");)this.parseParam(i);return i}parseParam(i){let e=mh(this.remaining);if(!e)return;this.capture(e);let t="";if(this.consumeOptional("=")){let r=go(this.remaining);r&&(t=r,this.capture(t))}i[kr(e)]=kr(t)}parseQueryParam(i){let e=gh(this.remaining);if(!e)return;this.capture(e);let t="";if(this.consumeOptional("=")){let o=vh(this.remaining);o&&(t=o,this.capture(t))}let r=Fl(e),s=Fl(t);if(i.hasOwnProperty(r)){let o=i[r];Array.isArray(o)||(o=[o],i[r]=o),o.push(s)}else i[r]=s}parseParens(i){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let t=go(this.remaining),r=this.remaining[t.length];if(r!=="/"&&r!==")"&&r!==";")throw new ie(4010,!1);let s;t.indexOf(":")>-1?(s=t.slice(0,t.indexOf(":")),this.capture(s),this.capture(":")):i&&(s=U);let o=this.parseChildren();e[s]=Object.keys(o).length===1?o[U]:new q([],o),this.consumeOptional("//")}return e}peekStartsWith(i){return this.remaining.startsWith(i)}consumeOptional(i){return this.peekStartsWith(i)?(this.remaining=this.remaining.substring(i.length),!0):!1}capture(i){if(!this.consumeOptional(i))throw new ie(4011,!1)}};function tc(n){return n.segments.length>0?new q([],{[U]:n}):n}function ic(n){let i={};for(let[t,r]of Object.entries(n.children)){let s=ic(r);if(t===U&&s.segments.length===0&&s.hasChildren())for(let[o,l]of Object.entries(s.children))i[o]=l;else(s.segments.length>0||s.hasChildren())&&(i[t]=s)}let e=new q(n.segments,i);return yh(e)}function yh(n){if(n.numberOfChildren===1&&n.children[U]){let i=n.children[U];return new q(n.segments.concat(i.segments),i.children)}return n}function Kt(n){return n instanceof _t}function bh(n,i,e=null,t=null){let r=nc(n);return rc(r,i,e,t)}function nc(n){let i;function e(s){let o={};for(let a of s.children){let c=e(a);o[a.outlet]=c}let l=new q(s.url,o);return s===n&&(i=l),l}let t=e(n.root),r=tc(t);return i??r}function rc(n,i,e,t){let r=n;for(;r.parent;)r=r.parent;if(i.length===0)return _o(r,r,r,e,t);let s=xh(i);if(s.toRoot())return _o(r,r,new q([],{}),e,t);let o=Sh(s,r,n),l=o.processChildren?ln(o.segmentGroup,o.index,s.commands):oc(o.segmentGroup,o.index,s.commands);return _o(r,o.segmentGroup,l,e,t)}function Ar(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function un(n){return typeof n=="object"&&n!=null&&n.outlets}function _o(n,i,e,t,r){let s={};t&&Object.entries(t).forEach(([a,c])=>{s[a]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let o;n===i?o=e:o=sc(n,i,e);let l=tc(ic(o));return new _t(l,s,r)}function sc(n,i,e){let t={};return Object.entries(n.children).forEach(([r,s])=>{s===i?t[r]=e:t[r]=sc(s,i,e)}),new q(n.segments,t)}var Dr=class{isAbsolute;numberOfDoubleDots;commands;constructor(i,e,t){if(this.isAbsolute=i,this.numberOfDoubleDots=e,this.commands=t,i&&t.length>0&&Ar(t[0]))throw new ie(4003,!1);let r=t.find(un);if(r&&r!==Yl(t))throw new ie(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function xh(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Dr(!0,0,n);let i=0,e=!1,t=n.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let l={};return Object.entries(s.outlets).forEach(([a,c])=>{l[a]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:l}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((l,a)=>{a==0&&l==="."||(a==0&&l===""?e=!0:l===".."?i++:l!=""&&r.push(l))}),r):[...r,s]},[]);return new Dr(e,i,t)}var _i=class{segmentGroup;processChildren;index;constructor(i,e,t){this.segmentGroup=i,this.processChildren=e,this.index=t}};function Sh(n,i,e){if(n.isAbsolute)return new _i(i,!0,0);if(!e)return new _i(i,!1,NaN);if(e.parent===null)return new _i(e,!0,0);let t=Ar(n.commands[0])?0:1,r=e.segments.length-1+t;return wh(e,r,n.numberOfDoubleDots)}function wh(n,i,e){let t=n,r=i,s=e;for(;s>r;){if(s-=r,t=t.parent,!t)throw new ie(4005,!1);r=t.segments.length}return new _i(t,!1,r-s)}function Ch(n){return un(n[0])?n[0].outlets:{[U]:n}}function oc(n,i,e){if(n??=new q([],{}),n.segments.length===0&&n.hasChildren())return ln(n,i,e);let t=Th(n,i,e),r=e.slice(t.commandIndex);if(t.match&&t.pathIndex<n.segments.length){let s=new q(n.segments.slice(0,t.pathIndex),{});return s.children[U]=new q(n.segments.slice(t.pathIndex),n.children),ln(s,0,r)}else return t.match&&r.length===0?new q(n.segments,{}):t.match&&!n.hasChildren()?Co(n,i,e):t.match?ln(n,0,r):Co(n,i,e)}function ln(n,i,e){if(e.length===0)return new q(n.segments,{});{let t=Ch(e),r={};if(Object.keys(t).some(s=>s!==U)&&n.children[U]&&n.numberOfChildren===1&&n.children[U].segments.length===0){let s=ln(n.children[U],i,e);return new q(n.segments,s.children)}return Object.entries(t).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=oc(n.children[s],i,o))}),Object.entries(n.children).forEach(([s,o])=>{t[s]===void 0&&(r[s]=o)}),new q(n.segments,r)}}function Th(n,i,e){let t=0,r=i,s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(t>=e.length)return s;let o=n.segments[r],l=e[t];if(un(l))break;let a=`${l}`,c=t<e.length-1?e[t+1]:null;if(r>0&&a===void 0)break;if(a&&c&&typeof c=="object"&&c.outlets===void 0){if(!Vl(a,c,o))return s;t+=2}else{if(!Vl(a,{},o))return s;t++}r++}return{match:!0,pathIndex:r,commandIndex:t}}function Co(n,i,e){let t=n.segments.slice(0,i),r=0;for(;r<e.length;){let s=e[r];if(un(s)){let a=Eh(s.outlets);return new q(t,a)}if(r===0&&Ar(e[0])){let a=n.segments[i];t.push(new Wt(a.path,Ll(e[0]))),r++;continue}let o=un(s)?s.outlets[U]:`${s}`,l=r<e.length-1?e[r+1]:null;o&&l&&Ar(l)?(t.push(new Wt(o,Ll(l))),r+=2):(t.push(new Wt(o,{})),r++)}return new q(t,{})}function Eh(n){let i={};return Object.entries(n).forEach(([e,t])=>{typeof t=="string"&&(t=[t]),t!==null&&(i[e]=Co(new q([],{}),0,t))}),i}function Ll(n){let i={};return Object.entries(n).forEach(([e,t])=>i[e]=`${t}`),i}function Vl(n,i,e){return n==e.path&&rt(i,e.parameters)}var cn="imperative",me=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(me||{}),$e=class{id;url;constructor(i,e){this.id=i,this.url=e}},Si=class extends $e{type=me.NavigationStart;navigationTrigger;restoredState;constructor(i,e,t="imperative",r=null){super(i,e),this.navigationTrigger=t,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},st=class extends $e{urlAfterRedirects;type=me.NavigationEnd;constructor(i,e,t){super(i,e),this.urlAfterRedirects=t}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Fe=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Fe||{}),Rr=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Rr||{}),gt=class extends $e{reason;code;type=me.NavigationCancel;constructor(i,e,t,r){super(i,e),this.reason=t,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Rt=class extends $e{reason;code;type=me.NavigationSkipped;constructor(i,e,t,r){super(i,e),this.reason=t,this.code=r}},hn=class extends $e{error;target;type=me.NavigationError;constructor(i,e,t,r){super(i,e),this.error=t,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Or=class extends $e{urlAfterRedirects;state;type=me.RoutesRecognized;constructor(i,e,t,r){super(i,e),this.urlAfterRedirects=t,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},To=class extends $e{urlAfterRedirects;state;type=me.GuardsCheckStart;constructor(i,e,t,r){super(i,e),this.urlAfterRedirects=t,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Eo=class extends $e{urlAfterRedirects;state;shouldActivate;type=me.GuardsCheckEnd;constructor(i,e,t,r,s){super(i,e),this.urlAfterRedirects=t,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Mo=class extends $e{urlAfterRedirects;state;type=me.ResolveStart;constructor(i,e,t,r){super(i,e),this.urlAfterRedirects=t,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Io=class extends $e{urlAfterRedirects;state;type=me.ResolveEnd;constructor(i,e,t,r){super(i,e),this.urlAfterRedirects=t,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ko=class{route;type=me.RouteConfigLoadStart;constructor(i){this.route=i}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ao=class{route;type=me.RouteConfigLoadEnd;constructor(i){this.route=i}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Do=class{snapshot;type=me.ChildActivationStart;constructor(i){this.snapshot=i}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ro=class{snapshot;type=me.ChildActivationEnd;constructor(i){this.snapshot=i}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Oo=class{snapshot;type=me.ActivationStart;constructor(i){this.snapshot=i}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Po=class{snapshot;type=me.ActivationEnd;constructor(i){this.snapshot=i}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pr=class{routerEvent;position;anchor;type=me.Scroll;constructor(i,e,t){this.routerEvent=i,this.position=e,this.anchor=t}toString(){let i=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${i}')`}},fn=class{},wi=class{url;navigationBehaviorOptions;constructor(i,e){this.url=i,this.navigationBehaviorOptions=e}};function Mh(n,i){return n.providers&&!n._injector&&(n._injector=Xs(n.providers,i,`Route: ${n.path}`)),n._injector??i}function Je(n){return n.outlet||U}function Ih(n,i){let e=n.filter(t=>Je(t)===i);return e.push(...n.filter(t=>Je(t)!==i)),e}function xn(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let i=n.parent;i;i=i.parent){let e=i.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var No=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return xn(this.route?.snapshot)??this.rootInjector}constructor(i){this.rootInjector=i,this.children=new Sn(this.rootInjector)}},Sn=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,t){let r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){let t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new No(this.rootInjector),this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(t){return new(t||n)(N(Wi))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Nr=class{_root;constructor(i){this._root=i}get root(){return this._root.value}parent(i){let e=this.pathFromRoot(i);return e.length>1?e[e.length-2]:null}children(i){let e=Fo(i,this._root);return e?e.children.map(t=>t.value):[]}firstChild(i){let e=Fo(i,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(i){let e=Lo(i,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==i)}pathFromRoot(i){return Lo(i,this._root).map(e=>e.value)}};function Fo(n,i){if(n===i.value)return i;for(let e of i.children){let t=Fo(n,e);if(t)return t}return null}function Lo(n,i){if(n===i.value)return[i];for(let e of i.children){let t=Lo(n,e);if(t.length)return t.unshift(i),t}return[]}var Ne=class{value;children;constructor(i,e){this.value=i,this.children=e}toString(){return`TreeNode(${this.value})`}};function gi(n){let i={};return n&&n.children.forEach(e=>i[e.value.outlet]=e),i}var Fr=class extends Nr{snapshot;constructor(i,e){super(i),this.snapshot=e,qo(this,i)}toString(){return this.snapshot.toString()}};function ac(n){let i=kh(n),e=new je([new Wt("",{})]),t=new je({}),r=new je({}),s=new je({}),o=new je(""),l=new ke(e,t,s,o,r,U,n,i.root);return l.snapshot=i.root,new Fr(new Ne(l,[]),i)}function kh(n){let i={},e={},t={},r="",s=new vi([],i,t,r,e,U,n,null,{});return new Vr("",new Ne(s,[]))}var ke=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(i,e,t,r,s,o,l,a){this.urlSubject=i,this.paramsSubject=e,this.queryParamsSubject=t,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=l,this._futureSnapshot=a,this.title=this.dataSubject?.pipe(z(c=>c[yn]))??V(void 0),this.url=i,this.params=e,this.queryParams=t,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(z(i=>bi(i))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(z(i=>bi(i))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Lr(n,i,e="emptyOnly"){let t,{routeConfig:r}=n;return i!==null&&(e==="always"||r?.path===""||!i.component&&!i.routeConfig?.loadComponent)?t={params:E(E({},i.params),n.params),data:E(E({},i.data),n.data),resolve:E(E(E(E({},n.data),i.data),r?.data),n._resolvedData)}:t={params:E({},n.params),data:E({},n.data),resolve:E(E({},n.data),n._resolvedData??{})},r&&cc(r)&&(t.resolve[yn]=r.title),t}var vi=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[yn]}constructor(i,e,t,r,s,o,l,a,c){this.url=i,this.params=e,this.queryParams=t,this.fragment=r,this.data=s,this.outlet=o,this.component=l,this.routeConfig=a,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=bi(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=bi(this.queryParams),this._queryParamMap}toString(){let i=this.url.map(t=>t.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${i}', path:'${e}')`}},Vr=class extends Nr{url;constructor(i,e){super(e),this.url=i,qo(this,e)}toString(){return lc(this._root)}};function qo(n,i){i.value._routerState=n,i.children.forEach(e=>qo(n,e))}function lc(n){let i=n.children.length>0?` { ${n.children.map(lc).join(", ")} } `:"";return`${n.value}${i}`}function vo(n){if(n.snapshot){let i=n.snapshot,e=n._futureSnapshot;n.snapshot=e,rt(i.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),i.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),rt(i.params,e.params)||n.paramsSubject.next(e.params),ih(i.url,e.url)||n.urlSubject.next(e.url),rt(i.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Vo(n,i){let e=rt(n.params,i.params)&&oh(n.url,i.url),t=!n.parent!=!i.parent;return e&&!t&&(!n.parent||Vo(n.parent,i.parent))}function cc(n){return typeof n.title=="string"||n.title===null}var Ah=new G(""),Wo=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=U;activateEvents=new fe;deactivateEvents=new fe;attachEvents=new fe;detachEvents=new fe;routerOutletData=Ks(void 0);parentContexts=A(Sn);location=A(al);changeDetector=A(fi);inputBinder=A(Br,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:t,previousValue:r}=e.name;if(t)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ie(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ie(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ie(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new ie(4013,!1);this._activatedRoute=e;let r=this.location,o=e.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,a=new jo(e,l,r.injector,this.routerOutletData);this.activated=r.createComponent(o,{index:r.length,injector:a,environmentInjector:t}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=K({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Mt]})}return n})(),jo=class n{route;childContexts;parent;outletData;__ngOutletInjector(i){return new n(this.route,this.childContexts,i,this.outletData)}constructor(i,e,t,r){this.route=i,this.childContexts=e,this.parent=t,this.outletData=r}get(i,e){return i===ke?this.route:i===Sn?this.childContexts:i===Ah?this.outletData:this.parent.get(i,e)}},Br=new G(""),jl=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:t}=e,r=li([t.queryParams,t.params,t.data]).pipe(qe(([s,o,l],a)=>(l=E(E(E({},s),o),l),a===0?V(l):Promise.resolve(l)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==t||t.component===null){this.unsubscribeFromRouteData(e);return}let o=ul(t.component);if(!o){this.unsubscribeFromRouteData(e);return}for(let{templateName:l}of o.inputs)e.activatedComponentRef.setInput(l,s[l])});this.outletDataSubscriptions.set(e,r)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function Dh(n,i,e){let t=mn(n,i._root,e?e._root:void 0);return new Fr(t,i)}function mn(n,i,e){if(e&&n.shouldReuseRoute(i.value,e.value.snapshot)){let t=e.value;t._futureSnapshot=i.value;let r=Rh(n,i,e);return new Ne(t,r)}else{if(n.shouldAttach(i.value)){let s=n.retrieve(i.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=i.value,o.children=i.children.map(l=>mn(n,l)),o}}let t=Oh(i.value),r=i.children.map(s=>mn(n,s));return new Ne(t,r)}}function Rh(n,i,e){return i.children.map(t=>{for(let r of e.children)if(n.shouldReuseRoute(t.value,r.value.snapshot))return mn(n,t,r);return mn(n,t)})}function Oh(n){return new ke(new je(n.url),new je(n.params),new je(n.queryParams),new je(n.fragment),new je(n.data),n.outlet,n.component,n)}var pn=class{redirectTo;navigationBehaviorOptions;constructor(i,e){this.redirectTo=i,this.navigationBehaviorOptions=e}},dc="ngNavigationCancelingError";function jr(n,i){let{redirectTo:e,navigationBehaviorOptions:t}=Kt(i)?{redirectTo:i,navigationBehaviorOptions:void 0}:i,r=uc(!1,Fe.Redirect);return r.url=e,r.navigationBehaviorOptions=t,r}function uc(n,i){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[dc]=!0,e.cancellationCode=i,e}function Ph(n){return hc(n)&&Kt(n.url)}function hc(n){return!!n&&n[dc]}var Nh=(n,i,e,t)=>z(r=>(new Uo(i,r.targetRouterState,r.currentRouterState,e,t).activate(n),r)),Uo=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(i,e,t,r,s){this.routeReuseStrategy=i,this.futureState=e,this.currState=t,this.forwardEvent=r,this.inputBindingEnabled=s}activate(i){let e=this.futureState._root,t=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,t,i),vo(this.futureState.root),this.activateChildRoutes(e,t,i)}deactivateChildRoutes(i,e,t){let r=gi(e);i.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],t),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,t)})}deactivateRoutes(i,e,t){let r=i.value,s=e?e.value:null;if(r===s)if(r.component){let o=t.getContext(r.outlet);o&&this.deactivateChildRoutes(i,e,o.children)}else this.deactivateChildRoutes(i,e,t);else s&&this.deactivateRouteAndItsChildren(e,t)}deactivateRouteAndItsChildren(i,e){i.value.component&&this.routeReuseStrategy.shouldDetach(i.value.snapshot)?this.detachAndStoreRouteSubtree(i,e):this.deactivateRouteAndOutlet(i,e)}detachAndStoreRouteSubtree(i,e){let t=e.getContext(i.value.outlet),r=t&&i.value.component?t.children:e,s=gi(i);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(t&&t.outlet){let o=t.outlet.detach(),l=t.children.onOutletDeactivated();this.routeReuseStrategy.store(i.value.snapshot,{componentRef:o,route:i,contexts:l})}}deactivateRouteAndOutlet(i,e){let t=e.getContext(i.value.outlet),r=t&&i.value.component?t.children:e,s=gi(i);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);t&&(t.outlet&&(t.outlet.deactivate(),t.children.onOutletDeactivated()),t.attachRef=null,t.route=null)}activateChildRoutes(i,e,t){let r=gi(e);i.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],t),this.forwardEvent(new Po(s.value.snapshot))}),i.children.length&&this.forwardEvent(new Ro(i.value.snapshot))}activateRoutes(i,e,t){let r=i.value,s=e?e.value:null;if(vo(r),r===s)if(r.component){let o=t.getOrCreateContext(r.outlet);this.activateChildRoutes(i,e,o.children)}else this.activateChildRoutes(i,e,t);else if(r.component){let o=t.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(l.contexts),o.attachRef=l.componentRef,o.route=l.route.value,o.outlet&&o.outlet.attach(l.componentRef,l.route.value),vo(l.route.value),this.activateChildRoutes(i,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(i,null,o.children)}else this.activateChildRoutes(i,null,t)}},Ur=class{path;route;constructor(i){this.path=i,this.route=this.path[this.path.length-1]}},yi=class{component;route;constructor(i,e){this.component=i,this.route=e}};function Fh(n,i,e){let t=n._root,r=i?i._root:null;return on(t,r,e,[t.value])}function Lh(n){let i=n.routeConfig?n.routeConfig.canActivateChild:null;return!i||i.length===0?null:{node:n,guards:i}}function Ti(n,i){let e=Symbol(),t=i.get(n,e);return t===e?typeof n=="function"&&!Ja(n)?n:i.get(n):t}function on(n,i,e,t,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=gi(i);return n.children.forEach(o=>{Vh(o,s[o.value.outlet],e,t.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,l])=>dn(l,e.getContext(o),r)),r}function Vh(n,i,e,t,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=i?i.value:null,l=e?e.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let a=jh(o,s,s.routeConfig.runGuardsAndResolvers);a?r.canActivateChecks.push(new Ur(t)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?on(n,i,l?l.children:null,t,r):on(n,i,e,t,r),a&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new yi(l.outlet.component,o))}else o&&dn(i,l,r),r.canActivateChecks.push(new Ur(t)),s.component?on(n,null,l?l.children:null,t,r):on(n,null,e,t,r);return r}function jh(n,i,e){if(typeof e=="function")return e(n,i);switch(e){case"pathParamsChange":return!Yt(n.url,i.url);case"pathParamsOrQueryParamsChange":return!Yt(n.url,i.url)||!rt(n.queryParams,i.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Vo(n,i)||!rt(n.queryParams,i.queryParams);case"paramsChange":default:return!Vo(n,i)}}function dn(n,i,e){let t=gi(n),r=n.value;Object.entries(t).forEach(([s,o])=>{r.component?i?dn(o,i.children.getContext(s),e):dn(o,null,e):dn(o,i,e)}),r.component?i&&i.outlet&&i.outlet.isActivated?e.canDeactivateChecks.push(new yi(i.outlet.component,r)):e.canDeactivateChecks.push(new yi(null,r)):e.canDeactivateChecks.push(new yi(null,r))}function wn(n){return typeof n=="function"}function Uh(n){return typeof n=="boolean"}function $h(n){return n&&wn(n.canLoad)}function Bh(n){return n&&wn(n.canActivate)}function Hh(n){return n&&wn(n.canActivateChild)}function zh(n){return n&&wn(n.canDeactivate)}function Gh(n){return n&&wn(n.canMatch)}function fc(n){return n instanceof za||n?.name==="EmptyError"}var Er=Symbol("INITIAL_VALUE");function Ci(){return qe(n=>li(n.map(i=>i.pipe(Tt(1),hr(Er)))).pipe(z(i=>{for(let e of i)if(e!==!0){if(e===Er)return Er;if(e===!1||qh(e))return e}return!0}),$t(i=>i!==Er),Tt(1)))}function qh(n){return Kt(n)||n instanceof pn}function Wh(n,i){return Oe(e=>{let{targetSnapshot:t,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=e;return o.length===0&&s.length===0?V(Y(E({},e),{guardsResult:!0})):Yh(o,t,r,n).pipe(Oe(l=>l&&Uh(l)?Kh(t,s,n,i):V(l)),z(l=>Y(E({},e),{guardsResult:l})))})}function Yh(n,i,e,t){return Ce(n).pipe(Oe(r=>ef(r.component,r.route,e,i,t)),Et(r=>r!==!0,!0))}function Kh(n,i,e,t){return Ce(i).pipe(di(r=>dr(Jh(r.route.parent,t),Zh(r.route,t),Xh(n,r.path,e),Qh(n,r.route,e))),Et(r=>r!==!0,!0))}function Zh(n,i){return n!==null&&i&&i(new Oo(n)),V(!0)}function Jh(n,i){return n!==null&&i&&i(new Do(n)),V(!0)}function Qh(n,i,e){let t=i.routeConfig?i.routeConfig.canActivate:null;if(!t||t.length===0)return V(!0);let r=t.map(s=>Hs(()=>{let o=xn(i)??e,l=Ti(s,o),a=Bh(l)?l.canActivate(i,n):tt(o,()=>l(i,n));return Ot(a).pipe(Et())}));return V(r).pipe(Ci())}function Xh(n,i,e){let t=i[i.length-1],s=i.slice(0,i.length-1).reverse().map(o=>Lh(o)).filter(o=>o!==null).map(o=>Hs(()=>{let l=o.guards.map(a=>{let c=xn(o.node)??e,u=Ti(a,c),v=Hh(u)?u.canActivateChild(t,n):tt(c,()=>u(t,n));return Ot(v).pipe(Et())});return V(l).pipe(Ci())}));return V(s).pipe(Ci())}function ef(n,i,e,t,r){let s=i&&i.routeConfig?i.routeConfig.canDeactivate:null;if(!s||s.length===0)return V(!0);let o=s.map(l=>{let a=xn(i)??r,c=Ti(l,a),u=zh(c)?c.canDeactivate(n,i,e,t):tt(a,()=>c(n,i,e,t));return Ot(u).pipe(Et())});return V(o).pipe(Ci())}function tf(n,i,e,t){let r=i.canLoad;if(r===void 0||r.length===0)return V(!0);let s=r.map(o=>{let l=Ti(o,n),a=$h(l)?l.canLoad(i,e):tt(n,()=>l(i,e));return Ot(a)});return V(s).pipe(Ci(),mc(t))}function mc(n){return $a(Se(i=>{if(typeof i!="boolean")throw jr(n,i)}),z(i=>i===!0))}function nf(n,i,e,t){let r=i.canMatch;if(!r||r.length===0)return V(!0);let s=r.map(o=>{let l=Ti(o,n),a=Gh(l)?l.canMatch(i,e):tt(n,()=>l(i,e));return Ot(a)});return V(s).pipe(Ci(),mc(t))}var gn=class{segmentGroup;constructor(i){this.segmentGroup=i||null}},_n=class extends Error{urlTree;constructor(i){super(),this.urlTree=i}};function pi(n){return qi(new gn(n))}function rf(n){return qi(new ie(4e3,!1))}function sf(n){return qi(uc(!1,Fe.GuardRejected))}var $o=class{urlSerializer;urlTree;constructor(i,e){this.urlSerializer=i,this.urlTree=e}lineralizeSegments(i,e){let t=[],r=e.root;for(;;){if(t=t.concat(r.segments),r.numberOfChildren===0)return V(t);if(r.numberOfChildren>1||!r.children[U])return rf(`${i.redirectTo}`);r=r.children[U]}}applyRedirectCommands(i,e,t,r,s){if(typeof e!="string"){let l=e,{queryParams:a,fragment:c,routeConfig:u,url:v,outlet:x,params:w,data:m,title:M}=r,F=tt(s,()=>l({params:w,data:m,queryParams:a,fragment:c,routeConfig:u,url:v,outlet:x,title:M}));if(F instanceof _t)throw new _n(F);e=F}let o=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),i,t);if(e[0]==="/")throw new _n(o);return o}applyRedirectCreateUrlTree(i,e,t,r){let s=this.createSegmentGroup(i,e.root,t,r);return new _t(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(i,e){let t={};return Object.entries(i).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let l=s.substring(1);t[r]=e[l]}else t[r]=s}),t}createSegmentGroup(i,e,t,r){let s=this.createSegments(i,e.segments,t,r),o={};return Object.entries(e.children).forEach(([l,a])=>{o[l]=this.createSegmentGroup(i,a,t,r)}),new q(s,o)}createSegments(i,e,t,r){return e.map(s=>s.path[0]===":"?this.findPosParam(i,s,r):this.findOrReturn(s,t))}findPosParam(i,e,t){let r=t[e.path.substring(1)];if(!r)throw new ie(4001,!1);return r}findOrReturn(i,e){let t=0;for(let r of e){if(r.path===i.path)return e.splice(t),r;t++}return i}},Bo={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function of(n,i,e,t,r){let s=pc(n,i,e);return s.matched?(t=Mh(i,t),nf(t,i,e,r).pipe(z(o=>o===!0?s:E({},Bo)))):V(s)}function pc(n,i,e){if(i.path==="**")return af(e);if(i.path==="")return i.pathMatch==="full"&&(n.hasChildren()||e.length>0)?E({},Bo):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let r=(i.matcher||th)(e,n,i);if(!r)return E({},Bo);let s={};Object.entries(r.posParams??{}).forEach(([l,a])=>{s[l]=a.path});let o=r.consumed.length>0?E(E({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function af(n){return{matched:!0,parameters:n.length>0?Yl(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Ul(n,i,e,t){return e.length>0&&df(n,e,t)?{segmentGroup:new q(i,cf(t,new q(e,n.children))),slicedSegments:[]}:e.length===0&&uf(n,e,t)?{segmentGroup:new q(n.segments,lf(n,e,t,n.children)),slicedSegments:e}:{segmentGroup:new q(n.segments,n.children),slicedSegments:e}}function lf(n,i,e,t){let r={};for(let s of e)if(Hr(n,i,s)&&!t[Je(s)]){let o=new q([],{});r[Je(s)]=o}return E(E({},t),r)}function cf(n,i){let e={};e[U]=i;for(let t of n)if(t.path===""&&Je(t)!==U){let r=new q([],{});e[Je(t)]=r}return e}function df(n,i,e){return e.some(t=>Hr(n,i,t)&&Je(t)!==U)}function uf(n,i,e){return e.some(t=>Hr(n,i,t))}function Hr(n,i,e){return(n.hasChildren()||i.length>0)&&e.pathMatch==="full"?!1:e.path===""}function hf(n,i,e){return i.length===0&&!n.children[e]}var Ho=class{};function ff(n,i,e,t,r,s,o="emptyOnly"){return new zo(n,i,e,t,r,o,s).recognize()}var mf=31,zo=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(i,e,t,r,s,o,l){this.injector=i,this.configLoader=e,this.rootComponentType=t,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=l,this.applyRedirects=new $o(this.urlSerializer,this.urlTree)}noMatchError(i){return new ie(4002,`'${i.segmentGroup}'`)}recognize(){let i=Ul(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(i).pipe(z(({children:e,rootSnapshot:t})=>{let r=new Ne(t,e),s=new Vr("",r),o=bh(t,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(i){let e=new vi([],Object.freeze({}),Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),U,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,i,U,e).pipe(z(t=>({children:t,rootSnapshot:e})),ci(t=>{if(t instanceof _n)return this.urlTree=t.urlTree,this.match(t.urlTree.root);throw t instanceof gn?this.noMatchError(t):t}))}processSegmentGroup(i,e,t,r,s){return t.segments.length===0&&t.hasChildren()?this.processChildren(i,e,t,s):this.processSegment(i,e,t,t.segments,r,!0,s).pipe(z(o=>o instanceof Ne?[o]:[]))}processChildren(i,e,t,r){let s=[];for(let o of Object.keys(t.children))o==="primary"?s.unshift(o):s.push(o);return Ce(s).pipe(di(o=>{let l=t.children[o],a=Ih(e,o);return this.processSegmentGroup(i,a,l,o,r)}),Ka((o,l)=>(o.push(...l),o)),zs(null),Ya(),Oe(o=>{if(o===null)return pi(t);let l=gc(o);return pf(l),V(l)}))}processSegment(i,e,t,r,s,o,l){return Ce(e).pipe(di(a=>this.processSegmentAgainstRoute(a._injector??i,e,a,t,r,s,o,l).pipe(ci(c=>{if(c instanceof gn)return V(null);throw c}))),Et(a=>!!a),ci(a=>{if(fc(a))return hf(t,r,s)?V(new Ho):pi(t);throw a}))}processSegmentAgainstRoute(i,e,t,r,s,o,l,a){return Je(t)!==o&&(o===U||!Hr(r,s,t))?pi(r):t.redirectTo===void 0?this.matchSegmentAgainstRoute(i,r,t,s,o,a):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(i,r,e,t,s,o,a):pi(r)}expandSegmentAgainstRouteUsingRedirect(i,e,t,r,s,o,l){let{matched:a,parameters:c,consumedSegments:u,positionalParamSegments:v,remainingSegments:x}=pc(e,r,s);if(!a)return pi(e);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>mf&&(this.allowRedirects=!1));let w=new vi(s,c,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,$l(r),Je(r),r.component??r._loadedComponent??null,r,Bl(r)),m=Lr(w,l,this.paramsInheritanceStrategy);w.params=Object.freeze(m.params),w.data=Object.freeze(m.data);let M=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,v,w,i);return this.applyRedirects.lineralizeSegments(r,M).pipe(Oe(F=>this.processSegment(i,t,e,F.concat(x),o,!1,l)))}matchSegmentAgainstRoute(i,e,t,r,s,o){let l=of(e,t,r,i,this.urlSerializer);return t.path==="**"&&(e.children={}),l.pipe(qe(a=>a.matched?(i=t._injector??i,this.getChildConfig(i,t,r).pipe(qe(({routes:c})=>{let u=t._loadedInjector??i,{parameters:v,consumedSegments:x,remainingSegments:w}=a,m=new vi(x,v,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,$l(t),Je(t),t.component??t._loadedComponent??null,t,Bl(t)),M=Lr(m,o,this.paramsInheritanceStrategy);m.params=Object.freeze(M.params),m.data=Object.freeze(M.data);let{segmentGroup:F,slicedSegments:Z}=Ul(e,x,w,c);if(Z.length===0&&F.hasChildren())return this.processChildren(u,c,F,m).pipe(z(_e=>new Ne(m,_e)));if(c.length===0&&Z.length===0)return V(new Ne(m,[]));let Ee=Je(t)===s;return this.processSegment(u,c,F,Z,Ee?U:s,!0,m).pipe(z(_e=>new Ne(m,_e instanceof Ne?[_e]:[])))}))):pi(e)))}getChildConfig(i,e,t){return e.children?V({routes:e.children,injector:i}):e.loadChildren?e._loadedRoutes!==void 0?V({routes:e._loadedRoutes,injector:e._loadedInjector}):tf(i,e,t,this.urlSerializer).pipe(Oe(r=>r?this.configLoader.loadChildren(i,e).pipe(Se(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):sf(e))):V({routes:[],injector:i})}};function pf(n){n.sort((i,e)=>i.value.outlet===U?-1:e.value.outlet===U?1:i.value.outlet.localeCompare(e.value.outlet))}function gf(n){let i=n.value.routeConfig;return i&&i.path===""}function gc(n){let i=[],e=new Set;for(let t of n){if(!gf(t)){i.push(t);continue}let r=i.find(s=>t.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...t.children),e.add(r)):i.push(t)}for(let t of e){let r=gc(t.children);i.push(new Ne(t.value,r))}return i.filter(t=>!e.has(t))}function $l(n){return n.data||{}}function Bl(n){return n.resolve||{}}function _f(n,i,e,t,r,s){return Oe(o=>ff(n,i,e,t,o.extractedUrl,r,s).pipe(z(({state:l,tree:a})=>Y(E({},o),{targetSnapshot:l,urlAfterRedirects:a}))))}function vf(n,i){return Oe(e=>{let{targetSnapshot:t,guards:{canActivateChecks:r}}=e;if(!r.length)return V(e);let s=new Set(r.map(a=>a.route)),o=new Set;for(let a of s)if(!o.has(a))for(let c of _c(a))o.add(c);let l=0;return Ce(o).pipe(di(a=>s.has(a)?yf(a,t,n,i):(a.data=Lr(a,a.parent,n).resolve,V(void 0))),Se(()=>l++),Gs(1),Oe(a=>l===o.size?V(e):Ct))})}function _c(n){let i=n.children.map(e=>_c(e)).flat();return[n,...i]}function yf(n,i,e,t){let r=n.routeConfig,s=n._resolve;return r?.title!==void 0&&!cc(r)&&(s[yn]=r.title),bf(s,n,i,t).pipe(z(o=>(n._resolvedData=o,n.data=Lr(n,n.parent,e).resolve,null)))}function bf(n,i,e,t){let r=xo(n);if(r.length===0)return V({});let s={};return Ce(r).pipe(Oe(o=>xf(n[o],i,e,t).pipe(Et(),Se(l=>{if(l instanceof pn)throw jr(new xi,l);s[o]=l}))),Gs(1),Wa(s),ci(o=>fc(o)?Ct:qi(o)))}function xf(n,i,e,t){let r=xn(i)??t,s=Ti(n,r),o=s.resolve?s.resolve(i,e):tt(r,()=>s(i,e));return Ot(o)}function yo(n){return qe(i=>{let e=n(i);return e?Ce(e).pipe(z(()=>i)):V(i)})}var vc=(()=>{class n{buildTitle(e){let t,r=e.root;for(;r!==void 0;)t=this.getResolvedTitleForRoute(r)??t,r=r.children.find(s=>s.outlet===U);return t}getResolvedTitleForRoute(e){return e.data[yn]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:()=>A(Sf),providedIn:"root"})}return n})(),Sf=(()=>{class n extends vc{title;constructor(e){super(),this.title=e}updateTitle(e){let t=this.buildTitle(e);t!==void 0&&this.title.setTitle(t)}static \u0275fac=function(t){return new(t||n)(N(Pl))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cn=new G("",{providedIn:"root",factory:()=>({})}),wf=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=X({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){t&1&&ee(0,"router-outlet")},dependencies:[Wo],encapsulation:2})}return n})();function Yo(n){let i=n.children&&n.children.map(Yo),e=i?Y(E({},n),{children:i}):E({},n);return!e.component&&!e.loadComponent&&(i||e.loadChildren)&&e.outlet&&e.outlet!==U&&(e.component=wf),e}var vn=new G(""),Ko=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=A(br);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return V(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let t=Ot(e.loadComponent()).pipe(z(yc),Se(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),ur(()=>{this.componentLoaders.delete(e)})),r=new $s(t,()=>new Ve).pipe(Us());return this.componentLoaders.set(e,r),r}loadChildren(e,t){if(this.childrenLoaders.get(t))return this.childrenLoaders.get(t);if(t._loadedRoutes)return V({routes:t._loadedRoutes,injector:t._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(t);let s=Cf(t,this.compiler,e,this.onLoadEndListener).pipe(ur(()=>{this.childrenLoaders.delete(t)})),o=new $s(s,()=>new Ve).pipe(Us());return this.childrenLoaders.set(t,o),o}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cf(n,i,e,t){return Ot(n.loadChildren()).pipe(z(yc),Oe(r=>r instanceof ll||Array.isArray(r)?V(r):Ce(i.compileModuleAsync(r))),z(r=>{t&&t(n);let s,o,l=!1;return Array.isArray(r)?(o=r,l=!0):(s=r.create(e).injector,o=s.get(vn,[],{optional:!0,self:!0}).flat()),{routes:o.map(Yo),injector:s}}))}function Tf(n){return n&&typeof n=="object"&&"default"in n}function yc(n){return Tf(n)?n.default:n}var Zo=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:()=>A(Ef),providedIn:"root"})}return n})(),Ef=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bc=new G(""),xc=new G("");function Mf(n,i,e){let t=n.get(xc),r=n.get(ye);return n.get(Ie).runOutsideAngular(()=>{if(!r.startViewTransition||t.skipNextTransition)return t.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,o=new Promise(c=>{s=c}),l=r.startViewTransition(()=>(s(),If(n))),{onViewTransitionCreated:a}=t;return a&&tt(n,()=>a({transition:l,from:i,to:e})),o})}function If(n){return new Promise(i=>{Js({read:()=>setTimeout(i)},{injector:n})})}var Sc=new G(""),Jo=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ve;transitionAbortSubject=new Ve;configLoader=A(Ko);environmentInjector=A(Wi);urlSerializer=A(bn);rootContexts=A(Sn);location=A(en);inputBindingEnabled=A(Br,{optional:!0})!==null;titleStrategy=A(vc);options=A(Cn,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=A(Zo);createViewTransition=A(bc,{optional:!0});navigationErrorHandler=A(Sc,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>V(void 0);rootComponentType=null;constructor(){let e=r=>this.events.next(new ko(r)),t=r=>this.events.next(new Ao(r));this.configLoader.onLoadEndListener=t,this.configLoader.onLoadStartListener=e}complete(){this.transitions?.complete()}handleNavigationRequest(e){let t=++this.navigationId;this.transitions?.next(Y(E(E({},this.transitions.value),e),{id:t}))}setupNavigations(e,t,r){return this.transitions=new je({id:0,currentUrlTree:t,currentRawUrl:t,extractedUrl:this.urlHandlingStrategy.extract(t),urlAfterRedirects:this.urlHandlingStrategy.extract(t),rawUrl:t,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:cn,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe($t(s=>s.id!==0),z(s=>Y(E({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),qe(s=>{let o=!1,l=!1;return V(s).pipe(qe(a=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Fe.SupersededByNewNavigation),Ct;this.currentTransition=s,this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Y(E({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=a.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!c&&u!=="reload"){let v="";return this.events.next(new Rt(a.id,this.urlSerializer.serialize(a.rawUrl),v,Rr.IgnoredSameUrlNavigation)),a.resolve(!1),Ct}if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return V(a).pipe(qe(v=>{let x=this.transitions?.getValue();return this.events.next(new Si(v.id,this.urlSerializer.serialize(v.extractedUrl),v.source,v.restoredState)),x!==this.transitions?.getValue()?Ct:Promise.resolve(v)}),_f(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),Se(v=>{s.targetSnapshot=v.targetSnapshot,s.urlAfterRedirects=v.urlAfterRedirects,this.currentNavigation=Y(E({},this.currentNavigation),{finalUrl:v.urlAfterRedirects});let x=new Or(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(x)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:v,extractedUrl:x,source:w,restoredState:m,extras:M}=a,F=new Si(v,this.urlSerializer.serialize(x),w,m);this.events.next(F);let Z=ac(this.rootComponentType).snapshot;return this.currentTransition=s=Y(E({},a),{targetSnapshot:Z,urlAfterRedirects:x,extras:Y(E({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=x,V(s)}else{let v="";return this.events.next(new Rt(a.id,this.urlSerializer.serialize(a.extractedUrl),v,Rr.IgnoredByUrlHandlingStrategy)),a.resolve(!1),Ct}}),Se(a=>{let c=new To(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),z(a=>(this.currentTransition=s=Y(E({},a),{guards:Fh(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),s)),Wh(this.environmentInjector,a=>this.events.next(a)),Se(a=>{if(s.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw jr(this.urlSerializer,a.guardsResult);let c=new Eo(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),$t(a=>a.guardsResult?!0:(this.cancelNavigationTransition(a,"",Fe.GuardRejected),!1)),yo(a=>{if(a.guards.canActivateChecks.length)return V(a).pipe(Se(c=>{let u=new Mo(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),qe(c=>{let u=!1;return V(c).pipe(vf(this.paramsInheritanceStrategy,this.environmentInjector),Se({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",Fe.NoDataFromResolver)}}))}),Se(c=>{let u=new Io(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),yo(a=>{let c=u=>{let v=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&v.push(this.configLoader.loadComponent(u.routeConfig).pipe(Se(x=>{u.component=x}),z(()=>{})));for(let x of u.children)v.push(...c(x));return v};return li(c(a.targetSnapshot.root)).pipe(zs(null),Tt(1))}),yo(()=>this.afterPreactivation()),qe(()=>{let{currentSnapshot:a,targetSnapshot:c}=s,u=this.createViewTransition?.(this.environmentInjector,a.root,c.root);return u?Ce(u).pipe(z(()=>s)):V(s)}),z(a=>{let c=Dh(e.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return this.currentTransition=s=Y(E({},a),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),Se(()=>{this.events.next(new fn)}),Nh(this.rootContexts,e.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),Tt(1),Se({next:a=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new st(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{o=!0}}),fr(this.transitionAbortSubject.pipe(Se(a=>{throw a}))),ur(()=>{!o&&!l&&this.cancelNavigationTransition(s,"",Fe.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),ci(a=>{if(l=!0,hc(a))this.events.next(new gt(s.id,this.urlSerializer.serialize(s.extractedUrl),a.message,a.cancellationCode)),Ph(a)?this.events.next(new wi(a.url,a.navigationBehaviorOptions)):s.resolve(!1);else{let c=new hn(s.id,this.urlSerializer.serialize(s.extractedUrl),a,s.targetSnapshot??void 0);try{let u=tt(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof pn){let{message:v,cancellationCode:x}=jr(this.urlSerializer,u);this.events.next(new gt(s.id,this.urlSerializer.serialize(s.extractedUrl),v,x)),this.events.next(new wi(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(c),a}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return Ct}))}))}cancelNavigationTransition(e,t,r){let s=new gt(e.id,this.urlSerializer.serialize(e.extractedUrl),t,r);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),t=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==t?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kf(n){return n!==cn}var Af=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:()=>A(Df),providedIn:"root"})}return n})(),Go=class{shouldDetach(i){return!1}store(i,e){}shouldAttach(i){return!1}retrieve(i){return null}shouldReuseRoute(i,e){return i.routeConfig===e.routeConfig}},Df=(()=>{class n extends Go{static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wc=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:()=>A(Rf),providedIn:"root"})}return n})(),Rf=(()=>{class n extends wc{location=A(en);urlSerializer=A(bn);options=A(Cn,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=A(Zo);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new _t;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=ac(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(t=>{t.type==="popstate"&&e(t.url,t.state)})}handleRouterEvent(e,t){if(e instanceof Si)this.stateMemento=this.createStateMemento();else if(e instanceof Rt)this.rawUrlTree=t.initialUrl;else if(e instanceof Or){if(this.urlUpdateStrategy==="eager"&&!t.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl);this.setBrowserUrl(t.targetBrowserUrl??r,t)}}else e instanceof fn?(this.currentUrlTree=t.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl),this.routerState=t.targetRouterState,this.urlUpdateStrategy==="deferred"&&!t.extras.skipLocationChange&&this.setBrowserUrl(t.targetBrowserUrl??this.rawUrlTree,t)):e instanceof gt&&(e.code===Fe.GuardRejected||e.code===Fe.NoDataFromResolver)?this.restoreHistory(t):e instanceof hn?this.restoreHistory(t,!0):e instanceof st&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,t){let r=e instanceof _t?this.urlSerializer.serialize(e):e;if(this.location.isCurrentPathEqualTo(r)||t.extras.replaceUrl){let s=this.browserPageId,o=E(E({},t.extras.state),this.generateNgRouterState(t.id,s));this.location.replaceState(r,"",o)}else{let s=E(E({},t.extras.state),this.generateNgRouterState(t.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(e,t=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===e.finalUrl&&s===0&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(t&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,t){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:t}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),an=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(an||{});function Cc(n,i){n.events.pipe($t(e=>e instanceof st||e instanceof gt||e instanceof hn||e instanceof Rt),z(e=>e instanceof st||e instanceof Rt?an.COMPLETE:(e instanceof gt?e.code===Fe.Redirect||e.code===Fe.SupersededByNewNavigation:!1)?an.REDIRECTING:an.FAILED),$t(e=>e!==an.REDIRECTING),Tt(1)).subscribe(()=>{i()})}var Of={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Pf={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},be=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=A(_r);stateManager=A(wc);options=A(Cn,{optional:!0})||{};pendingTasks=A(il);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=A(Jo);urlSerializer=A(bn);location=A(en);urlHandlingStrategy=A(Zo);_events=new Ve;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=A(Af);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=A(vn,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!A(Br,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Ua;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(t=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(t,s),t instanceof gt&&t.code!==Fe.Redirect&&t.code!==Fe.SupersededByNewNavigation)this.navigated=!0;else if(t instanceof st)this.navigated=!0;else if(t instanceof wi){let o=t.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(t.url,r.currentRawUrl),a=E({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||kf(r.source)},o);this.scheduleNavigation(l,cn,null,a,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}Ff(t)&&this._events.next(t)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),cn,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,t)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",t)},0)})}navigateToSyncWithBrowser(e,t,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let a=E({},r);delete a.navigationId,delete a.\u0275routerPageId,Object.keys(a).length!==0&&(s.state=a)}let l=this.parseUrl(e);this.scheduleNavigation(l,t,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(Yo),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,t={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:l,preserveFragment:a}=t,c=a?this.currentUrlTree.fragment:o,u=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":u=E(E({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let v;try{let x=r?r.snapshot:this.routerState.snapshot.root;v=nc(x)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),v=this.currentUrlTree.root}return rc(v,e,u,c??null)}navigateByUrl(e,t={skipLocationChange:!1}){let r=Kt(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,cn,null,t)}navigate(e,t={skipLocationChange:!1}){return Nf(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,t){let r;if(t===!0?r=E({},Of):t===!1?r=E({},Pf):r=t,Kt(e))return Nl(this.currentUrlTree,e,r);let s=this.parseUrl(e);return Nl(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.entries(e).reduce((t,[r,s])=>(s!=null&&(t[r]=s),t),{})}scheduleNavigation(e,t,r,s,o){if(this.disposed)return Promise.resolve(!1);let l,a,c;o?(l=o.resolve,a=o.reject,c=o.promise):c=new Promise((v,x)=>{l=v,a=x});let u=this.pendingTasks.add();return Cc(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:t,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:l,reject:a,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(v=>Promise.reject(v))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Nf(n){for(let i=0;i<n.length;i++)if(n[i]==null)throw new ie(4008,!1)}function Ff(n){return!(n instanceof fn)&&!(n instanceof wi)}var Be=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Ve;constructor(e,t,r,s,o,l){this.router=e,this.route=t,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=l;let a=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=a==="a"||a==="area",this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof st&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Kt(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,t,r,s,o){let l=this.urlTree;if(l===null||this.isAnchorElement&&(e!==0||t||r||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let a={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,a),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.href=e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;let t=this.href===null?null:ol(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(e,t){let r=this.renderer,s=this.el.nativeElement;t!==null?r.setAttribute(s,e,t):r.removeAttribute(s,e)}get urlTree(){return this.routerLinkInput===null?null:Kt(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(t){return new(t||n)(I(be),I(ke),el("tabindex"),I(Ye),I(Pe),I(Xi))};static \u0275dir=K({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,r){t&1&&S("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),t&2&&qt("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",At],skipLocationChange:[2,"skipLocationChange","skipLocationChange",At],replaceUrl:[2,"replaceUrl","replaceUrl",At],routerLink:"routerLink"},features:[Gt,Mt]})}return n})();var $r=class{};var Lf=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,t,r,s,o){this.router=e,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe($t(e=>e instanceof st),di(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){let r=[];for(let s of t){s.providers&&!s._injector&&(s._injector=Xs(s.providers,e,`Route: ${s.path}`));let o=s._injector??e,l=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(l,s.children??s._loadedRoutes))}return Ce(r).pipe(Bs())}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>{let r;t.loadChildren&&t.canLoad===void 0?r=this.loader.loadChildren(e,t):r=V(null);let s=r.pipe(Oe(o=>o===null?V(void 0):(t._loadedRoutes=o.routes,t._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));if(t.loadComponent&&!t._loadedComponent){let o=this.loader.loadComponent(t);return Ce([s,o]).pipe(Bs())}else return s})}static \u0275fac=function(t){return new(t||n)(N(be),N(br),N(Wi),N($r),N(Ko))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Tc=new G(""),Vf=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,t,r,s,o={}){this.urlSerializer=e,this.transitions=t,this.viewportScroller=r,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Si?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof st?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Rt&&e.code===Rr.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Pr&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Pr(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,t))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(t){pr()};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function Ec(n,...i){return Bt([{provide:vn,multi:!0,useValue:n},[],{provide:ke,useFactory:Mc,deps:[be]},{provide:to,multi:!0,useFactory:Ic},i.map(e=>e.\u0275providers)])}function Mc(n){return n.routerState.root}function Tn(n,i){return{\u0275kind:n,\u0275providers:i}}function Ic(){let n=A(ui);return i=>{let e=n.get(io);if(i!==e.components[0])return;let t=n.get(be),r=n.get(kc);n.get(Qo)===1&&t.initialNavigation(),n.get(Ac,null,qs.Optional)?.setUpPreloading(),n.get(Tc,null,qs.Optional)?.init(),t.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var kc=new G("",{factory:()=>new Ve}),Qo=new G("",{providedIn:"root",factory:()=>1});function jf(){return Tn(2,[{provide:Qo,useValue:0},{provide:Ji,multi:!0,deps:[ui],useFactory:i=>{let e=i.get(ml,Promise.resolve());return()=>e.then(()=>new Promise(t=>{let r=i.get(be),s=i.get(kc);Cc(r,()=>{t(!0)}),i.get(Jo).afterPreactivation=()=>(t(!0),s.closed?V(void 0):s),r.initialNavigation()}))}}])}function Uf(){return Tn(3,[{provide:Ji,multi:!0,useFactory:()=>{let i=A(be);return()=>{i.setUpLocationChangeListener()}}},{provide:Qo,useValue:2}])}var Ac=new G("");function $f(n){return Tn(0,[{provide:Ac,useExisting:Lf},{provide:$r,useExisting:n}])}function Bf(){return Tn(8,[jl,{provide:Br,useExisting:jl}])}function Hf(n){let i=[{provide:bc,useValue:Mf},{provide:xc,useValue:E({skipNextTransition:!!n?.skipInitialTransition},n)}];return Tn(9,i)}var Hl=new G("ROUTER_FORROOT_GUARD"),zf=[en,{provide:bn,useClass:xi},be,Sn,{provide:ke,useFactory:Mc,deps:[be]},Ko,[]],Dc=(()=>{class n{constructor(e){}static forRoot(e,t){return{ngModule:n,providers:[zf,[],{provide:vn,multi:!0,useValue:e},{provide:Hl,useFactory:Yf,deps:[[be,new Ws,new Qa]]},t?.errorHandler?{provide:Sc,useValue:t.errorHandler}:[],{provide:Cn,useValue:t||{}},t?.useHash?qf():Wf(),Gf(),t?.preloadingStrategy?$f(t.preloadingStrategy).\u0275providers:[],t?.initialNavigation?Kf(t):[],t?.bindToComponentInputs?Bf().\u0275providers:[],t?.enableViewTransitions?Hf().\u0275providers:[],Zf()]}}static forChild(e){return{ngModule:n,providers:[{provide:vn,multi:!0,useValue:e}]}}static \u0275fac=function(t){return new(t||n)(N(Hl,8))};static \u0275mod=oe({type:n});static \u0275inj=se({})}return n})();function Gf(){return{provide:Tc,useFactory:()=>{let n=A(bl),i=A(Ie),e=A(Cn),t=A(Jo),r=A(bn);return e.scrollOffset&&n.setOffset(e.scrollOffset),new Vf(r,t,n,i,e)}}}function qf(){return{provide:Xi,useClass:gl}}function Wf(){return{provide:Xi,useClass:pl}}function Yf(n){return"guarded"}function Kf(n){return[n.initialNavigation==="disabled"?Uf().\u0275providers:[],n.initialNavigation==="enabledBlocking"?jf().\u0275providers:[]]}var zl=new G("");function Zf(){return[{provide:zl,useFactory:Ic},{provide:to,multi:!0,useExisting:zl}]}var Rc=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):i=fetch,(...e)=>i(...e)};var En=class extends Error{constructor(i,e="FunctionsError",t){super(i),this.name=e,this.context=t}},zr=class extends En{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}},Gr=class extends En{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}},qr=class extends En{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}},Xo=function(n){return n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2",n}(Xo||{});var Jf=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},Mn=class{constructor(i,{headers:e={},customFetch:t,region:r=Xo.Any}={}){this.url=i,this.headers=e,this.region=r,this.fetch=Rc(t)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i,e={}){var t;return Jf(this,void 0,void 0,function*(){try{let{headers:r,method:s,body:o}=e,l={},{region:a}=e;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let c;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(l["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(l["Content-Type"]="application/json",c=JSON.stringify(o)));let u=yield this.fetch(`${this.url}/${i}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:c}).catch(m=>{throw new zr(m)}),v=u.headers.get("x-relay-error");if(v&&v==="true")throw new Gr(u);if(!u.ok)throw new qr(u);let x=((t=u.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),w;return x==="application/json"?w=yield u.json():x==="application/octet-stream"?w=yield u.blob():x==="text/event-stream"?w=u:x==="multipart/form-data"?w=yield u.formData():w=yield u.text(),{data:w,error:null}}catch(r){return{data:null,error:r}}})}};var Gc=ku(zc(),1),{PostgrestClient:qc,PostgrestQueryBuilder:Dv,PostgrestFilterBuilder:Rv,PostgrestTransformBuilder:Ov,PostgrestBuilder:Pv,PostgrestError:Nv}=Gc.default;var Wc="2.11.2";var Yc={"X-Client-Info":`realtime-js/${Wc}`},Kc="1.0.0",Zr=1e4,Zc=1e3,Ii=function(n){return n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",n}(Ii||{}),Le=function(n){return n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving",n}(Le||{}),He=function(n){return n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",n}(He||{}),ua=function(n){return n.websocket="websocket",n}(ua||{}),Zt=function(n){return n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed",n}(Zt||{});var Jr=class{constructor(){this.HEADER_LENGTH=1}decode(i,e){return i.constructor===ArrayBuffer?e(this._binaryDecode(i)):e(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){let e=new DataView(i),t=new TextDecoder;return this._decodeBroadcast(i,e,t)}_decodeBroadcast(i,e,t){let r=e.getUint8(1),s=e.getUint8(2),o=this.HEADER_LENGTH+2,l=t.decode(i.slice(o,o+r));o=o+r;let a=t.decode(i.slice(o,o+s));o=o+s;let c=JSON.parse(t.decode(i.slice(o,i.byteLength)));return{ref:null,topic:l,event:a,payload:c}}};var ki=class{constructor(i,e){this.callback=i,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var te=function(n){return n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange",n}(te||{}),fa=(n,i,e={})=>{var t;let r=(t=e.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(i).reduce((s,o)=>(s[o]=cm(o,n,i,r),s),{})},cm=(n,i,e,t)=>{let r=i.find(l=>l.name===n),s=r?.type,o=e[n];return s&&!t.includes(s)?Jc(s,o):ha(o)},Jc=(n,i)=>{if(n.charAt(0)==="_"){let e=n.slice(1,n.length);return fm(i,e)}switch(n){case te.bool:return dm(i);case te.float4:case te.float8:case te.int2:case te.int4:case te.int8:case te.numeric:case te.oid:return um(i);case te.json:case te.jsonb:return hm(i);case te.timestamp:return mm(i);case te.abstime:case te.date:case te.daterange:case te.int4range:case te.int8range:case te.money:case te.reltime:case te.text:case te.time:case te.timestamptz:case te.timetz:case te.tsrange:case te.tstzrange:return ha(i);default:return ha(i)}},ha=n=>n,dm=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},um=n=>{if(typeof n=="string"){let i=parseFloat(n);if(!Number.isNaN(i))return i}return n},hm=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(i){return console.log(`JSON parse error: ${i}`),n}return n},fm=(n,i)=>{if(typeof n!="string")return n;let e=n.length-1,t=n[e];if(n[0]==="{"&&t==="}"){let s,o=n.slice(1,e);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Jc(i,l))}return n},mm=n=>typeof n=="string"?n.replace(" ","T"):n,Qr=n=>{let i=n;return i=i.replace(/^ws/i,"http"),i=i.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),i.replace(/\/+$/,"")};var Ai=class{constructor(i,e,t={},r=Zr){this.channel=i,this.event=e,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,e){var t;return this._hasReceived(i)&&e((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:i,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let i=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:e}){this.recHooks.filter(t=>t.status===i).forEach(t=>t.callback(e))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}};var Pn=class n{constructor(i,e){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let t=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{let{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=n.syncState(this.state,r,s,o),this.pendingDiffs.forEach(a=>{this.state=n.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},r=>{let{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=n.syncDiff(this.state,r,s,o),l())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,e,t,r){let s=this.cloneDeep(i),o=this.transformState(e),l={},a={};return this.map(s,(c,u)=>{o[c]||(a[c]=u)}),this.map(o,(c,u)=>{let v=s[c];if(v){let x=u.map(F=>F.presence_ref),w=v.map(F=>F.presence_ref),m=u.filter(F=>w.indexOf(F.presence_ref)<0),M=v.filter(F=>x.indexOf(F.presence_ref)<0);m.length>0&&(l[c]=m),M.length>0&&(a[c]=M)}else l[c]=u}),this.syncDiff(s,{joins:l,leaves:a},t,r)}static syncDiff(i,e,t,r){let{joins:s,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(l,a)=>{var c;let u=(c=i[l])!==null&&c!==void 0?c:[];if(i[l]=this.cloneDeep(a),u.length>0){let v=i[l].map(w=>w.presence_ref),x=u.filter(w=>v.indexOf(w.presence_ref)<0);i[l].unshift(...x)}t(l,u,a)}),this.map(o,(l,a)=>{let c=i[l];if(!c)return;let u=a.map(v=>v.presence_ref);c=c.filter(v=>u.indexOf(v.presence_ref)<0),i[l]=c,r(l,c,a),c.length===0&&delete i[l]}),i}static map(i,e){return Object.getOwnPropertyNames(i).map(t=>e(t,i[t]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((e,t)=>{let r=i[t];return"metas"in r?e[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[t]=r,e},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var vt=function(n){return n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR",n}(vt||{});var Nn=class n{constructor(i,e={config:{}},t){this.topic=i,this.params=e,this.socket=t,this.bindings={},this.state=Le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Ai(this,He.join,this.params,this.timeout),this.rejoinTimer=new ki(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Le.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(He.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new Pn(this),this.broadcastEndpointURL=Qr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(i,e=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:s,presence:o,private:l}}=this.params;this._onError(u=>i?.(vt.CHANNEL_ERROR,u)),this._onClose(()=>i?.(vt.CLOSED));let a={},c={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[],private:l};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",v=>f(this,[v],function*({postgres_changes:u}){var x;if(this.socket.setAuth(),u===void 0){i?.(vt.SUBSCRIBED);return}else{let w=this.bindings.postgres_changes,m=(x=w?.length)!==null&&x!==void 0?x:0,M=[];for(let F=0;F<m;F++){let Z=w[F],{filter:{event:Ee,schema:_e,table:Me,filter:De}}=Z,wt=u&&u[F];if(wt&&wt.event===Ee&&wt.schema===_e&&wt.table===Me&&wt.filter===De)M.push(Object.assign(Object.assign({},Z),{id:wt.id}));else{this.unsubscribe(),i?.(vt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=M,i&&i(vt.SUBSCRIBED);return}})).receive("error",u=>{i?.(vt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{i?.(vt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(t){return f(this,arguments,function*(i,e={}){return yield this.send({type:"presence",event:"track",payload:i},e.timeout||this.timeout)})}untrack(){return f(this,arguments,function*(i={}){return yield this.send({type:"presence",event:"untrack"},i)})}on(i,e,t){return this._on(i,e,t)}send(t){return f(this,arguments,function*(i,e={}){var r,s;if(!this._canPush()&&i.type==="broadcast"){let{event:o,payload:l}=i,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{let u=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=e.timeout)!==null&&r!==void 0?r:this.timeout);return yield(s=u.body)===null||s===void 0?void 0:s.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,a,c;let u=this._push(i.type,i,e.timeout||this.timeout);i.type==="broadcast"&&!(!((c=(a=(l=this.params)===null||l===void 0?void 0:l.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=Le.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(He.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{let r=new Ai(this,He.leave,{},i);r.receive("ok",()=>{e(),t("ok")}).receive("timeout",()=>{e(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_fetchWithTimeout(i,e,t){return f(this,null,function*(){let r=new AbortController,s=setTimeout(()=>r.abort(),t),o=yield this.socket.fetch(i,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(s),o})}_push(i,e,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ai(this,i,e,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(i,e,t){return e}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,e,t){var r,s;let o=i.toLocaleLowerCase(),{close:l,error:a,leave:c,join:u}=He;if(t&&[l,a,c,u].indexOf(o)>=0&&t!==this._joinRef())return;let x=this._onMessage(o,e,t);if(e&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(w=>{var m,M,F;return((m=w.filter)===null||m===void 0?void 0:m.event)==="*"||((F=(M=w.filter)===null||M===void 0?void 0:M.event)===null||F===void 0?void 0:F.toLocaleLowerCase())===o}).map(w=>w.callback(x,t)):(s=this.bindings[o])===null||s===void 0||s.filter(w=>{var m,M,F,Z,Ee,_e;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in w){let Me=w.id,De=(m=w.filter)===null||m===void 0?void 0:m.event;return Me&&((M=e.ids)===null||M===void 0?void 0:M.includes(Me))&&(De==="*"||De?.toLocaleLowerCase()===((F=e.data)===null||F===void 0?void 0:F.type.toLocaleLowerCase()))}else{let Me=(Ee=(Z=w?.filter)===null||Z===void 0?void 0:Z.event)===null||Ee===void 0?void 0:Ee.toLocaleLowerCase();return Me==="*"||Me===((_e=e?.event)===null||_e===void 0?void 0:_e.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===o}).map(w=>{if(typeof x=="object"&&"ids"in x){let m=x.data,{schema:M,table:F,commit_timestamp:Z,type:Ee,errors:_e}=m;x=Object.assign(Object.assign({},{schema:M,table:F,commit_timestamp:Z,eventType:Ee,new:{},old:{},errors:_e}),this._getPayloadRecords(m))}w.callback(x,t)})}_isClosed(){return this.state===Le.closed}_isJoined(){return this.state===Le.joined}_isJoining(){return this.state===Le.joining}_isLeaving(){return this.state===Le.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,e,t){let r=i.toLocaleLowerCase(),s={type:r,filter:e,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(i,e){let t=i.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&n.isEqual(r.filter,e))}),this}static isEqual(i,e){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(i[t]!==e[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(He.close,{},i)}_onError(i){this._on(He.error,{},e=>i(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Le.joining,this.joinPush.resend(i))}_getPayloadRecords(i){let e={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(e.new=fa(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(e.old=fa(i.columns,i.old_record)),e}};var gm=()=>{},_m=typeof WebSocket<"u",vm=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,Fn=class{constructor(i,e){var t;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Yc,this.params={},this.timeout=Zr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=gm,this.conn=null,this.sendBuffer=[],this.serializer=new Jr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>import("./chunk-NPJLHOA5.js").then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${i}/${ua.websocket}`,this.httpEndpoint=Qr(i),e?.transport?this.transport=e.transport:this.transport=null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);let r=(t=e?.params)===null||t===void 0?void 0:t.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,o)=>o(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ki(()=>f(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch),e?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=e?.worker||!1,this.workerUrl=e?.workerUrl}this.accessToken=e?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(_m){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ma(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),import("./chunk-GFTZZNGD.js").then(({default:i})=>{this.conn=new i(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Kc}))}disconnect(i,e){this.conn&&(this.conn.onclose=function(){},i?this.conn.close(i,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(i){return f(this,null,function*(){let e=yield i.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return f(this,null,function*(){let i=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),i})}log(i,e,t){this.logger(i,e,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Ii.connecting:return Zt.Connecting;case Ii.open:return Zt.Open;case Ii.closing:return Zt.Closing;default:return Zt.Closed}}isConnected(){return this.connectionState()===Zt.Open}channel(i,e={config:{}}){let t=new Nn(`realtime:${i}`,e,this);return this.channels.push(t),t}push(i){let{topic:e,event:t,payload:r,ref:s}=i,o=()=>{this.encode(i,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${e} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(i=null){return f(this,null,function*(){let e=i||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;if(e){let t=null;try{t=JSON.parse(atob(e.split(".")[1]))}catch{}if(t&&t.exp&&!(Math.floor(Date.now()/1e3)-t.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`);this.accessTokenValue=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e}),r.joinedOnce&&r._isJoined()&&r._push(He.access_token,{access_token:e})})}})}sendHeartbeat(){return f(this,null,function*(){var i;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(i=this.conn)===null||i===void 0||i.close(Zc,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}})}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let e=this.channels.find(t=>t.topic===i&&(t._isJoined()||t._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${i}"`),e.unsubscribe())}_remove(i){this.channels=this.channels.filter(e=>e._joinRef()!==i._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i))}_onConnMessage(i){this.decode(i.data,e=>{let{topic:t,event:r,payload:s,ref:o}=e;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(e))})}_onConnOpen(){return f(this,null,function*(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let i=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(i),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(i=>i())})}_onConnClose(i){this.log("transport","close",i),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(i))}_onConnError(i){this.log("transport",i.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(i))}_triggerChanError(){this.channels.forEach(i=>i._trigger(He.error))}_appendParams(i,e){if(Object.keys(e).length===0)return i;let t=i.match(/\?/)?"&":"?",r=new URLSearchParams(e);return`${i}${t}${r}`}_workerObjectUrl(i){let e;if(i)e=i;else{let t=new Blob([vm],{type:"application/javascript"});e=URL.createObjectURL(t)}return e}};var ma=class{constructor(i,e,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ii.connecting,this.send=()=>{},this.url=null,this.url=i,this.close=t.close}};var Di=class extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}};function de(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Xr=class extends Di{constructor(i,e){super(i),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}},Jt=class extends Di{constructor(i,e){super(i),this.name="StorageUnknownError",this.originalError=e}};var ym=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},ts=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):i=fetch,(...e)=>i(...e)},Qc=()=>ym(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-NPJLHOA5.js")).Response:Response}),es=n=>{if(Array.isArray(n))return n.map(e=>es(e));if(typeof n=="function"||n!==Object(n))return n;let i={};return Object.entries(n).forEach(([e,t])=>{let r=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));i[r]=es(t)}),i};var Qt=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},pa=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),bm=(n,i,e)=>Qt(void 0,void 0,void 0,function*(){let t=yield Qc();n instanceof t&&!e?.noResolveJson?n.json().then(r=>{i(new Xr(pa(r),n.status||500))}).catch(r=>{i(new Jt(pa(r),r))}):i(new Jt(pa(n),n))}),xm=(n,i,e,t)=>{let r={method:n,headers:i?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},i?.headers),t&&(r.body=JSON.stringify(t)),Object.assign(Object.assign({},r),e))};function Ln(n,i,e,t,r,s){return Qt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(e,xm(i,t,r,s)).then(a=>{if(!a.ok)throw a;return t?.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>bm(a,l,t))})})}function Ri(n,i,e,t){return Qt(this,void 0,void 0,function*(){return Ln(n,"GET",i,e,t)})}function at(n,i,e,t,r){return Qt(this,void 0,void 0,function*(){return Ln(n,"POST",i,t,r,e)})}function Xc(n,i,e,t,r){return Qt(this,void 0,void 0,function*(){return Ln(n,"PUT",i,t,r,e)})}function ed(n,i,e,t){return Qt(this,void 0,void 0,function*(){return Ln(n,"HEAD",i,Object.assign(Object.assign({},e),{noResolveJson:!0}),t)})}function is(n,i,e,t,r){return Qt(this,void 0,void 0,function*(){return Ln(n,"DELETE",i,t,r,e)})}var Ae=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},Sm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},td={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},ns=class{constructor(i,e={},t,r){this.url=i,this.headers=e,this.bucketId=t,this.fetch=ts(r)}uploadOrUpdate(i,e,t,r){return Ae(this,void 0,void 0,function*(){try{let s,o=Object.assign(Object.assign({},td),r),l=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String(o.upsert)}),a=o.metadata;typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),r?.headers&&(l=Object.assign(Object.assign({},l),r.headers));let c=this._removeEmptyFolders(e),u=this._getFinalPath(c),v=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:i,body:s,headers:l},o?.duplex?{duplex:o.duplex}:{})),x=yield v.json();return v.ok?{data:{path:c,id:x.Id,fullPath:x.Key},error:null}:{data:null,error:x}}catch(s){if(de(s))return{data:null,error:s};throw s}})}upload(i,e,t){return Ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,e,t)})}uploadToSignedUrl(i,e,t,r){return Ae(this,void 0,void 0,function*(){let s=this._removeEmptyFolders(i),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",e);try{let a,c=Object.assign({upsert:td.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",c.cacheControl)):(a=t,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);let v=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:u}),x=yield v.json();return v.ok?{data:{path:s,fullPath:x.Key},error:null}:{data:null,error:x}}catch(a){if(de(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(i,e){return Ae(this,void 0,void 0,function*(){try{let t=this._getFinalPath(i),r=Object.assign({},this.headers);e?.upsert&&(r["x-upsert"]="true");let s=yield at(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:r}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new Di("No token returned by API");return{data:{signedUrl:o.toString(),path:i,token:l},error:null}}catch(t){if(de(t))return{data:null,error:t};throw t}})}update(i,e,t){return Ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,e,t)})}move(i,e,t){return Ae(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}copy(i,e,t){return Ae(this,void 0,void 0,function*(){try{return{data:{path:(yield at(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}createSignedUrl(i,e,t){return Ae(this,void 0,void 0,function*(){try{let r=this._getFinalPath(i),s=yield at(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:this.headers}),o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}createSignedUrls(i,e,t){return Ae(this,void 0,void 0,function*(){try{let r=yield at(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:i},{headers:this.headers}),s=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}download(i,e){return Ae(this,void 0,void 0,function*(){let r=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),o=s?`?${s}`:"";try{let l=this._getFinalPath(i);return{data:yield(yield Ri(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(de(l))return{data:null,error:l};throw l}})}info(i){return Ae(this,void 0,void 0,function*(){let e=this._getFinalPath(i);try{let t=yield Ri(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:es(t),error:null}}catch(t){if(de(t))return{data:null,error:t};throw t}})}exists(i){return Ae(this,void 0,void 0,function*(){let e=this._getFinalPath(i);try{return yield ed(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(t){if(de(t)&&t instanceof Jt){let r=t.originalError;if([400,404].includes(r?.status))return{data:!1,error:t}}throw t}})}getPublicUrl(i,e){let t=this._getFinalPath(i),r=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);let l=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&r.push(a);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${c}`)}}}remove(i){return Ae(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(e){if(de(e))return{data:null,error:e};throw e}})}list(i,e,t){return Ae(this,void 0,void 0,function*(){try{let r=Object.assign(Object.assign(Object.assign({},Sm),e),{prefix:i||""});return{data:yield at(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){let e=[];return i.width&&e.push(`width=${i.width}`),i.height&&e.push(`height=${i.height}`),i.resize&&e.push(`resize=${i.resize}`),i.format&&e.push(`format=${i.format}`),i.quality&&e.push(`quality=${i.quality}`),e.join("&")}};var id="2.7.1";var nd={"X-Client-Info":`storage-js/${id}`};var Oi=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},rs=class{constructor(i,e={},t){this.url=i,this.headers=Object.assign(Object.assign({},nd),e),this.fetch=ts(t)}listBuckets(){return Oi(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}})}getBucket(i){return Oi(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(e){if(de(e))return{data:null,error:e};throw e}})}createBucket(i,e={public:!1}){return Oi(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,`${this.url}/bucket`,{id:i,name:i,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(de(t))return{data:null,error:t};throw t}})}updateBucket(i,e){return Oi(this,void 0,void 0,function*(){try{return{data:yield Xc(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(de(t))return{data:null,error:t};throw t}})}emptyBucket(i){return Oi(this,void 0,void 0,function*(){try{return{data:yield at(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(de(e))return{data:null,error:e};throw e}})}deleteBucket(i){return Oi(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(e){if(de(e))return{data:null,error:e};throw e}})}};var Vn=class extends rs{constructor(i,e={},t){super(i,e,t)}from(i){return new ns(this.url,this.headers,i,this.fetch)}};var rd="2.47.10";var jn="";typeof Deno<"u"?jn="deno":typeof document<"u"?jn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?jn="react-native":jn="node";var wm={"X-Client-Info":`supabase-js-${jn}/${rd}`},sd={headers:wm},od={schema:"public"},ad={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ld={};Cl();var Cm=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},Tm=n=>{let i;return n?i=n:typeof fetch>"u"?i=Sl:i=fetch,(...e)=>i(...e)},Em=()=>typeof Headers>"u"?wl:Headers,cd=(n,i,e)=>{let t=Tm(e),r=Em();return(s,o)=>Cm(void 0,void 0,void 0,function*(){var l;let a=(l=yield i())!==null&&l!==void 0?l:n,c=new r(o?.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),t(s,Object.assign(Object.assign({},o),{headers:c}))})};var Mm=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})};function dd(n){return n.replace(/\/$/,"")}function ud(n,i){let{db:e,auth:t,realtime:r,global:s}=n,{db:o,auth:l,realtime:a,global:c}=i,u={db:Object.assign(Object.assign({},o),e),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},c),s),accessToken:()=>Mm(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}var ss="2.67.3";var hd="http://localhost:9999",fd="supabase.auth.token";var md={"X-Client-Info":`gotrue-js/${ss}`},ga=10;var Un="X-Supabase-Api-Version",_a={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function pd(n){return Math.round(Date.now()/1e3)+n}function gd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let i=Math.random()*16|0;return(n=="x"?i:i&3|8).toString(16)})}var Qe=()=>typeof window<"u"&&typeof document<"u",Xt={tested:!1,writable:!1},Pt=()=>{if(!Qe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xt.tested)return Xt.writable;let n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Xt.tested=!0,Xt.writable=!0}catch{Xt.tested=!0,Xt.writable=!1}return Xt.writable};function _d(n){let i={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((r,s)=>{i[s]=r})}catch{}return e.searchParams.forEach((t,r)=>{i[r]=t}),i}var os=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...e)=>import("./chunk-NPJLHOA5.js").then(({default:t})=>t(...e)):i=fetch,(...e)=>i(...e)},vd=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",va=(n,i,e)=>f(void 0,null,function*(){yield n.setItem(i,JSON.stringify(e))}),Bn=(n,i)=>f(void 0,null,function*(){let e=yield n.getItem(i);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Hn=(n,i)=>f(void 0,null,function*(){yield n.removeItem(i)});function Im(n){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="",t,r,s,o,l,a,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)o=i.indexOf(n.charAt(u++)),l=i.indexOf(n.charAt(u++)),a=i.indexOf(n.charAt(u++)),c=i.indexOf(n.charAt(u++)),t=o<<2|l>>4,r=(l&15)<<4|a>>2,s=(a&3)<<6|c,e=e+String.fromCharCode(t),a!=64&&r!=0&&(e=e+String.fromCharCode(r)),c!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}var $n=class n{constructor(){this.promise=new n.promiseConstructor((i,e)=>{this.resolve=i,this.reject=e})}};$n.promiseConstructor=Promise;function ya(n){let i=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=n.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!i.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");let t=e[1];return JSON.parse(Im(t))}function yd(n){return f(this,null,function*(){return yield new Promise(i=>{setTimeout(()=>i(null),n)})})}function bd(n,i){return new Promise((t,r)=>{f(this,null,function*(){for(let s=0;s<1/0;s++)try{let o=yield n(s);if(!i(s,null,o)){t(o);return}}catch(o){if(!i(s,o)){r(o);return}}})})}function km(n){return("0"+n.toString(16)).substr(-2)}function Am(){let i=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(i),Array.from(i,km).join("")}function Dm(n){return f(this,null,function*(){let e=new TextEncoder().encode(n),t=yield crypto.subtle.digest("SHA-256",e),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")})}function Rm(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Om(n){return f(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;let e=yield Dm(n);return Rm(e)})}function ei(n,i,e=!1){return f(this,null,function*(){let t=Am(),r=t;e&&(r+="/PASSWORD_RECOVERY"),yield va(n,`${i}-code-verifier`,r);let s=yield Om(t);return[s,t===s?"plain":"s256"]})}var Pm=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xd(n){let i=n.headers.get(Un);if(!i||!i.match(Pm))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}var zn=class extends Error{constructor(i,e,t){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=t}};function j(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}var as=class extends zn{constructor(i,e,t){super(i,e,t),this.name="AuthApiError",this.status=e,this.code=t}};function Sd(n){return j(n)&&n.name==="AuthApiError"}var Pi=class extends zn{constructor(i,e){super(i),this.name="AuthUnknownError",this.originalError=e}},yt=class extends zn{constructor(i,e,t,r){super(i,t,r),this.name=e,this.status=t}},ze=class extends yt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function wd(n){return j(n)&&n.name==="AuthSessionMissingError"}var Ni=class extends yt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ti=class extends yt{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}},ii=class extends yt{constructor(i,e=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function Cd(n){return j(n)&&n.name==="AuthImplicitGrantRedirectError"}var Gn=class extends yt{constructor(i,e=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Fi=class extends yt{constructor(i,e){super(i,"AuthRetryableFetchError",e,void 0)}};function ls(n){return j(n)&&n.name==="AuthRetryableFetchError"}var qn=class extends yt{constructor(i,e,t){super(i,"AuthWeakPasswordError",e,"weak_password"),this.reasons=t}};var Nm=function(n,i){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&i.indexOf(t)<0&&(e[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(n);r<t.length;r++)i.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(n,t[r])&&(e[t[r]]=n[t[r]]);return e},ni=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fm=[502,503,504];function Td(n){return f(this,null,function*(){var i;if(!vd(n))throw new Fi(ni(n),0);if(Fm.includes(n.status))throw new Fi(ni(n),n.status);let e;try{e=yield n.json()}catch(s){throw new Pi(ni(s),s)}let t,r=xd(n);if(r&&r.getTime()>=_a["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?t=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(t=e.error_code),t){if(t==="weak_password")throw new qn(ni(e),n.status,((i=e.weak_password)===null||i===void 0?void 0:i.reasons)||[]);if(t==="session_not_found")throw new ze}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new qn(ni(e),n.status,e.weak_password.reasons);throw new as(ni(e),n.status||500,t)})}var Lm=(n,i,e,t)=>{let r={method:n,headers:i?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i?.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),e))};function H(n,i,e,t){return f(this,null,function*(){var r;let s=Object.assign({},t?.headers);s[Un]||(s[Un]=_a["2024-01-01"].name),t?.jwt&&(s.Authorization=`Bearer ${t.jwt}`);let o=(r=t?.query)!==null&&r!==void 0?r:{};t?.redirectTo&&(o.redirect_to=t.redirectTo);let l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=yield Vm(n,i,e+l,{headers:s,noResolveJson:t?.noResolveJson},{},t?.body);return t?.xform?t?.xform(a):{data:Object.assign({},a),error:null}})}function Vm(n,i,e,t,r,s){return f(this,null,function*(){let o=Lm(i,t,r,s),l;try{l=yield n(e,Object.assign({},o))}catch(a){throw console.error(a),new Fi(ni(a),0)}if(l.ok||(yield Td(l)),t?.noResolveJson)return l;try{return yield l.json()}catch(a){yield Td(a)}})}function bt(n){var i;let e=null;jm(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=pd(n.expires_in)));let t=(i=n.user)!==null&&i!==void 0?i:n;return{data:{session:e,user:t},error:null}}function ba(n){let i=bt(n);return!i.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,t)=>e&&typeof t=="string",!0)&&(i.data.weak_password=n.weak_password),i}function lt(n){var i;return{data:{user:(i=n.user)!==null&&i!==void 0?i:n},error:null}}function Ed(n){return{data:n,error:null}}function Md(n){let{action_link:i,email_otp:e,hashed_token:t,redirect_to:r,verification_type:s}=n,o=Nm(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:i,email_otp:e,hashed_token:t,redirect_to:r,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Id(n){return n}function jm(n){return n.access_token&&n.refresh_token&&n.expires_in}var Um=function(n,i){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&i.indexOf(t)<0&&(e[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(n);r<t.length;r++)i.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(n,t[r])&&(e[t[r]]=n[t[r]]);return e},Li=class{constructor({url:i="",headers:e={},fetch:t}){this.url=i,this.headers=e,this.fetch=os(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(i,e="global"){return f(this,null,function*(){try{return yield H(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}})}inviteUserByEmail(t){return f(this,arguments,function*(i,e={}){try{return yield H(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:lt})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}})}generateLink(i){return f(this,null,function*(){try{let{options:e}=i,t=Um(i,["options"]),r=Object.assign(Object.assign({},t),e);return"newEmail"in t&&(r.new_email=t?.newEmail,delete r.newEmail),yield H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Md,redirectTo:e?.redirectTo})}catch(e){if(j(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(i){return f(this,null,function*(){try{return yield H(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:lt})}catch(e){if(j(e))return{data:{user:null},error:e};throw e}})}listUsers(i){return f(this,null,function*(){var e,t,r,s,o,l,a;try{let c={nextPage:null,lastPage:0,total:0},u=yield H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(e=i?.page)===null||e===void 0?void 0:e.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=i?.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:Id});if(u.error)throw u.error;let v=yield u.json(),x=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,w=(a=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return w.length>0&&(w.forEach(m=>{let M=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),F=JSON.parse(m.split(";")[1].split("=")[1]);c[`${F}Page`]=M}),c.total=parseInt(x)),{data:Object.assign(Object.assign({},v),c),error:null}}catch(c){if(j(c))return{data:{users:[]},error:c};throw c}})}getUserById(i){return f(this,null,function*(){try{return yield H(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:lt})}catch(e){if(j(e))return{data:{user:null},error:e};throw e}})}updateUserById(i,e){return f(this,null,function*(){try{return yield H(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:e,headers:this.headers,xform:lt})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}})}deleteUser(i,e=!1){return f(this,null,function*(){try{return yield H(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:e},xform:lt})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}})}_listFactors(i){return f(this,null,function*(){try{let{data:e,error:t}=yield H(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:e,error:t}}catch(e){if(j(e))return{data:null,error:e};throw e}})}_deleteFactor(i){return f(this,null,function*(){try{return{data:yield H(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(e){if(j(e))return{data:null,error:e};throw e}})}};var kd={getItem:n=>Pt()?globalThis.localStorage.getItem(n):null,setItem:(n,i)=>{Pt()&&globalThis.localStorage.setItem(n,i)},removeItem:n=>{Pt()&&globalThis.localStorage.removeItem(n)}};function xa(n={}){return{getItem:i=>n[i]||null,setItem:(i,e)=>{n[i]=e},removeItem:i=>{delete n[i]}}}function Ad(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var ri={debug:!!(globalThis&&Pt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},Wn=class extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}},cs=class extends Wn{};function Sa(n,i,e){return f(this,null,function*(){ri.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,i);let t=new globalThis.AbortController;return i>0&&setTimeout(()=>{t.abort(),ri.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},i),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(n,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},r=>f(this,null,function*(){if(r){ri.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return yield e()}finally{ri.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(i===0)throw ri.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new cs(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ri.debug)try{let s=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}Ad();var $m={url:hd,storageKey:fd,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:md,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Yn=30*1e3,Dd=3;function Rd(n,i,e){return f(this,null,function*(){return yield e()})}var wa=(()=>{class n{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=n.nextInstanceID,n.nextInstanceID+=1,this.instanceID>0&&Qe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let s=Object.assign(Object.assign({},$m),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Li({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=os(s.fetch),this.lock=s.lock||Rd,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Qe()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Sa:this.lock=Rd,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Pt()?this.storage=kd:(this.memoryStorage={},this.storage=xa(this.memoryStorage)):(this.memoryStorage={},this.storage=xa(this.memoryStorage)),Qe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",o=>f(this,null,function*(){this._debug("received broadcast notification from other tab or client",o),yield this._notifyAllSubscribers(o.data.event,o.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ss}) ${new Date().toISOString()}`,...e),this}initialize(){return f(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=f(this,null,function*(){return yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return f(this,null,function*(){var e;try{let t=_d(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":(yield this._isPKCECallback(t))&&(r="pkce"),Qe()&&this.detectSessionInUrl&&r!=="none"){let{data:s,error:o}=yield this._getSessionFromURL(t,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Cd(o)){let c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return yield this._removeSession(),{error:o}}let{session:l,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",a),yield this._saveSession(l),setTimeout(()=>f(this,null,function*(){a==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",l):yield this._notifyAllSubscribers("SIGNED_IN",l)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return j(t)?{error:t}:{error:new Pi("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return f(this,null,function*(){var t,r,s;try{let o=yield H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:bt}),{data:l,error:a}=o;if(a||!l)return{data:{user:null,session:null},error:a};let c=l.session,u=l.user;return l.session&&(yield this._saveSession(l.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(j(o))return{data:{user:null,session:null},error:o};throw o}})}signUp(e){return f(this,null,function*(){var t,r,s;try{let o;if("email"in e){let{email:v,password:x,options:w}=e,m=null,M=null;this.flowType==="pkce"&&([m,M]=yield ei(this.storage,this.storageKey)),o=yield H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:v,password:x,data:(t=w?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:m,code_challenge_method:M},xform:bt})}else if("phone"in e){let{phone:v,password:x,options:w}=e;o=yield H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(r=w?.data)!==null&&r!==void 0?r:{},channel:(s=w?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:bt})}else throw new ti("You must provide either an email or phone number and a password");let{data:l,error:a}=o;if(a||!l)return{data:{user:null,session:null},error:a};let c=l.session,u=l.user;return l.session&&(yield this._saveSession(l.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(j(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(e){return f(this,null,function*(){try{let t;if("email"in e){let{email:o,password:l,options:a}=e;t=yield H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:ba})}else if("phone"in e){let{phone:o,password:l,options:a}=e;t=yield H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:ba})}else throw new ti("You must provide either an email or phone number and a password");let{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ni}:(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOAuth(e){return f(this,null,function*(){var t,r,s,o;return yield this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return f(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>f(this,null,function*(){return this._exchangeCodeForSession(e)}))})}_exchangeCodeForSession(e){return f(this,null,function*(){let t=yield Bn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{let{data:o,error:l}=yield H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:bt});if(yield Hn(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Ni}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:l})}catch(o){if(j(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}})}signInWithIdToken(e){return f(this,null,function*(){try{let{options:t,provider:r,token:s,access_token:o,nonce:l}=e,a=yield H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:bt}),{data:c,error:u}=a;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ni}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOtp(e){return f(this,null,function*(){var t,r,s,o,l;try{if("email"in e){let{email:a,options:c}=e,u=null,v=null;this.flowType==="pkce"&&([u,v]=yield ei(this.storage,this.storageKey));let{error:x}=yield H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:v},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in e){let{phone:a,options:c}=e,{data:u,error:v}=yield H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(l=c?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:v}}throw new ti("You must provide either an email or phone number.")}catch(a){if(j(a))return{data:{user:null,session:null},error:a};throw a}})}verifyOtp(e){return f(this,null,function*(){var t,r;try{let s,o;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);let{data:l,error:a}=yield H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:bt});if(a)throw a;if(!l)throw new Error("An error occurred on token verification.");let c=l.session,u=l.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(j(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithSSO(e){return f(this,null,function*(){var t,r,s;try{let o=null,l=null;return this.flowType==="pkce"&&([o,l]=yield ei(this.storage,this.storageKey)),yield H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Ed})}catch(o){if(j(o))return{data:null,error:o};throw o}})}reauthenticate(){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return f(this,null,function*(){try{return yield this._useSession(e=>f(this,null,function*(){let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ze;let{error:s}=yield H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}}))}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return f(this,null,function*(){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:s,options:o}=e,{error:l}=yield H(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){let{phone:r,type:s,options:o}=e,{data:l,error:a}=yield H(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:a}}throw new ti("You must provide either an email or phone number and a type")}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}})}getSession(){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return this._useSession(t=>f(this,null,function*(){return t}))}))})}_acquireLock(e,t){return f(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=f(this,null,function*(){return yield r,yield t()});return this.pendingInLock.push(f(this,null,function*(){try{yield s}catch{}})),s}return yield this.lock(`lock:${this.storageKey}`,e,()=>f(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let r=t();for(this.pendingInLock.push(f(this,null,function*(){try{yield r}catch{}})),yield r;this.pendingInLock.length;){let s=[...this.pendingInLock];yield Promise.all(s),this.pendingInLock.splice(0,s.length)}return yield r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return f(this,null,function*(){this._debug("#_useSession","begin");try{let t=yield this.__loadSession();return yield e(t)}finally{this._debug("#_useSession","end")}})}__loadSession(){return f(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,t=yield Bn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,v)=>(!l&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,v))})}return{data:{session:e},error:null}}let{session:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return f(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return f(this,null,function*(){try{return e?yield H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:lt}):yield this._useSession(t=>f(this,null,function*(){var r,s,o;let{data:l,error:a}=t;if(a)throw a;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ze}:yield H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:lt})}))}catch(t){if(j(t))return wd(t)&&(yield this._removeSession(),yield Hn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}})}updateUser(r){return f(this,arguments,function*(e,t={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._updateUser(e,t)}))})}_updateUser(r){return f(this,arguments,function*(e,t={}){try{return yield this._useSession(s=>f(this,null,function*(){let{data:o,error:l}=s;if(l)throw l;if(!o.session)throw new ze;let a=o.session,c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=yield ei(this.storage,this.storageKey));let{data:v,error:x}=yield H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:a.access_token,xform:lt});if(x)throw x;return a.user=v.user,yield this._saveSession(a),yield this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}}))}catch(s){if(j(s))return{data:{user:null},error:s};throw s}})}_decodeJWT(e){return ya(e)}setSession(e){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return f(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new ze;let t=Date.now()/1e3,r=t,s=!0,o=null,l=ya(e.access_token);if(l.exp&&(r=l.exp,s=r<=t),s){let{session:a,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};o=a}else{let{data:a,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(j(t))return{data:{session:null,user:null},error:t};throw t}})}refreshSession(e){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r;if(!e){let{data:l,error:a}=t;if(a)throw a;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ze;let{session:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}})}_getSessionFromURL(e,t){return f(this,null,function*(){try{if(!Qe())throw new ii("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ii(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Gn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ii("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Gn("No code detected.");let{data:_e,error:Me}=yield this._exchangeCodeForSession(e.code);if(Me)throw Me;let De=new URL(window.location.href);return De.searchParams.delete("code"),window.history.replaceState(window.history.state,"",De.toString()),{data:{session:_e.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:l,expires_in:a,expires_at:c,token_type:u}=e;if(!o||!a||!l||!u)throw new ii("No session defined in URL");let v=Math.round(Date.now()/1e3),x=parseInt(a),w=v+x;c&&(w=parseInt(c));let m=w-v;m*1e3<=Yn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${x}s`);let M=w-x;v-M>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",M,w,v):v-M<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",M,w,v);let{data:F,error:Z}=yield this._getUser(o);if(Z)throw Z;let Ee={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:x,expires_at:w,refresh_token:l,token_type:u,user:F.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:Ee,redirectType:e.type},error:null}}catch(r){if(j(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return f(this,null,function*(){let t=yield Bn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)})}signOut(){return f(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return f(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(t=>f(this,null,function*(){var r;let{data:s,error:o}=t;if(o)return{error:o};let l=(r=s.session)===null||r===void 0?void 0:r.access_token;if(l){let{error:a}=yield this.admin.signOut(l,e);if(a&&!(Sd(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(yield this._removeSession(),yield Hn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){let t=gd(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),f(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){this._emitInitialSession(t)}))}),{data:{subscription:r}}}_emitInitialSession(e){return f(this,null,function*(){return yield this._useSession(t=>f(this,null,function*(){var r,s;try{let{data:{session:o},error:l}=t;if(l)throw l;yield(r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(r){return f(this,arguments,function*(e,t={}){let s=null,o=null;this.flowType==="pkce"&&([s,o]=yield ei(this.storage,this.storageKey,!0));try{return yield H(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(j(l))return{data:null,error:l};throw l}})}getUserIdentities(){return f(this,null,function*(){var e;try{let{data:t,error:r}=yield this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}})}linkIdentity(e){return f(this,null,function*(){var t;try{let{data:r,error:s}=yield this._useSession(o=>f(this,null,function*(){var l,a,c,u,v;let{data:x,error:w}=o;if(w)throw w;let m=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield H(this.fetch,"GET",m,{headers:this.headers,jwt:(v=(u=x.session)===null||u===void 0?void 0:u.access_token)!==null&&v!==void 0?v:void 0})}));if(s)throw s;return Qe()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(j(r))return{data:{provider:e.provider,url:null},error:r};throw r}})}unlinkIdentity(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r,s;let{data:o,error:l}=t;if(l)throw l;return yield H(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})}))}catch(t){if(j(t))return{data:null,error:t};throw t}})}_refreshAccessToken(e){return f(this,null,function*(){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{let r=Date.now();return yield bd(s=>f(this,null,function*(){return s>0&&(yield yd(200*Math.pow(2,s-1))),this._debug(t,"refreshing attempt",s),yield H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:bt})}),(s,o)=>{let l=200*Math.pow(2,s);return o&&ls(o)&&Date.now()+l-r<Yn})}catch(r){if(this._debug(t,"error",r),j(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){return f(this,null,function*(){let r=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Qe()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}})}_recoverAndRefresh(){return f(this,null,function*(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=yield Bn(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&(yield this._removeSession());return}let s=Math.round(Date.now()/1e3),o=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+ga;if(this._debug(t,`session has${o?"":" not"} expired with margin of ${ga}s`),o){if(this.autoRefreshToken&&r.refresh_token){let{error:l}=yield this._callRefreshToken(r.refresh_token);l&&(console.error(l),ls(l)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",l),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}})}_callRefreshToken(e){return f(this,null,function*(){var t,r;if(!e)throw new ze;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new $n;let{data:o,error:l}=yield this._refreshAccessToken(e);if(l)throw l;if(!o.session)throw new ze;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),j(o)){let l={session:null,error:o};return ls(o)||(yield this._removeSession()),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}})}_notifyAllSubscribers(e,t,r=!0){return f(this,null,function*(){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let o=[],l=Array.from(this.stateChangeEmitters.values()).map(a=>f(this,null,function*(){try{yield a.callback(e,t)}catch(c){o.push(c)}}));if(yield Promise.all(l),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}})}_saveSession(e){return f(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,yield va(this.storage,this.storageKey,e)})}_removeSession(){return f(this,null,function*(){this._debug("#_removeSession()"),yield Hn(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qe()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}_startAutoRefresh(){return f(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),Yn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>f(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return f(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return f(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return f(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return f(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>f(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(t=>f(this,null,function*(){let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let s=Math.floor((r.expires_at*1e3-e)/Yn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Yn}ms, refresh threshold is ${Dd} ticks`),s<=Dd&&(yield this._callRefreshToken(r.refresh_token))}))}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof Wn)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return f(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!Qe()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>f(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return f(this,null,function*(){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,t,r){return f(this,null,function*(){let s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){let[o,l]=yield ei(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(a.toString())}if(r?.queryParams){let o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`})}_unenroll(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r;let{data:s,error:o}=t;return o?{data:null,error:o}:yield H(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})}))}catch(t){if(j(t))return{data:null,error:t};throw t}})}_enroll(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r,s;let{data:o,error:l}=t;if(l)return{data:null,error:l};let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=yield H(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(t){if(j(t))return{data:null,error:t};throw t}})}_verify(e){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r;let{data:s,error:o}=t;if(o)return{data:null,error:o};let{data:l,error:a}=yield H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:a})}))}catch(t){if(j(t))return{data:null,error:t};throw t}}))})}_challenge(e){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var r;let{data:s,error:o}=t;return o?{data:null,error:o}:yield H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})}))}catch(t){if(j(t))return{data:null,error:t};throw t}}))})}_challengeAndVerify(e){return f(this,null,function*(){let{data:t,error:r}=yield this._challenge({factorId:e.factorId});return r?{data:null,error:r}:yield this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})})}_listFactors(){return f(this,null,function*(){let{data:{user:e},error:t}=yield this.getUser();if(t)return{data:null,error:t};let r=e?.factors||[],s=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),o=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:s,phone:o},error:null}})}_getAuthenticatorAssuranceLevel(){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){return yield this._useSession(e=>f(this,null,function*(){var t,r;let{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let l=this._decodeJWT(s.access_token),a=null;l.aal&&(a=l.aal);let c=a;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(x=>x.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");let v=l.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:v},error:null}}))}))})}}return n.nextInstanceID=0,n})();var Bm=wa,Ca=Bm;var ds=class extends Ca{constructor(i){super(i)}};var Hm=function(n,i,e,t){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function l(u){try{c(t.next(u))}catch(v){o(v)}}function a(u){try{c(t.throw(u))}catch(v){o(v)}}function c(u){u.done?s(u.value):r(u.value).then(l,a)}c((t=t.apply(n,i||[])).next())})},us=class{constructor(i,e,t){var r,s,o;if(this.supabaseUrl=i,this.supabaseKey=e,!i)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");let l=dd(i);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;let a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:od,realtime:ld,auth:Object.assign(Object.assign({},ad),{storageKey:a}),global:sd},u=ud(t??{},c);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=cd(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new qc(`${l}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Mn(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Vn(this.storageUrl,this.headers,this.fetch)}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,e={},t={}){return this.rest.rpc(i,e,t)}channel(i,e={config:{}}){return this.realtime.channel(i,e)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var i,e;return Hm(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:t}=yield this.auth.getSession();return(e=(i=t.session)===null||i===void 0?void 0:i.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,lock:l,debug:a},c,u){var v;let x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ds({url:this.authUrl,headers:Object.assign(Object.assign({},x),c),storageKey:s,autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:r,flowType:o,lock:l,debug:a,fetch:u,hasCustomAuthorizationHeader:(v="Authorization"in this.headers)!==null&&v!==void 0?v:!1})}_initRealtimeClient(i){return new Fn(this.realtimeUrl,Object.assign(Object.assign({},i),{params:Object.assign({apikey:this.supabaseKey},i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(i,e,t){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==t?this.changedAccessToken=t:i==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Od=(n,i,e)=>new us(n,i,e);var Kn={production:!1,supabaseUrl:"https://nrapqjwyqvwopwoxevlw.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yYXBxand5cXZ3b3B3b3hldmx3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzA4MDU2MzQsImV4cCI6MjA0NjM4MTYzNH0.hq-X6YEAD7DG9WIiJhqwRb3ZtMruaEzAbr0Wm4TBoQU"};var J=class n{supabase;constructor(){this.supabase=Od(Kn.supabaseUrl,Kn.supabaseKey,{auth:{persistSession:!0}})}get client(){return this.supabase}uploadFile(i,e){return f(this,null,function*(){try{let{data:t,error:r}=yield this.supabase.storage.from("user_upload").exists(e);if(r)throw r;if(t)return`${Kn.supabaseUrl}/storage/v1/object/public/user_upload/${e}`;let{data:s,error:o}=yield this.supabase.storage.from("user_upload").upload(e,i),l=`${Kn.supabaseUrl}/storage/v1/object/public/user_upload/${e}`;if(o)throw o;return l}catch(t){throw console.error("Error uploading file:",t),t}})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var ct=class n{constructor(i){this.supabase=i;this.initSession(),this.supabase.client.auth.onAuthStateChange((e,t)=>{this._session=t,this._user=t?.user??null})}_user=null;_session=null;initSession(){return f(this,null,function*(){let{data:i,error:e}=yield this.supabase.client.auth.getSession();!e&&i.session&&(this._session=i.session,this._user=i.session.user)})}signUp(i,e){return f(this,null,function*(){let{data:t,error:r}=yield this.supabase.client.auth.signUp({email:i,password:e});if(r)throw r;return t})}signIn(i,e){return f(this,null,function*(){let{data:t,error:r}=yield this.supabase.client.auth.signInWithPassword({email:i,password:e});if(r)throw r;return t})}signOut(){return f(this,null,function*(){let{error:i}=yield this.supabase.client.auth.signOut();if(i)throw i})}get session(){return this._session}get user(){return this._user}isLoggedIn(){return!!this._user}static \u0275fac=function(e){return new(e||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function zm(n,i){if(n&1){let e=$();it(0),d(1,"nav")(2,"a",1)(3,"b"),p(4,"PANOU ADMINISTRARE"),h()(),d(5,"a",2),p(6,"Toate Rug\u0103ciunile"),h(),d(7,"a",3),p(8,"Tipuri de Rug\u0103ciuni"),h(),d(9,"a",4),p(10,"Sec\u021Biuni"),h(),d(11,"a",5),p(12,"Texte"),h(),d(13,"div",6)(14,"span"),p(15),h(),d(16,"button",7),S("click",function(){C(e);let r=y();return T(r.onLogout())}),p(17,"Delogare"),h()()(),ee(18,"hr"),nt()}if(n&2){let e=y();_(15),ne(e.auth.user==null?null:e.auth.user.email)}}var hs=class n{constructor(i,e){this.auth=i;this.router=e}title="my-prayer-admin";onLogout(){return f(this,null,function*(){try{yield this.auth.signOut(),this.router.navigate(["/login"])}catch(i){console.error("Error logging out:",i)}})}static \u0275fac=function(e){return new(e||n)(I(ct),I(be))};static \u0275cmp=X({type:n,selectors:[["app-root"]],decls:2,vars:1,consts:[[4,"ngIf"],[2,"display","inline","color","black"],["routerLink","/prayers"],["routerLink","/prayerTypes"],["routerLink","/sections"],["routerLink","/liturgicalTexts"],[2,"display","flex","float","right","width","min-content","gap","1rem"],[3,"click"]],template:function(e,t){e&1&&(D(0,zm,19,1,"ng-container",0),ee(1,"router-outlet")),e&2&&b("ngIf",t.auth.isLoggedIn())},dependencies:[ae,Ue,Wo,Be],styles:["nav[_ngcontent-%COMP%]{margin:1rem}a[_ngcontent-%COMP%]{margin-right:1rem;text-decoration:none;color:#790822}"]})};var Bd=(()=>{class n{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,t){this._renderer=e,this._elementRef=t}setProperty(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(t){return new(t||n)(I(Ye),I(Pe))};static \u0275dir=K({type:n})}return n})(),ir=(()=>{class n extends Bd{static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275dir=K({type:n,features:[Ke]})}return n})(),Nt=new G(""),Gm={provide:Nt,useExisting:et(()=>nr),multi:!0},nr=(()=>{class n extends ir{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275dir=K({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,r){t&1&&S("change",function(o){return r.onChange(o.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Te([Gm]),Ke]})}return n})(),qm={provide:Nt,useExisting:et(()=>ue),multi:!0};function Wm(){let n=mi()?mi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Ym=new G(""),ue=(()=>{class n extends Bd{_compositionMode;_composing=!1;constructor(e,t,r){super(e,t),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Wm())}writeValue(e){let t=e??"";this.setProperty("value",t)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(t){return new(t||n)(I(Ye),I(Pe),I(Ym,8))};static \u0275dir=K({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){t&1&&S("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},standalone:!1,features:[Te([qm]),Ke]})}return n})();var Hd=new G(""),zd=new G("");function Gd(n){return n!=null}function qd(n){return vr(n)?Ce(n):n}function Wd(n){let i={};return n.forEach(e=>{i=e!=null?E(E({},i),e):i}),Object.keys(i).length===0?null:i}function Yd(n,i){return i.map(e=>e(n))}function Km(n){return!n.validate}function Kd(n){return n.map(i=>Km(i)?i:e=>i.validate(e))}function Zm(n){if(!n)return null;let i=n.filter(Gd);return i.length==0?null:function(e){return Wd(Yd(e,i))}}function Ma(n){return n!=null?Zm(Kd(n)):null}function Jm(n){if(!n)return null;let i=n.filter(Gd);return i.length==0?null:function(e){let t=Yd(e,i).map(qd);return Ga(t).pipe(z(Wd))}}function Ia(n){return n!=null?Jm(Kd(n)):null}function Pd(n,i){return n===null?[i]:Array.isArray(n)?[...n,i]:[n,i]}function Qm(n){return n._rawValidators}function Xm(n){return n._rawAsyncValidators}function Ea(n){return n?Array.isArray(n)?n:[n]:[]}function ms(n,i){return Array.isArray(n)?n.includes(i):n===i}function Nd(n,i){let e=Ea(i);return Ea(n).forEach(r=>{ms(e,r)||e.push(r)}),e}function Fd(n,i){return Ea(i).filter(e=>!ms(n,e))}var ps=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=Ma(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=Ia(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i=void 0){this.control&&this.control.reset(i)}hasError(i,e){return this.control?this.control.hasError(i,e):!1}getError(i,e){return this.control?this.control.getError(i,e):null}},Ui=class extends ps{name;get formDirective(){return null}get path(){return null}},tr=class extends ps{_parent=null;name=null;valueAccessor=null},gs=class{_cd;constructor(i){this._cd=i}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},ep={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},wb=Y(E({},ep),{"[class.ng-submitted]":"isSubmitted"}),pe=(()=>{class n extends gs{constructor(e){super(e)}static \u0275fac=function(t){return new(t||n)(I(tr,2))};static \u0275dir=K({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){t&2&&hi("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Ke]})}return n})(),Zd=(()=>{class n extends gs{constructor(e){super(e)}static \u0275fac=function(t){return new(t||n)(I(Ui,10))};static \u0275dir=K({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){t&2&&hi("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Ke]})}return n})();var Zn="VALID",fs="INVALID",Vi="PENDING",Jn="DISABLED",$i=class{},_s=class extends $i{value;source;constructor(i,e){super(),this.value=i,this.source=e}},Xn=class extends $i{pristine;source;constructor(i,e){super(),this.pristine=i,this.source=e}},er=class extends $i{touched;source;constructor(i,e){super(),this.touched=i,this.source=e}},ji=class extends $i{status;source;constructor(i,e){super(),this.status=i,this.source=e}};function Jd(n){return(bs(n)?n.validators:n)||null}function tp(n){return Array.isArray(n)?Ma(n):n||null}function Qd(n,i){return(bs(i)?i.asyncValidators:n)||null}function ip(n){return Array.isArray(n)?Ia(n):n||null}function bs(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function np(n,i,e){let t=n.controls;if(!(i?Object.keys(t):t).length)throw new ie(1e3,"");if(!t[e])throw new ie(1001,"")}function rp(n,i,e){n._forEachChild((t,r)=>{if(e[r]===void 0)throw new ie(1002,"")})}var vs=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(i,e){this._assignValidators(i),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get status(){return Dt(this.statusReactive)}set status(i){Dt(()=>this.statusReactive.set(i))}_status=Qi(()=>this.statusReactive());statusReactive=zt(void 0);get valid(){return this.status===Zn}get invalid(){return this.status===fs}get pending(){return this.status==Vi}get disabled(){return this.status===Jn}get enabled(){return this.status!==Jn}errors;get pristine(){return Dt(this.pristineReactive)}set pristine(i){Dt(()=>this.pristineReactive.set(i))}_pristine=Qi(()=>this.pristineReactive());pristineReactive=zt(!0);get dirty(){return!this.pristine}get touched(){return Dt(this.touchedReactive)}set touched(i){Dt(()=>this.touchedReactive.set(i))}_touched=Qi(()=>this.touchedReactive());touchedReactive=zt(!1);get untouched(){return!this.touched}_events=new Ve;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._assignValidators(i)}setAsyncValidators(i){this._assignAsyncValidators(i)}addValidators(i){this.setValidators(Nd(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(Nd(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(Fd(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(Fd(i,this._rawAsyncValidators))}hasValidator(i){return ms(this._rawValidators,i)}hasAsyncValidator(i){return ms(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){let e=this.touched===!1;this.touched=!0;let t=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsTouched(Y(E({},i),{sourceControl:t})),e&&i.emitEvent!==!1&&this._events.next(new er(!0,t))}markAllAsTouched(i={}){this.markAsTouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(i))}markAsUntouched(i={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let t=i.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:t})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,t),e&&i.emitEvent!==!1&&this._events.next(new er(!1,t))}markAsDirty(i={}){let e=this.pristine===!0;this.pristine=!1;let t=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsDirty(Y(E({},i),{sourceControl:t})),e&&i.emitEvent!==!1&&this._events.next(new Xn(!1,t))}markAsPristine(i={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let t=i.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:i.emitEvent})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i,t),e&&i.emitEvent!==!1&&this._events.next(new Xn(!0,t))}markAsPending(i={}){this.status=Vi;let e=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new ji(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.markAsPending(Y(E({},i),{sourceControl:e}))}disable(i={}){let e=this._parentMarkedDirty(i.onlySelf);this.status=Jn,this.errors=null,this._forEachChild(r=>{r.disable(Y(E({},i),{onlySelf:!0}))}),this._updateValue();let t=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new _s(this.value,t)),this._events.next(new ji(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Y(E({},i),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(i={}){let e=this._parentMarkedDirty(i.onlySelf);this.status=Zn,this._forEachChild(t=>{t.enable(Y(E({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(Y(E({},i),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(i,e){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(i){this._parent=i}getRawValue(){return this.value}updateValueAndValidity(i={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let t=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Zn||this.status===Vi)&&this._runAsyncValidator(t,i.emitEvent)}let e=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new _s(this.value,e)),this._events.next(new ji(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(Y(E({},i),{sourceControl:e}))}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jn:Zn}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i,e){if(this.asyncValidator){this.status=Vi,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let t=qd(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:i})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let i=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,i}return!1}setErrors(i,e={}){this.errors=i,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(i){let e=i;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((t,r)=>t&&t._find(r),this)}getError(i,e){let t=e?this.get(e):this;return t&&t.errors?t.errors[i]:null}hasError(i,e){return!!this.getError(i,e)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i,e,t){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),(i||t)&&this._events.next(new ji(this.status,e)),this._parent&&this._parent._updateControlsErrors(i,e,t)}_initObservables(){this.valueChanges=new fe,this.statusChanges=new fe}_calculateStatus(){return this._allControlsDisabled()?Jn:this.errors?fs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Vi)?Vi:this._anyControlsHaveStatus(fs)?fs:Zn}_anyControlsHaveStatus(i){return this._anyControls(e=>e.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i,e){let t=!this._anyControlsDirty(),r=this.pristine!==t;this.pristine=t,this._parent&&!i.onlySelf&&this._parent._updatePristine(i,e),r&&this._events.next(new Xn(this.pristine,e))}_updateTouched(i={},e){this.touched=this._anyControlsTouched(),this._events.next(new er(this.touched,e)),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,e)}_onDisabledChange=[];_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){bs(i)&&i.updateOn!=null&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){let e=this._parent&&this._parent.dirty;return!i&&!!e&&!this._parent._anyControlsDirty()}_find(i){return null}_assignValidators(i){this._rawValidators=Array.isArray(i)?i.slice():i,this._composedValidatorFn=tp(this._rawValidators)}_assignAsyncValidators(i){this._rawAsyncValidators=Array.isArray(i)?i.slice():i,this._composedAsyncValidatorFn=ip(this._rawAsyncValidators)}},ys=class extends vs{constructor(i,e,t){super(Jd(e),Qd(t,e)),this.controls=i,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(i,e){return this.controls[i]?this.controls[i]:(this.controls[i]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(i,e,t={}){this.registerControl(i,e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}removeControl(i,e={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(i,e,t={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],e&&this.registerControl(i,e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,e={}){rp(this,!0,i),Object.keys(i).forEach(t=>{np(this,!0,t),this.controls[t].setValue(i[t],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(i,e={}){i!=null&&(Object.keys(i).forEach(t=>{let r=this.controls[t];r&&r.patchValue(i[t],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(i={},e={}){this._forEachChild((t,r)=>{t.reset(i?i[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(i,e,t)=>(i[t]=e.getRawValue(),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(e,t)=>t._syncPendingControls()?!0:e);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(e=>{let t=this.controls[e];t&&i(t,e)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(let[e,t]of Object.entries(this.controls))if(this.contains(e)&&i(t))return!0;return!1}_reduceValue(){let i={};return this._reduceChildren(i,(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(i,e){let t=i;return this._forEachChild((r,s)=>{t=e(t,r,s)}),t}_allControlsDisabled(){for(let i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(i){return this.controls.hasOwnProperty(i)?this.controls[i]:null}};var ka=new G("CallSetDisabledState",{providedIn:"root",factory:()=>Aa}),Aa="always";function sp(n,i){return[...i.path,n]}function Xd(n,i,e=Aa){eu(n,i),i.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&i.valueAccessor.setDisabledState?.(n.disabled),ap(n,i),cp(n,i),lp(n,i),op(n,i)}function Ld(n,i){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(i)})}function op(n,i){if(i.valueAccessor.setDisabledState){let e=t=>{i.valueAccessor.setDisabledState(t)};n.registerOnDisabledChange(e),i._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function eu(n,i){let e=Qm(n);i.validator!==null?n.setValidators(Pd(e,i.validator)):typeof e=="function"&&n.setValidators([e]);let t=Xm(n);i.asyncValidator!==null?n.setAsyncValidators(Pd(t,i.asyncValidator)):typeof t=="function"&&n.setAsyncValidators([t]);let r=()=>n.updateValueAndValidity();Ld(i._rawValidators,r),Ld(i._rawAsyncValidators,r)}function ap(n,i){i.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&tu(n,i)})}function lp(n,i){i.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&tu(n,i),n.updateOn!=="submit"&&n.markAsTouched()})}function tu(n,i){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function cp(n,i){let e=(t,r)=>{i.valueAccessor.writeValue(t),r&&i.viewToModelUpdate(t)};n.registerOnChange(e),i._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function dp(n,i){n==null,eu(n,i)}function up(n,i){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(i,e.currentValue)}function hp(n){return Object.getPrototypeOf(n.constructor)===ir}function fp(n,i){n._syncPendingControls(),i.forEach(e=>{let t=e.control;t.updateOn==="submit"&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function mp(n,i){if(!i)return null;Array.isArray(i);let e,t,r;return i.forEach(s=>{s.constructor===ue?e=s:hp(s)?t=s:r=s}),r||t||e||null}var pp={provide:Ui,useExisting:et(()=>Da)},Qn=Promise.resolve(),Da=(()=>{class n extends Ui{callSetDisabledState;get submitted(){return Dt(this.submittedReactive)}_submitted=Qi(()=>this.submittedReactive());submittedReactive=zt(!1);_directives=new Set;form;ngSubmit=new fe;options;constructor(e,t,r){super(),this.callSetDisabledState=r,this.form=new ys({},Ma(e),Ia(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Qn.then(()=>{let t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),Xd(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Qn.then(()=>{let t=this._findContainer(e.path);t&&t.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Qn.then(()=>{let t=this._findContainer(e.path),r=new ys({});dp(r,e),t.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Qn.then(()=>{let t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){Qn.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),fp(this.form,this._directives),this.ngSubmit.emit(e),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(t){return new(t||n)(I(Hd,10),I(zd,10),I(ka,8))};static \u0275dir=K({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){t&1&&S("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Te([pp]),Ke]})}return n})();function Vd(n,i){let e=n.indexOf(i);e>-1&&n.splice(e,1)}function jd(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var gp=class extends vs{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(i=null,e,t){super(Jd(e),Qd(t,e)),this._applyFormState(i),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),bs(e)&&(e.nonNullable||e.initialValueIsDefault)&&(jd(i)?this.defaultValue=i.value:this.defaultValue=i)}setValue(i,e={}){this.value=this._pendingValue=i,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(t=>t(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(i,e={}){this.setValue(i,e)}reset(i=this.defaultValue,e={}){this._applyFormState(i),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){Vd(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){Vd(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(i){jd(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}};var _p={provide:tr,useExisting:et(()=>he)},Ud=Promise.resolve(),he=(()=>{class n extends tr{_changeDetectorRef;callSetDisabledState;control=new gp;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new fe;constructor(e,t,r,s,o,l){super(),this._changeDetectorRef=o,this.callSetDisabledState=l,this._parent=e,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=mp(this,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let t=e.name.previousValue;this.formDirective.removeControl({name:t,path:this._getPath(t)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),up(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Xd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){Ud.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let t=e.isDisabled.currentValue,r=t!==0&&At(t);Ud.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?sp(e,this._parent):[e]}static \u0275fac=function(t){return new(t||n)(I(Ui,9),I(Hd,10),I(zd,10),I(Nt,10),I(fi,8),I(ka,8))};static \u0275dir=K({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Te([_p]),Ke,Mt]})}return n})(),iu=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275dir=K({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),vp={provide:Nt,useExisting:et(()=>rr),multi:!0},rr=(()=>{class n extends ir{writeValue(e){let t=e??"";this.setProperty("value",t)}registerOnChange(e){this.onChange=t=>{e(t==""?null:parseFloat(t))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275dir=K({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,r){t&1&&S("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Te([vp]),Ke]})}return n})();var yp={provide:Nt,useExisting:et(()=>dt),multi:!0};function nu(n,i){return n==null?`${i}`:(i&&typeof i=="object"&&(i="Object"),`${n}: ${i}`.slice(0,50))}function bp(n){return n.split(":")[0]}var dt=(()=>{class n extends ir{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let t=this._getOptionId(e),r=nu(t,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let t of this._optionMap.keys())if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){let t=bp(e);return this._optionMap.has(t)?this._optionMap.get(t):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275dir=K({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){t&1&&S("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Te([yp]),Ke]})}return n})(),Ft=(()=>{class n{_element;_renderer;_select;id;constructor(e,t,r){this._element=e,this._renderer=t,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(nu(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(t){return new(t||n)(I(Pe),I(Ye),I(dt,9))};static \u0275dir=K({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),xp={provide:Nt,useExisting:et(()=>ru),multi:!0};function $d(n,i){return n==null?`${i}`:(typeof i=="string"&&(i=`'${i}'`),i&&typeof i=="object"&&(i="Object"),`${n}: ${i}`.slice(0,50))}function Sp(n){return n.split(":")[0]}var ru=(()=>{class n extends ir{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let t;if(Array.isArray(e)){let r=e.map(s=>this._getOptionId(s));t=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else t=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{let r=[],s=t.selectedOptions;if(s!==void 0){let o=s;for(let l=0;l<o.length;l++){let a=o[l],c=this._getOptionValue(a.value);r.push(c)}}else{let o=t.options;for(let l=0;l<o.length;l++){let a=o[l];if(a.selected){let c=this._getOptionValue(a.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){let t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(let t of this._optionMap.keys())if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){let t=Sp(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275dir=K({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){t&1&&S("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Te([xp]),Ke]})}return n})(),Lt=(()=>{class n{_element;_renderer;_select;id;_value;constructor(e,t,r){this._element=e,this._renderer=t,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue($d(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue($d(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(t){return new(t||n)(I(Pe),I(Ye),I(ru,9))};static \u0275dir=K({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var wp=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({})}return n})();var ge=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:ka,useValue:e.callSetDisabledState??Aa}]}}static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({imports:[wp]})}return n})();var re=class{constructor(i){this.supabase=i}get client(){return this.supabase.client}getAll(){return f(this,null,function*(){let{data:i,error:e}=yield this.client.from(this.tableName).select("*").order("created_at",{ascending:!0});if(e)throw e;return i??[]})}getById(i){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).select("*").eq("id",i).single();if(t)throw t;return e})}create(i){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).insert([i]).select().single();if(t)throw t;return e})}update(i,e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).update(e).eq("id",i).select().single();if(r)throw r;return t})}delete(i){return f(this,null,function*(){let{error:e}=yield this.client.from(this.tableName).delete().eq("id",i);if(e)throw e})}bulkUpdate(i){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).upsert(i).select();if(console.log(t),t||!e)throw t;return e})}getPaginated(i,e,t){return f(this,null,function*(){let r=this.client.from(this.tableName).select("*");for(let l of t)r.filter(l.field,l.operator,l.value);let{data:s,error:o}=yield r.range((i-1)*e,i*e-1);if(o)throw o;return s??[]})}count(){return f(this,null,function*(){let{data:i,error:e}=yield this.client.from(this.tableName).select("id",{count:"exact"});if(e)throw e;return i?.length??0})}};var Bi=class n extends re{constructor(e){super(e);this.supabase=e}tableName="prayers";getAll(){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).select("*").order("prayer_type_id",{ascending:!0}).order("sequence",{ascending:!0});if(t)throw t;return e??[]})}getById(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).select("*, sections: prayers_sections(*, section: sections(*)), date_groups: prayer_date_group(*, date_group(*))").order("sequence",{foreignTable:"prayers_sections"}).eq("id",e).single();if(r)throw r;return t})}getParyerWithSectionsRecursively(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.functions.invoke("prayer-cache?rpc=get_prayer_with_sections_recursive",{method:"POST",body:{request_prayer_id:e}});if(r)throw r;return t})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var ut=class n extends re{constructor(e){super(e);this.supabase=e}tableName="prayer_type";getAll(){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).select("*");if(t)throw t;return e??[]})}getTree(){return f(this,null,function*(){let{data:e,error:t}=yield this.supabase.client.functions.invoke("prayer-cache?rpc=get_prayer_types",{method:"POST",body:{}});if(t)throw console.error("Error calling get_prayer_types:",t),t;return e})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Cp=n=>["/prayers",n];function Tp(n,i){if(n&1&&(d(0,"li")(1,"a",5),p(2),h()()),n&2){let e=i.$implicit;_(),b("routerLink",Ze(3,Cp,e.id)),_(),ve("",e.title," ",e.subtitle!=null&&e.subtitle.length?"- "+e.subtitle:"","")}}var Ss=class n{constructor(i,e){this.prayersService=i;this.prayerTypesService=e}prayerTypes=[];prayers=[];newPrayer=null;ngOnInit(){return f(this,null,function*(){this.newPrayer={title:"",subtitle:"",sequence:1},this.prayers=yield this.prayersService.getAll(),this.prayerTypes=yield this.prayerTypesService.getAll()})}addPrayer(){let i=this.newPrayer?.title.trim();i&&this.prayersService.create({title:i}).then(e=>{this.newPrayer={title:"",subtitle:"",sequence:1},this.prayers.splice(0,0,e)}).catch(e=>{alert("Error creating prayer: "+e)})}static \u0275fac=function(e){return new(e||n)(I(Bi),I(ut))};static \u0275cmp=X({type:n,selectors:[["app-prayers-list"]],decls:10,vars:2,consts:[[2,"margin-bottom","1rem"],["for","title"],["id","title","type","text","placeholder","Titlu rug\u0103ciune",3,"ngModelChange","ngModel"],[3,"click"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"h2"),p(2,"Rug\u0103ciuni"),h(),d(3,"label",1),p(4,"Adaug\u0103 o rug\u0103ciune nou\u0103: "),h(),d(5,"input",2),P("ngModelChange",function(s){return O(t.newPrayer.title,s)||(t.newPrayer.title=s),s}),h(),d(6,"button",3),S("click",function(){return t.addPrayer()}),p(7,"Adaug\u0103"),h()(),d(8,"ul"),D(9,Tp,3,5,"li",4),h()),e&2&&(_(5),R("ngModel",t.newPrayer.title),_(4),b("ngForOf",t.prayers))},dependencies:[ae,we,Be,ge,ue,pe,he],encapsulation:2})};var ws=class n extends re{constructor(e){super(e);this.supabase=e}tableName="prayers_sections";create(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).insert([e]).select("*, section: sections(*)").single();if(r)throw r;return t})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vt=class n extends re{constructor(e){super(e);this.supabase=e}tableName="sections";static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Cs=class n extends re{constructor(e){super(e);this.supabase=e}tableName="prayer_date_group";create(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).insert([e]).select("*, date_group(*, date_group_type(*))").single();if(r)throw r;return t})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ts=class n extends re{constructor(e){super(e);this.supabase=e}tableName="date_group";getAll(){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).select("*, date_group_type(*)").order("date_group_type_id",{ascending:!0});if(t)throw t;return e??[]})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var ou=n=>["/sections",n];function kp(n,i){if(n&1&&(d(0,"option",15),p(1),h()),n&2){let e=i.$implicit;b("value",e.id),_(),ne(e.type)}}function Ap(n,i){if(n&1){let e=$();d(0,"div")(1,"div")(2,"h2")(3,"button",5),S("click",function(){C(e);let r=y();return T(r.goBack())}),d(4,"i",12),p(5,"arrow_back"),h()(),p(6),d(7,"button",5),S("click",function(){C(e);let r=y();return T(r.deletePrayer())}),d(8,"i",12),p(9,"delete"),h()()(),d(10,"h3"),p(11,"Detalii rug\u0103ciune"),h(),d(12,"table",13)(13,"tr")(14,"td"),p(15,"Titlu:"),h(),d(16,"td")(17,"input",2),P("ngModelChange",function(r){C(e);let s=y();return O(s.prayer.title,r)||(s.prayer.title=r),T(r)}),h()()(),d(18,"tr")(19,"td"),p(20,"Subtitlu:"),h(),d(21,"td")(22,"input",2),P("ngModelChange",function(r){C(e);let s=y();return O(s.prayer.subtitle,r)||(s.prayer.subtitle=r),T(r)}),h()()(),d(23,"tr")(24,"td"),p(25,"Ordine:"),h(),d(26,"td")(27,"input",14),P("ngModelChange",function(r){C(e);let s=y();return O(s.prayer.sequence,r)||(s.prayer.sequence=r),T(r)}),h()()(),d(28,"tr")(29,"td"),p(30,"Tip:"),h(),d(31,"td")(32,"select",2),P("ngModelChange",function(r){C(e);let s=y();return O(s.prayer.prayer_type_id,r)||(s.prayer.prayer_type_id=r),T(r)}),D(33,kp,2,2,"option",4),h()()()(),d(34,"button",5),S("click",function(){C(e);let r=y();return T(r.updatePrayer())}),p(35,"Salveaz\u0103"),h()()()}if(n&2){let e=y();_(6),ce("",e.prayer.title," "),_(11),R("ngModel",e.prayer.title),_(5),R("ngModel",e.prayer.subtitle),_(5),R("ngModel",e.prayer.sequence),_(5),R("ngModel",e.prayer.prayer_type_id),_(),b("ngForOf",e.prayerTypes)}}function Dp(n,i){n&1&&(d(0,"p"),p(1,"Nu sunt sec\u021Biuni ad\u0103ugate"),h())}function Rp(n,i){if(n&1){let e=$();d(0,"li")(1,"p")(2,"a",16),p(3),h(),d(4,"button",5),S("click",function(){let r=C(e).$implicit,s=y().$implicit,o=y();return T(o.deleteSection(r.id,s.id))}),d(5,"i",17),p(6,"delete"),h()()()()}if(n&2){let e=i.$implicit;_(2),b("routerLink",Ze(3,ou,e.section==null?null:e.section.id)),_(),ve("",e.section==null?null:e.section.title," - ",e.section==null?null:e.section.subtitle,"")}}function Op(n,i){if(n&1&&(d(0,"option",15),p(1),h()),n&2){let e=i.$implicit;b("value",e.id),_(),ne(e.title)}}function Pp(n,i){if(n&1){let e=$();d(0,"li")(1,"label",20),p(2,"Sec\u021Biune existent\u0103:"),h(),d(3,"select",2),P("ngModelChange",function(r){C(e);let s=y(2);return O(s.newPrayerSection.section_id,r)||(s.newPrayerSection.section_id=r),T(r)}),d(4,"option",21),p(5,"-- Alege\u021Bi --"),h(),D(6,Op,2,2,"option",4),h(),d(7,"button",5),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.addPrayerSection(r.id))}),d(8,"i",17),p(9,"save"),h()(),d(10,"button",5),S("click",function(){C(e);let r=y(2);return T(r.hideNewSubsectionForm())}),d(11,"i",17),p(12,"delete"),h()()()}if(n&2){let e=y(2);_(3),R("ngModel",e.newPrayerSection.section_id),_(3),b("ngForOf",e.sections)}}function Np(n,i){if(n&1){let e=$();d(0,"li")(1,"label",20),p(2,"Titlu sec\u021Biune nou\u0103:"),h(),d(3,"input",6),P("ngModelChange",function(r){C(e);let s=y(2);return O(s.newSectionTitle,r)||(s.newSectionTitle=r),T(r)}),h(),d(4,"button",5),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.addNewPrayerSection(r.id))}),d(5,"i",17),p(6,"save"),h()(),d(7,"button",5),S("click",function(){C(e);let r=y(2);return T(r.hideNewSubsectionForm())}),d(8,"i",17),p(9,"delete"),h()()()}if(n&2){let e=y(2);_(3),R("ngModel",e.newSectionTitle)}}function Fp(n,i){if(n&1){let e=$();d(0,"li")(1,"p")(2,"a",16),p(3),h(),d(4,"span"),p(5),h(),d(6,"button",5),S("click",function(){let r=C(e).$implicit,s=y();return T(s.deleteSection(r.id))}),d(7,"i",17),p(8,"delete"),h()(),d(9,"button",18),S("click",function(){let r=C(e).index,s=y();return T(s.moveSectionUp(r))}),p(10,"\u2191"),h(),d(11,"button",19),S("click",function(){let r=C(e).index,s=y();return T(s.moveSectionDown(r))}),p(12,"\u2193"),h(),d(13,"button",5),S("click",function(){let r=C(e).$implicit,s=y();return T(s.displayNewSubsectionForm(r.id))}),d(14,"i",17),p(15,"add"),h()()(),d(16,"ul"),D(17,Rp,7,5,"li",1)(18,Pp,13,2,"li",0)(19,Np,10,1,"li",0),h()()}if(n&2){let e=i.$implicit,t=i.index,r=y();_(2),b("routerLink",Ze(9,ou,e.section==null?null:e.section.id)),_(),ve("",e.section==null?null:e.section.title," ",!(e.section==null||e.section.subtitle==null)&&e.section.subtitle.length?"- "+(e.section==null?null:e.section.subtitle):"",""),_(2),ne(" "),_(4),b("disabled",t===0),_(2),b("disabled",t===(r.prayer==null||r.prayer.sections==null?null:r.prayer.sections.length)),_(6),b("ngForOf",e.subsections),_(),b("ngIf",(r.newPrayerSection==null?null:r.newPrayerSection.parent_id)===e.id),_(),b("ngIf",(r.newPrayerSection==null?null:r.newPrayerSection.parent_id)===e.id)}}function Lp(n,i){if(n&1&&(d(0,"option",15),p(1),h()),n&2){let e=i.$implicit;b("value",e.id),_(),ve("",e.title," ",e.subtitle!=null&&e.subtitle.length?"- "+e.subtitle:"","")}}function Vp(n,i){n&1&&(d(0,"p"),p(1,"Nu sunt grupe de dat\u0103 ad\u0103ugate"),h())}function jp(n,i){if(n&1){let e=$();d(0,"li")(1,"p"),p(2),d(3,"button",5),S("click",function(){let r=C(e).$implicit,s=y();return T(s.deletePrayerDateGroup(r.id))}),d(4,"i",17),p(5,"delete"),h()()()()}if(n&2){let e=i.$implicit;_(2),ve(" ",e.date_group==null||e.date_group.date_group_type==null?null:e.date_group.date_group_type.name," - ",e.date_group==null?null:e.date_group.title," ")}}function Up(n,i){if(n&1&&(d(0,"option",15),p(1),h()),n&2){let e=i.$implicit;b("value",e.id),_(),ve("",e.date_group_type==null?null:e.date_group_type.name," - ",e.title,"")}}var Es=class n{constructor(i,e,t,r,s,o,l){this.route=i;this.prayersService=e;this.prayerTypesService=t;this.prayerSectionService=r;this.sectionsService=s;this.prayerDateGroupService=o;this.dateGroupService=l}dateGroups=[];prayerTypes=[];sections=[];prayer=null;id;newPrayerSection=null;newSectionTitle="";newSectionSubtitle="";newPrayerDateGroup=null;ngOnInit(){return f(this,null,function*(){this.id=this.route.snapshot.paramMap.get("id")||"",this.prayer=yield this.prayersService.getParyerWithSectionsRecursively(this.id),this.newPrayerSection={prayer_id:this.id,section_id:"",sequence:1},this.newPrayerDateGroup={prayer_id:this.id,date_group_id:0,sequence:1},yield this.getPrayerTypes(),yield this.getSections(),yield this.getDateGroups()})}getDateGroups(){return f(this,null,function*(){this.dateGroups=yield this.dateGroupService.getAll()})}getPrayerTypes(){return f(this,null,function*(){this.prayerTypes=yield this.prayerTypesService.getAll()})}getSections(){return f(this,null,function*(){this.sections=yield this.sectionsService.getAll()})}updatePrayer(){return f(this,null,function*(){if(!this.prayer)return;(yield this.prayersService.update(this.prayer.id,{title:this.prayer.title,subtitle:this.prayer.subtitle,sequence:this.prayer.sequence,prayer_type_id:this.prayer.prayer_type_id}))&&alert("Prayer updated successfully!")})}deletePrayer(){return f(this,null,function*(){if(this.prayer&&confirm("E\u0219ti sigur c\u0103 vrei s\u0103 \u0219tergi aceast\u0103 rug\u0103ciune?"))try{yield this.prayersService.delete(this.prayer.id),location.href="/prayers"}catch(i){alert("Eroare la \u0219tergerea rug\u0103ciunii: "+i)}})}deleteSection(i,e=null){return f(this,null,function*(){if(this.prayer&&confirm("E\u0219ti sigur c\u0103 vrei s\u0103 \u0219tergi aceast\u0103 sec\u021Biune?"))try{if(yield this.prayerSectionService.delete(i),e){let t=this.prayer.sections.find(r=>r.id===e);t&&(t.subsections=t.subsections?.filter(r=>r.id!==i)??[])}else this.prayer.sections=this.prayer.sections?.filter(t=>t.id!==i)??[]}catch(t){alert("Eroare la \u0219tergerea sec\u021Biunii: "+t)}})}displayNewSubsectionForm(i){this.newPrayerSection.parent_id=i}hideNewSubsectionForm(){this.newPrayerSection.parent_id=null,this.newPrayerSection.section_id=""}addPrayerSection(i=null){this.prayer&&(this.newPrayerSection=Y(E({},this.newPrayerSection),{parent_id:i,sequence:1}),this.prayerSectionService.create(this.newPrayerSection).then(e=>{if(this.newPrayerSection={prayer_id:this.id,section_id:"",sequence:1},i){let t=this.prayer.sections.find(r=>r.id===i);t&&t.subsections.push(e)}else this.prayer.sections.push(e)}).catch(e=>{alert("Error creating subsection: "+e)}))}addNewPrayerSection(i=null){if(!this.newSectionTitle)return;let e=this.prayer?.sections?.length?Math.max(...this.prayer.sections.map(t=>t.sequence))+1:1;this.sectionsService.create({title:this.newSectionTitle,subtitle:this.newSectionSubtitle,audio_url:""}).then(t=>{this.newPrayerSection={prayer_id:this.id,section_id:t.id,sequence:e},this.addPrayerSection(i),this.newSectionTitle=""}).catch(t=>{alert("Error creating section: "+t)})}goBack(){window.history.back()}goToSection(i){location.href=`/sections/${i}`}deletePrayerDateGroup(i){if(this.prayer&&confirm("E\u0219ti sigur c\u0103 vrei s\u0103 \u0219tergi aceast\u0103 grup\u0103 de dat\u0103?"))try{this.prayerDateGroupService.delete(i),this.prayer.date_groups=this.prayer.date_groups?.filter(e=>e.id!==i)??[]}catch(e){alert("Eroare la \u0219tergerea datei: "+e)}}addPrayerDateGroup(){this.prayer&&this.prayerDateGroupService.create(this.newPrayerDateGroup).then(i=>{this.newPrayerDateGroup={prayer_id:this.id,date_group_id:0,sequence:1},this.prayer.date_groups.push(i)}).catch(i=>{alert("Error creating date group: "+i)})}moveSectionUp(i){this.prayer&&i!==0&&this.swapSections(i,i-1)}moveSectionDown(i){this.prayer&&i!==this.prayer.sections.length-1&&this.swapSections(i,i+1)}swapSections(i,e){if(!this.prayer)return;let t=this.prayer.sections[i],r=this.prayer.sections[e],s=t.sequence;t.sequence=r.sequence,r.sequence=s,this.prayerSectionService.update(t.id,{sequence:t.sequence}),this.prayerSectionService.update(r.id,{sequence:r.sequence}),this.prayer.sections[i]=r,this.prayer.sections[e]=t}static \u0275fac=function(e){return new(e||n)(I(ke),I(Bi),I(ut),I(ws),I(Vt),I(Cs),I(Ts))};static \u0275cmp=X({type:n,selectors:[["app-prayer-detail"]],decls:44,vars:11,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],["placeholder","Titlu",3,"ngModelChange","ngModel"],["placeholder","Subtitlu",3,"ngModelChange","ngModel"],[3,"click","submit"],["for","date_group"],["id","date_group",3,"ngModelChange","ngModel"],["value","0"],[1,"material-icons",2,"font-size","16px"],[2,"border-collapse","collapse","background","transparent"],["type","number",3,"ngModelChange","ngModel"],[3,"value"],[3,"routerLink"],[1,"material-icons",2,"font-size","12px"],["title","Mut\u0103 \xEEn sus",3,"click","disabled"],["title","Mut\u0103 \xEEn jos",3,"click","disabled"],["for","section"],["selected",""]],template:function(e,t){e&1&&(D(0,Ap,36,6,"div",0),ee(1,"hr"),d(2,"div")(3,"div")(4,"h3"),p(5,"Sec\u021Biuni"),h(),D(6,Dp,2,0,"p",0),d(7,"ul"),D(8,Fp,20,11,"li",1),h()(),ee(9,"hr"),d(10,"div")(11,"h4"),p(12,"Adaug\u0103 o sec\u021Biune existent\u0103"),h(),d(13,"select",2),P("ngModelChange",function(s){return O(t.newPrayerSection.section_id,s)||(t.newPrayerSection.section_id=s),s}),d(14,"option",3),p(15,"-- Alege\u021Bi --"),h(),D(16,Lp,2,3,"option",4),h(),d(17,"button",5),S("click",function(){return t.addPrayerSection()}),p(18,"Adaug\u0103"),h(),d(19,"h4"),p(20,"Creeaza \u0219i adaug\u0103 o sec\u021Biune nou\u0103"),h(),d(21,"input",6),P("ngModelChange",function(s){return O(t.newSectionTitle,s)||(t.newSectionTitle=s),s}),h(),d(22,"input",7),P("ngModelChange",function(s){return O(t.newSectionSubtitle,s)||(t.newSectionSubtitle=s),s}),h(),d(23,"button",8),S("click",function(){return t.addNewPrayerSection()})("submit",function(){return t.addNewPrayerSection()}),p(24,"Adaug\u0103"),h()()(),ee(25,"hr"),d(26,"div")(27,"div")(28,"h3"),p(29,"Grupe de dat\u0103"),h(),D(30,Vp,2,0,"p",0),d(31,"ul"),D(32,jp,6,2,"li",1),h(),d(33,"h4"),p(34,"Adaug\u0103 o nou\u0103 grup\u0103 de dat\u0103"),h(),d(35,"label",9),p(36,"Grup\u0103 de dat\u0103: "),h(),d(37,"select",10),P("ngModelChange",function(s){return O(t.newPrayerDateGroup.date_group_id,s)||(t.newPrayerDateGroup.date_group_id=s),s}),d(38,"option",11),p(39,"-- Alege\u021Bi --"),h(),D(40,Up,2,3,"option",4),h(),ee(41,"br"),d(42,"button",5),S("click",function(){return t.addPrayerDateGroup()}),p(43,"Adaug\u0103"),h()()()),e&2&&(b("ngIf",t.prayer),_(6),b("ngIf",!(!(t.prayer==null||t.prayer.sections==null)&&t.prayer.sections.length)),_(2),b("ngForOf",t.prayer==null?null:t.prayer.sections),_(5),R("ngModel",t.newPrayerSection.section_id),_(3),b("ngForOf",t.sections),_(5),R("ngModel",t.newSectionTitle),_(),R("ngModel",t.newSectionSubtitle),_(8),b("ngIf",!(!(t.prayer==null||t.prayer.date_groups==null)&&t.prayer.date_groups.length)),_(2),b("ngForOf",t.prayer==null?null:t.prayer.date_groups),_(5),R("ngModel",t.newPrayerDateGroup.date_group_id),_(3),b("ngForOf",t.dateGroups))},dependencies:[ae,we,Ue,ge,Ft,Lt,ue,rr,dt,pe,he,Dc,Be],styles:["h2[_ngcontent-%COMP%]{margin-bottom:1rem}"]})};function $p(n,i){if(n&1){let e=$();it(0),d(1,"p"),p(2),d(3,"button",3),S("click",function(){C(e);let r=y();return T(r.enableEdit())}),d(4,"i",4),p(5,"edit"),h()(),d(6,"button",3),S("click",function(){C(e);let r=y();return T(r.addSubtype())}),d(7,"i",4),p(8,"add"),h()(),d(9,"button",3),S("click",function(){C(e);let r=y();return T(r.deleteType())}),d(10,"i",4),p(11,"delete"),h()()(),nt()}if(n&2){let e=y();_(2),ce(" ",e.node.type," ")}}function Bp(n,i){if(n&1){let e=$();d(0,"input",5),P("ngModelChange",function(r){C(e);let s=y();return O(s.tempName,r)||(s.tempName=r),T(r)}),h(),d(1,"button",3),S("click",function(){C(e);let r=y();return T(r.saveEdit())}),d(2,"i",4),p(3,"save"),h()(),d(4,"button",3),S("click",function(){C(e);let r=y();return T(r.cancelEdit())}),d(5,"i",4),p(6,"cancel"),h()()}if(n&2){let e=y();R("ngModel",e.tempName)}}function Hp(n,i){if(n&1){let e=$();d(0,"li")(1,"app-prayer-type-subitem",7),S("refreshNeeded",function(){C(e);let r=y(2);return T(r.onChildRefreshNeeded())}),h()()}if(n&2){let e=i.$implicit;_(),b("node",e)}}function zp(n,i){if(n&1&&(d(0,"ul"),D(1,Hp,2,1,"li",6),h()),n&2){let e=y();_(),b("ngForOf",e.node.subtypes)}}var Ms=class n{constructor(i){this.prayerTypeService=i}node;refreshNeeded=new fe;isEditing=!1;tempName="";enableEdit(){this.isEditing=!0,this.tempName=this.node.type}cancelEdit(){this.isEditing=!1,this.tempName=""}saveEdit(){return f(this,null,function*(){let i=this.tempName.trim();if(!i){alert("Name cannot be empty");return}try{yield this.prayerTypeService.update(this.node.id,{type:i}),this.node.type=i,this.isEditing=!1,this.refreshNeeded.emit()}catch(e){console.error("Error updating prayer type:",e)}})}addSubtype(){return f(this,null,function*(){let i=prompt("Enter subtype name:");if(i)try{yield this.prayerTypeService.create({type:i,parent_type_id:this.node.id,sequence:1}),this.refreshNeeded.emit()}catch(e){console.error("Error creating subtype:",e)}})}deleteType(){return f(this,null,function*(){if(confirm(`Are you sure you want to delete "${this.node.type}"?`))try{yield this.prayerTypeService.delete(this.node.id),this.refreshNeeded.emit()}catch(i){console.error("Error deleting prayer type:",i)}})}onChildRefreshNeeded(){this.refreshNeeded.emit()}static \u0275fac=function(e){return new(e||n)(I(ut))};static \u0275cmp=X({type:n,selectors:[["app-prayer-type-subitem"]],inputs:{node:"node"},outputs:{refreshNeeded:"refreshNeeded"},decls:4,vars:3,consts:[["editMode",""],[4,"ngIf","ngIfElse"],[4,"ngIf"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[3,"refreshNeeded","node"]],template:function(e,t){if(e&1&&D(0,$p,12,1,"ng-container",1)(1,Bp,7,1,"ng-template",null,0,so)(3,zp,2,1,"ul",2),e&2){let r=ro(2);b("ngIf",!t.isEditing)("ngIfElse",r),_(3),b("ngIf",t.node.subtypes==null?null:t.node.subtypes.length)}},dependencies:[n,ae,we,Ue,ge,ue,pe,he],encapsulation:2})};function Gp(n,i){if(n&1){let e=$();d(0,"li")(1,"app-prayer-type-subitem",4),S("refreshNeeded",function(){C(e);let r=y();return T(r.onRefreshNeeded())}),h()()}if(n&2){let e=i.$implicit;_(),b("node",e)}}var Is=class n{constructor(i){this.prayerTypeService=i}prayerTypes=[];newRootTypeName="";ngOnInit(){return f(this,null,function*(){yield this.loadData()})}loadData(){return f(this,null,function*(){try{this.prayerTypes=yield this.prayerTypeService.getTree()}catch(i){console.error("Error loading prayer types:",i)}})}addRootType(){return f(this,null,function*(){let i=this.newRootTypeName.trim();if(i)try{yield this.prayerTypeService.create({type:i,parent_type_id:null,sequence:1}),this.newRootTypeName="",yield this.loadData()}catch(e){console.error("Error creating root type:",e)}})}onRefreshNeeded(){return f(this,null,function*(){yield this.loadData()})}static \u0275fac=function(e){return new(e||n)(I(ut))};static \u0275cmp=X({type:n,selectors:[["app-prayer-types-list"]],decls:10,vars:2,consts:[[2,"margin-bottom","1rem"],["type","text","placeholder","Nou tip de rug\u0103ciune",3,"ngModelChange","ngModel"],[3,"click"],[4,"ngFor","ngForOf"],[3,"refreshNeeded","node"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"h2"),p(2,"Tipuri de rug\u0103ciuni"),h(),d(3,"label"),p(4,"Adaug\u0103 un tip nou de rug\u0103ciune: "),h(),d(5,"input",1),P("ngModelChange",function(s){return O(t.newRootTypeName,s)||(t.newRootTypeName=s),s}),h(),d(6,"button",2),S("click",function(){return t.addRootType()}),p(7,"Adaug\u0103"),h()(),d(8,"ul"),D(9,Gp,2,1,"li",3),h()),e&2&&(_(5),R("ngModel",t.newRootTypeName),_(4),b("ngForOf",t.prayerTypes))},dependencies:[ae,we,ge,ue,pe,he,Ms],encapsulation:2})};var ht=class n{constructor(i,e){this.auth=i;this.router=e}canActivate(){return this.auth.isLoggedIn()?!0:(this.router.navigate(["/login"]),!1)}static \u0275fac=function(e){return new(e||n)(N(ct),N(be))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function qp(n,i){if(n&1&&(d(0,"div",8),p(1),h()),n&2){let e=y();_(),ce(" ",e.errorMsg," ")}}var ks=class n{constructor(i,e){this.authService=i;this.router=e}email="";password="";errorMsg="";ngOnInit(){this.authService.isLoggedIn()&&this.router.navigate(["/prayer-types"])}onLogin(){return f(this,null,function*(){this.errorMsg="";try{yield this.authService.signIn(this.email,this.password),this.router.navigate(["/prayers"])}catch(i){this.errorMsg=i.message||"Login failed",console.error("Login error:",i)}})}static \u0275fac=function(e){return new(e||n)(I(ct),I(be))};static \u0275cmp=X({type:n,selectors:[["app-login"]],decls:17,vars:3,consts:[[1,"container"],[1,"login-container"],["style","color:red;",4,"ngIf"],[1,"form-container",3,"ngSubmit"],[1,"input-container"],["name","email","type","email",3,"ngModelChange","ngModel"],["name","password","type","password",3,"ngModelChange","ngModel"],["type","submit"],[2,"color","red"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"div",1)(2,"h2"),p(3,"Admin Login"),h(),D(4,qp,2,1,"div",2),d(5,"form",3),S("ngSubmit",function(){return t.onLogin()}),d(6,"div",4)(7,"label"),p(8,"Email:"),h(),d(9,"input",5),P("ngModelChange",function(s){return O(t.email,s)||(t.email=s),s}),h()(),d(10,"div",4),p(11,"` "),d(12,"label"),p(13,"Password:"),h(),d(14,"input",6),P("ngModelChange",function(s){return O(t.password,s)||(t.password=s),s}),h()(),d(15,"button",7),p(16,"Login"),h()()()()),e&2&&(_(4),b("ngIf",t.errorMsg),_(5),R("ngModel",t.email),_(5),R("ngModel",t.password))},dependencies:[ae,Ue,ge,iu,ue,pe,Zd,he,Da],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;width:100vw;height:100vh}.container[_ngcontent-%COMP%]   .login-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:start;border:1px solid black;padding:1rem;height:min-content;border-radius:5px;gap:.5rem}.container[_ngcontent-%COMP%]   .login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   .login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem;border-radius:5px;border:1px solid black}.container[_ngcontent-%COMP%]   .login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem;border-radius:5px;border:1px solid black;cursor:pointer;margin-top:1rem}"]})};var sr=(r=>(r.PLAIN="plainText",r.QUOTE="quoteText",r.ITALIC="italicText",r.BOLD="boldText",r))(sr||{});var jt=class n extends re{constructor(e){super(e);this.supabase=e}tableName="liturgical_texts";getById(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).select("*, texts: text_elements(*)").order("sequence",{foreignTable:"text_elements"}).eq("id",e).single();if(r)throw r;return t})}getAll(){return f(this,null,function*(){let{data:e,error:t}=yield this.client.from(this.tableName).select("*").order("title",{ascending:!0});if(t)throw t;return e??[]})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Hi=class n extends re{constructor(e){super(e);this.supabase=e}tableName="text_elements";updateSequence(e,t){return f(this,null,function*(){return this.update(e,{sequence:t})})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function Wp(n,i){if(n&1){let e=$();d(0,"div")(1,"h2")(2,"button",10),S("click",function(){C(e);let r=y();return T(r.goBack())}),d(3,"i",11),p(4,"arrow_back"),h()(),p(5),d(6,"button",10),S("click",function(){C(e);let r=y();return T(r.deleteText())}),d(7,"i",12),p(8,"delete"),h()()(),d(9,"p"),p(10," Schimb\u0103 titlul: "),d(11,"input",13),P("ngModelChange",function(r){C(e);let s=y();return O(s.text.title,r)||(s.text.title=r),T(r)}),h(),ee(12,"br"),d(13,"button",10),S("click",function(){C(e);let r=y();return T(r.saveTitle())}),p(14,"Salveaz\u0103"),h()()()}if(n&2){let e=y();_(5),ce(" ",e.textTitle," "),_(6),R("ngModel",e.text.title)}}function Yp(n,i){n&1&&(d(0,"p"),p(1,"Nu sunt texte ad\u0103ugate"),h())}function Kp(n,i){if(n&1&&(d(0,"option",16),p(1),h()),n&2){let e=i.$implicit;b("value",e),_(),ne(e)}}function Zp(n,i){if(n&1){let e=$();d(0,"span")(1,"label",17),p(2,"Sursa citat"),h(),d(3,"input",18),P("ngModelChange",function(r){C(e);let s=y(3);return O(s.editedTextElement.quote_source,r)||(s.editedTextElement.quote_source=r),T(r)}),h()()}if(n&2){let e=y(3);_(3),R("ngModel",e.editedTextElement.quote_source)}}function Jp(n,i){if(n&1){let e=$();d(0,"p")(1,"textarea",14),P("ngModelChange",function(r){C(e);let s=y(2);return O(s.editedTextElement.text,r)||(s.editedTextElement.text=r),T(r)}),h(),d(2,"label",5),p(3,"Eviden\u021Biere prima liter\u0103: "),h(),d(4,"input",6),P("ngModelChange",function(r){C(e);let s=y(2);return O(s.editedTextElement.highlight,r)||(s.editedTextElement.highlight=r),T(r)}),h(),d(5,"label",7),p(6,"Tip text: "),h(),d(7,"select",8),P("ngModelChange",function(r){C(e);let s=y(2);return O(s.editedTextElement.type,r)||(s.editedTextElement.type=r),T(r)}),D(8,Kp,2,2,"option",9),h(),D(9,Zp,4,1,"span",0),d(10,"button",10),S("click",function(){C(e);let r=y().index,s=y();return T(s.editTextElement(r))}),d(11,"i",15),p(12,"save"),h()(),d(13,"button",10),S("click",function(){C(e);let r=y(2);return T(r.clearEditedTextElement())}),d(14,"i",15),p(15,"cancel"),h()()()}if(n&2){let e=y(2);_(),R("ngModel",e.editedTextElement.text),_(3),R("ngModel",e.editedTextElement.highlight),_(3),R("ngModel",e.editedTextElement.type),_(),b("ngForOf",e.textTypes),_(),b("ngIf",e.editedTextElement.type=="quoteText")}}function Qp(n,i){n&1&&(d(0,"span"),p(1,"<<"),h())}function Xp(n,i){if(n&1&&(d(0,"span")(1,"b",23),p(2),h(),p(3),h()),n&2){let e=y(2).$implicit;no(e.type),_(2),ne(e.text[0]),_(),ne(e.text.slice(1))}}function eg(n,i){if(n&1&&(d(0,"span"),p(1),h()),n&2){let e=y(2).$implicit;no(e.type),_(),ne(e.text)}}function tg(n,i){if(n&1&&(d(0,"span"),p(1),h()),n&2){let e=y(2).$implicit;_(),ce(">> ",e.quote_source,"")}}function ig(n,i){if(n&1){let e=$();d(0,"p"),D(1,Qp,2,0,"span",0)(2,Xp,4,5,"span",19)(3,eg,2,4,"span",19)(4,tg,2,1,"span",0),d(5,"span",20)(6,"button",21),S("click",function(){C(e);let r=y().index,s=y();return T(s.moveUp(r))}),p(7,"\u2191"),h(),d(8,"button",22),S("click",function(){C(e);let r=y().index,s=y();return T(s.moveDown(r))}),p(9,"\u2193"),h(),d(10,"button",10),S("click",function(){C(e);let r=y(),s=r.$implicit,o=r.index,l=y();return T(l.deleteTextElement(s.id,o))}),d(11,"i",15),p(12,"delete"),h()(),d(13,"button",10),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.setEditedTextElement(r))}),d(14,"i",15),p(15,"edit"),h()()()()}if(n&2){let e=y(),t=e.$implicit,r=e.index,s=y();_(),b("ngIf",t.type=="quoteText"),_(),b("ngIf",t.highlight),_(),b("ngIf",!t.highlight),_(),b("ngIf",t.type=="quoteText"),_(2),b("disabled",r===0),_(2),b("disabled",r===(s.text==null?null:s.text.texts.length)-1)}}function ng(n,i){if(n&1&&(d(0,"li"),D(1,Jp,16,5,"p",0)(2,ig,16,6,"p",0),h()),n&2){let e=i.$implicit,t=y();_(),b("ngIf",(t.editedTextElement==null?null:t.editedTextElement.id)&&e.id==(t.editedTextElement==null?null:t.editedTextElement.id)),_(),b("ngIf",!(t.editedTextElement!=null&&t.editedTextElement.id)||e.id!=(t.editedTextElement==null?null:t.editedTextElement.id))}}function rg(n,i){if(n&1&&(d(0,"option",16),p(1),h()),n&2){let e=i.$implicit;b("value",e),_(),ne(e)}}var As=class n{constructor(i,e,t){this.route=i;this.litTextService=e;this.textElementsService=t}textId;text=null;editedTitle="";newTextElement=null;editedTextElement=null;sectionStartTime=0;textTypes=Object.values(sr);textTitle="";ngOnInit(){return f(this,null,function*(){this.textId=this.route.snapshot.paramMap.get("id")||"",this.sectionStartTime=parseInt(this.route.snapshot.paramMap.get("sectionStartTime")||"0"),this.newTextElement={text_id:this.textId,type:"plainText"},this.editedTextElement={},yield this.loadLiturgicalText()})}loadLiturgicalText(){return f(this,null,function*(){this.text=yield this.litTextService.getById(this.textId),this.textTitle=this.text?.title??""})}loadTextElements(){return f(this,null,function*(){if(!this.text)return;let{data:i,error:e}=yield this.textElementsService.client.from("text_elements").select("*").eq("text_id",this.text.id).order("sequence");!e&&i&&(this.text.texts=i)})}saveTitle(){return f(this,null,function*(){if(this.text)try{(yield this.litTextService.update(this.text.id,{title:this.text.title??null}))&&(alert("Textul a fost salvat!"),this.textTitle=this.text.title??"")}catch(i){console.error("Error updating title:",i)}})}addTextElement(){return f(this,null,function*(){if(!this.textId)return;let i=this.newTextElement?.text.trim();if(i)try{let e=0;this.text?.texts&&this.text.texts.length>0&&(e=Math.max(...this.text.texts.map(t=>t.sequence))),yield this.textElementsService.create({text:i,sequence:e+1,text_id:this.textId,type:this.newTextElement?.type??"plainText",highlight:this.newTextElement?.highlight??!1}),this.newTextElement={text_id:this.textId,type:"plainText"},yield this.loadTextElements()}catch(e){console.error("Error adding text element:",e)}})}goBack(){history.back()}deleteText(){return f(this,null,function*(){if(this.text&&confirm("E\u0219ti sigur c\u0103 vrei s\u0103 \u0219tergi acest text? Nu \xEEl po\u021Bi recupera ulterior!"))try{yield this.litTextService.delete(this.text.id),location.href="/liturgicalTexts"}catch(i){console.error("Error deleting text:",i)}})}deleteTextElement(i,e){return f(this,null,function*(){if(confirm("E\u0219ti sigur c\u0103 vrei s\u0103 \u0219tergi acest text? Nu \xEEl po\u021Bi recupera ulterior!"))try{yield this.textElementsService.delete(i),this.text?.texts?.splice(e,1)}catch(t){console.error("Error deleting text element:",t)}})}setEditedTextElement(i){this.editedTextElement=E({},i)}clearEditedTextElement(){this.editedTextElement={}}editTextElement(i){return f(this,null,function*(){if(!(!this.editedTextElement?.id||!this.editedTextElement.text))try{yield this.textElementsService.update(this.editedTextElement.id,E({},this.editedTextElement)),this.text?.texts?.splice(i,1,E({},this.editedTextElement)),this.editedTextElement={}}catch(e){alert("A intervenit o eroare: "+e.message)}})}moveUp(i){return f(this,null,function*(){if(!this.text?.texts||i===0)return;let e=this.text.texts[i],t=this.text.texts[i-1];try{let r=e.sequence;e.sequence=t.sequence,t.sequence=r,yield this.textElementsService.update(e.id,{sequence:e.sequence}),yield this.textElementsService.update(t.id,{sequence:t.sequence}),this.text.texts[i]=t,this.text.texts[i-1]=e}catch(r){console.error("Error moving element up:",r)}})}moveDown(i){return f(this,null,function*(){if(!this.text?.texts||i===this.text.texts.length-1)return;let e=this.text.texts[i],t=this.text.texts[i+1];try{let r=e.sequence;e.sequence=t.sequence,t.sequence=r,yield this.textElementsService.update(e.id,{sequence:e.sequence}),yield this.textElementsService.update(t.id,{sequence:t.sequence}),this.text.texts[i]=t,this.text.texts[i+1]=e}catch(r){console.error("Error moving element down:",r)}})}secondsToTimeFormat(i){let e=Math.floor(i/60),t=i%60;return`${e}:${t<10?"0"+t:t}`}static \u0275fac=function(e){return new(e||n)(I(ke),I(jt),I(Hi))};static \u0275cmp=X({type:n,selectors:[["app-liturgical-text-detail"]],decls:24,vars:7,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"margin-top","1rem"],["for","text"],["id","text","rows","4",2,"width","100%",3,"ngModelChange","ngModel"],["for","highlight"],["id","highlight","type","checkbox",3,"ngModelChange","ngModel"],["for","type"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],["title","\xCEnapoi",1,"material-icons",2,"font-size","16px"],["title","\u0218terge",1,"material-icons",2,"font-size","16px"],[2,"width","fit-content",3,"ngModelChange","ngModel"],["rows","4",2,"width","100%",3,"ngModelChange","ngModel"],["title","\u0218terge",1,"material-icons",2,"font-size","12px"],[3,"value"],["for","quote_source"],["id","quote_source",3,"ngModelChange","ngModel"],[3,"class",4,"ngIf"],[2,"display","inline","margin-left","1rem"],["title","Mut\u0103 \xEEn sus",3,"click","disabled"],["title","Mut\u0103 \xEEn jos",3,"click","disabled"],[2,"font-size","24px"]],template:function(e,t){e&1&&(D(0,Wp,15,2,"div",0),ee(1,"hr"),d(2,"div")(3,"h3"),p(4,"Texte"),h(),D(5,Yp,2,0,"p",0),d(6,"ol"),D(7,ng,3,2,"li",1),h()(),d(8,"div",2)(9,"h4"),p(10,"Adaug\u0103 un text nou"),h(),d(11,"label",3),p(12,"Text:"),h(),d(13,"textarea",4),P("ngModelChange",function(s){return O(t.newTextElement.text,s)||(t.newTextElement.text=s),s}),h(),d(14,"label",5),p(15,"Eviden\u021Biere prima liter\u0103: "),h(),d(16,"input",6),P("ngModelChange",function(s){return O(t.newTextElement.highlight,s)||(t.newTextElement.highlight=s),s}),h(),d(17,"label",7),p(18,"Tip text: "),h(),d(19,"select",8),P("ngModelChange",function(s){return O(t.newTextElement.type,s)||(t.newTextElement.type=s),s}),D(20,rg,2,2,"option",9),h(),ee(21,"br"),d(22,"button",10),S("click",function(){return t.addTextElement()}),p(23,"Adaug\u0103"),h()()),e&2&&(b("ngIf",t.text),_(5),b("ngIf",!(!(t.text==null||t.text.texts==null)&&t.text.texts.length)),_(2),b("ngForOf",t.text==null?null:t.text.texts),_(6),R("ngModel",t.newTextElement.text),_(3),R("ngModel",t.newTextElement.highlight),_(3),R("ngModel",t.newTextElement.type),_(),b("ngForOf",t.textTypes))},dependencies:[ae,we,Ue,ge,Ft,Lt,ue,nr,dt,pe,he],styles:[".italicText[_ngcontent-%COMP%]{font-style:italic}.boldText[_ngcontent-%COMP%]{font-weight:500}"]})};var sg=()=>[10,15,25],og=n=>["/liturgicalTexts",n];function ag(n,i){if(n&1&&(d(0,"li")(1,"a",9),p(2),h()()),n&2){let e=i.$implicit;_(),b("routerLink",Ze(2,og,e.id)),_(),ce(" ",e.title?e.title:"F\u0103r\u0103 Titlu"," ")}}function lg(n,i){if(n&1&&(d(0,"option",10),p(1),h()),n&2){let e=i.$implicit;b("value",e),_(),ne(e)}}var Ds=class n{constructor(i){this.litTextService=i}liturgicalTexts=[];newLiturgicalTextName="";searchText="";currentPage=1;totalPages=1;pageSize=10;ngOnInit(){return f(this,null,function*(){yield this.loadData(),yield this.getTotalPages()})}getTotalPages(){return f(this,null,function*(){let i=yield this.litTextService.count();this.totalPages=Math.ceil(i/this.pageSize)})}loadData(){return f(this,null,function*(){this.liturgicalTexts=yield this.litTextService.getPaginated(this.currentPage,this.pageSize,this.searchText.length?[{field:"title",operator:"ilike",value:`%${this.searchText}%`}]:[])})}addLitirgucalText(){return f(this,null,function*(){let i=this.newLiturgicalTextName.trim()??null;try{let e=yield this.litTextService.create({title:i.length>0?i:void 0});this.newLiturgicalTextName="",this.liturgicalTexts.splice(0,0,e)}catch(e){alert("Error creating root type: "+e)}})}searchByTitle(){return f(this,null,function*(){if(this.searchText.length===0){yield this.loadData(),yield this.getTotalPages();return}this.currentPage=1,this.totalPages=1,this.loadData()})}previousPage(){this.currentPage>1&&(this.currentPage--,this.loadData())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadData())}changedPageSize(){this.currentPage=1,this.loadData(),this.getTotalPages()}static \u0275fac=function(e){return new(e||n)(I(jt))};static \u0275cmp=X({type:n,selectors:[["app-liturgical-texts-list"]],decls:24,vars:10,consts:[[2,"margin-bottom","1rem"],["type","text","placeholder","Caut\u0103 dup\u0103 titlu",3,"input","ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"click","disabled"],["title","\u0218terge",1,"material-icons",2,"font-size","12px"],["type","text","placeholder","Text liturgic nou",3,"ngModelChange","ngModel"],[2,"margin-left","1rem",3,"click"],[3,"routerLink"],[3,"value"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"h2"),p(2,"Texte liturgice"),h(),d(3,"label"),p(4,"Caut\u0103 dup\u0103 titlu: "),h(),d(5,"input",1),S("input",function(){return t.searchByTitle()}),P("ngModelChange",function(s){return O(t.searchText,s)||(t.searchText=s),s}),h(),d(6,"ul"),D(7,ag,3,4,"li",2),h(),d(8,"p")(9,"span"),p(10),h(),d(11,"select",3),P("ngModelChange",function(s){return O(t.pageSize,s)||(t.pageSize=s),s}),S("change",function(){return t.changedPageSize()}),D(12,lg,2,2,"option",4),h(),d(13,"button",5),S("click",function(){return t.previousPage()}),d(14,"i",6),p(15,"arrow_left"),h()(),d(16,"button",5),S("click",function(){return t.nextPage()}),d(17,"i",6),p(18,"arrow_right"),h()()(),d(19,"label"),p(20,"Adaug\u0103 un text nou: "),h(),d(21,"input",7),P("ngModelChange",function(s){return O(t.newLiturgicalTextName,s)||(t.newLiturgicalTextName=s),s}),h(),d(22,"button",8),S("click",function(){return t.addLitirgucalText()}),p(23,"Adaug\u0103"),h()()),e&2&&(_(5),R("ngModel",t.searchText),_(2),b("ngForOf",t.liturgicalTexts),_(3),ve("Pagina ",t.currentPage,"/",t.totalPages,", Rug\u0103ciuni per pagin\u0103: "),_(),R("ngModel",t.pageSize),_(),b("ngForOf",cl(9,sg)),_(),b("disabled",t.currentPage===1),_(3),b("disabled",t.currentPage===t.totalPages),_(5),R("ngModel",t.newLiturgicalTextName))},dependencies:[ae,we,Be,ge,Ft,Lt,ue,dt,pe,he],encapsulation:2})};var cg=n=>["/sections",n];function dg(n,i){if(n&1&&(d(0,"li")(1,"a",4)(2,"p"),p(3),h()()()),n&2){let e=i.$implicit;_(),b("routerLink",Ze(3,cg,e.id)),_(2),ve(" ",e.title," ",e.subtitle?" - "+e.subtitle:""," ")}}var Rs=class n{constructor(i){this.sectionsService=i}sections=[];newSectionTitle="";ngOnInit(){return f(this,null,function*(){yield this.loadSections()})}loadSections(){return f(this,null,function*(){this.sections=yield this.sectionsService.getAll()})}addSection(){return f(this,null,function*(){let i=this.newSectionTitle.trim();if(i)try{yield this.sectionsService.create({title:i,audio_url:"",subtitle:null,image_url:null}),this.newSectionTitle="",yield this.loadSections()}catch(e){console.error("Eroare la crearea noii sec\u021Biuni:",e)}})}static \u0275fac=function(e){return new(e||n)(I(Vt))};static \u0275cmp=X({type:n,selectors:[["app-sections-list"]],decls:11,vars:2,consts:[["for","newSectionTitle"],["id","newSectionTitle",3,"ngModelChange","ngModel"],[2,"margin-left","1rem",3,"click"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(e,t){e&1&&(d(0,"div")(1,"h2"),p(2,"Sec\u021Biuni"),h(),d(3,"p")(4,"label",0),p(5,"Ad\u0103uga\u021Bi o sec\u021Biune nou\u0103: "),h(),d(6,"input",1),P("ngModelChange",function(s){return O(t.newSectionTitle,s)||(t.newSectionTitle=s),s}),h(),d(7,"button",2),S("click",function(){return t.addSection()}),p(8," Ad\u0103uga\u021Bi "),h()(),d(9,"ul"),D(10,dg,4,5,"li",3),h()()),e&2&&(_(6),R("ngModel",t.newSectionTitle),_(4),b("ngForOf",t.sections))},dependencies:[ae,we,ge,ue,pe,he,Be],encapsulation:2})};var Os=class n{constructor(i,e){this.el=i;this.renderer=e;this.renderer.setAttribute(this.el.nativeElement,"placeholder","mm:ss")}_value=0;onChange=()=>{};onTouched=()=>{};timeBlur=new fe;onBlur(i){this._value=this.parseValue(i),this.onChange(this._value),this.onTouched(),this.timeBlur.emit(this._value);let e=this.formatValue(i);this.renderer.setProperty(this.el.nativeElement,"value",e)}writeValue(i){this._value=i||0;let e=this.formatValueFromSeconds(this._value);this.renderer.setProperty(this.el.nativeElement,"value",e)}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}parseValue(i){let e=i.split(":"),t=parseInt(e[0]||"0",10),r=parseInt(e[1]||"0",10);return t*60+r}formatValue(i){let e=i.split(":"),t=parseInt(e[0]||"0",10),r=parseInt(e[1]||"0",10);return r>=60&&(t+=Math.floor(r/60),r=r%60),`${this.pad(t)}:${this.pad(r)}`}formatValueFromSeconds(i){let e=Math.floor(i/60),t=i%60;return`${this.pad(e)}:${this.pad(t)}`}pad(i){return i<10?"0"+i:i.toString()}static \u0275fac=function(e){return new(e||n)(I(Pe),I(Ye))};static \u0275dir=K({type:n,selectors:[["","timeInput",""]],hostBindings:function(e,t){e&1&&S("blur",function(s){return t.onBlur(s.target.value)})},outputs:{timeBlur:"timeBlur"},features:[Te([{provide:Nt,useExisting:et(()=>n),multi:!0}])]})};var Ps=class n{transform(i){let e=Math.floor(i/60),t=i%60;return`${e}:${t.toString().padStart(2,"0")}`}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=eo({name:"timeFormat",type:n,pure:!0})};function Pa(n){return Array.isArray(n)?n:[n]}var Na;try{Na=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Na=!1}var Ns=(()=>{class n{_platformId=A(Ht);isBrowser=this._platformId?yl(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Na)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var lu=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({})}return n})();var ug=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var cu=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({providers:[ug]})}return n})();var du=new Set,si,hg=(()=>{class n{_platform=A(Ns);_nonce=A(Yi,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):mg}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&fg(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function fg(n,i){if(!du.has(n))try{si||(si=document.createElement("style"),i&&si.setAttribute("nonce",i),si.setAttribute("type","text/css"),document.head.appendChild(si)),si.sheet&&(si.sheet.insertRule(`@media ${n} {body{ }}`,0),du.add(n))}catch(e){console.error(e)}}function mg(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var hu=(()=>{class n{_mediaMatcher=A(hg);_zone=A(Ie);_queries=new Map;_destroySubject=new Ve;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return uu(Pa(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let r=uu(Pa(e)).map(o=>this._registerQuery(o).observable),s=li(r);return s=dr(s.pipe(Tt(1)),s.pipe(Za(1),qa(0))),s.pipe(z(o=>{let l={matches:!1,breakpoints:{}};return o.forEach(({matches:a,query:c})=>{l.matches=l.matches||a,l.breakpoints[c]=a}),l}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let t=this._mediaMatcher.matchMedia(e),s={observable:new Ba(o=>{let l=a=>this._zone.run(()=>o.next(a));return t.addListener(l),()=>{t.removeListener(l)}}).pipe(hr(t),z(({matches:o})=>({query:e,matches:o})),fr(this._destroySubject)),mql:t};return this._queries.set(e,s),s}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function uu(n){return n.map(i=>i.split(",")).reduce((i,e)=>i.concat(e)).map(i=>i.trim())}var oi=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(oi||{}),fu="cdk-high-contrast-black-on-white",mu="cdk-high-contrast-white-on-black",Fa="cdk-high-contrast-active",pu=(()=>{class n{_platform=A(Ns);_hasCheckedHighContrastMode;_document=A(ye);_breakpointSubscription;constructor(){this._breakpointSubscription=A(hu).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return oi.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let t=this._document.defaultView||window,r=t&&t.getComputedStyle?t.getComputedStyle(e):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return oi.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return oi.BLACK_ON_WHITE}return oi.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(Fa,fu,mu),this._hasCheckedHighContrastMode=!0;let t=this.getHighContrastMode();t===oi.BLACK_ON_WHITE?e.add(Fa,fu):t===oi.WHITE_ON_BLACK&&e.add(Fa,mu)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var La=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({})}return n})();var zi=(()=>{class n{constructor(){A(pu)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({imports:[La,La]})}return n})();var or=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({imports:[zi,cu,zi]})}return n})();var _u=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=oe({type:n});static \u0275inj=se({imports:[zi,or,or,lu,zi]})}return n})();var Fs=class n extends re{constructor(e){super(e);this.supabase=e}tableName="section_texts";create(e){return f(this,null,function*(){let{data:t,error:r}=yield this.client.from(this.tableName).insert([e]).select("*, text: liturgical_texts(*), section_text_elements(*, text_element: text_elements(*))").single();if(r)throw r;return t})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ls=class n extends re{constructor(e){super(e);this.supabase=e}tableName="section_text_elements";deleteMany(e){return f(this,null,function*(){if(e.length===0)return;let{error:t}=yield this.client.rpc("delete_section_text_elements",{deleted_section_text_elements:e.map(r=>({section_text_id:r.section_text_id,text_element_id:r.text_element_id}))});if(t)throw t})}static \u0275fac=function(t){return new(t||n)(N(J))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Sg=n=>["/liturgicalTexts",n];function wg(n,i){n&1&&(d(0,"i",35),p(1,"visibility"),h())}function Cg(n,i){n&1&&(d(0,"i",36),p(1,"visibility_off"),h())}function Tg(n,i){n&1&&(d(0,"i",37),p(1,"visibility"),h())}function Eg(n,i){n&1&&(d(0,"i",38),p(1,"visibility_off"),h())}function Mg(n,i){if(n&1&&(d(0,"audio",39),ee(1,"source",40),p(2," Your browser does not support the audio element."),h()),n&2){let e=y(2);_(),b("src",e.section.audio_url,Qs)}}function Ig(n,i){if(n&1&&ee(0,"img",41),n&2){let e=y(2);b("src",e.section.image_url,Qs)}}function kg(n,i){if(n&1){let e=$();d(0,"div")(1,"h2")(2,"button",20),S("click",function(){C(e);let r=y();return T(r.goBack())}),d(3,"i",21),p(4,"arrow_back"),h()(),p(5),d(6,"button",20),S("click",function(){C(e);let r=y();return T(r.deleteSection())}),d(7,"i",22),p(8,"delete"),h()()(),d(9,"div",23)(10,"div")(11,"table",24)(12,"tr")(13,"td")(14,"label"),p(15,"Titlu:"),h()(),d(16,"td")(17,"input",25),P("ngModelChange",function(r){C(e);let s=y();return O(s.editedSection.title,r)||(s.editedSection.title=r),T(r)}),h(),p(18," \xA0 "),d(19,"button",20),S("click",function(){C(e);let r=y();return T(r.toggleShowTitle())}),D(20,wg,2,0,"i",26)(21,Cg,2,0,"i",27),h()()(),d(22,"tr")(23,"td")(24,"label"),p(25,"Subtitlu:"),h()(),d(26,"td")(27,"input",25),P("ngModelChange",function(r){C(e);let s=y();return O(s.editedSection.subtitle,r)||(s.editedSection.subtitle=r),T(r)}),h(),p(28," \xA0 "),d(29,"button",20),S("click",function(){C(e);let r=y();return T(r.toggleShowSubtitle())}),D(30,Tg,2,0,"i",28)(31,Eg,2,0,"i",29),h()()(),d(32,"tr")(33,"td")(34,"label"),p(35,"Audio URL:"),h()(),d(36,"td")(37,"input",25),P("ngModelChange",function(r){C(e);let s=y();return O(s.editedSection.audio_url,r)||(s.editedSection.audio_url=r),T(r)}),h()(),d(38,"td")(39,"input",30),S("change",function(r){C(e);let s=y();return T(s.onFileSelected(r))}),h()()(),d(40,"tr")(41,"td")(42,"label"),p(43,"URL Imagine:"),h()(),d(44,"td")(45,"input",25),P("ngModelChange",function(r){C(e);let s=y();return O(s.editedSection.image_url,r)||(s.editedSection.image_url=r),T(r)}),h()()(),d(46,"tr")(47,"td",31)(48,"button",20),S("click",function(){C(e);let r=y();return T(r.saveSection())}),ee(49,"i",32),p(50," Salveaz\u0103 "),h()()()(),D(51,Mg,3,1,"audio",33),h(),D(52,Ig,1,1,"img",34),h()()}if(n&2){let e=y();_(5),ve("",e.section.title," ",e.section.subtitle!==null?" - "+e.section.subtitle:""," "),_(12),R("ngModel",e.editedSection.title),_(3),b("ngIf",e.editedSection.show_title),_(),b("ngIf",!e.editedSection.show_title),_(6),R("ngModel",e.editedSection.subtitle),_(3),b("ngIf",e.editedSection.show_subtitle),_(),b("ngIf",!e.editedSection.show_subtitle),_(6),R("ngModel",e.editedSection.audio_url),_(8),R("ngModel",e.editedSection.image_url),_(6),b("ngIf",e.section.audio_url),_(),b("ngIf",e.section.image_url)}}function Ag(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y();return T(r.editAllSectionTexts())}),d(1,"i",42),p(2,"edit"),h()()}}function Dg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y();return T(r.saveAllEditedSectionTexts())}),d(1,"i",43),p(2,"save"),h()()}}function Rg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y();return T(r.cancelAllEditedSectionTexts())}),d(1,"i",44),p(2,"cancel"),h()()}}function Og(n,i){if(n&1&&(d(0,"h4"),p(1),d(2,"a",51),p(3),h(),d(4,"span",52),p(5),It(6,"timeFormat"),It(7,"timeFormat"),h(),d(8,"span",52),p(9),h()()),n&2){let e,t=y(2),r=t.$implicit,s=t.index;_(),ve(" ",s+1,". ",(r==null?null:r.repetition)>1?r.repetition+" x":""," "),_(),b("routerLink",Ze(11,Sg,r.liturgical_text_id)),_(),ce(" ",!(r==null||r.text==null||r.text.title==null)&&r.text.title.length?r==null||r.text==null?null:r.text.title:"F\u0103r\u0103 Titlu"," "),_(2),ve(" ",kt(6,7,(e=r.start_time)!==null&&e!==void 0?e:0)," \u2192 ",kt(7,9,(e=r.end_time)!==null&&e!==void 0?e:0)," "),_(4),ce(" ",r.italic?"Italic":"Normal"," ")}}function Pg(n,i){if(n&1&&(it(0),D(1,Og,10,13,"h4",0),nt()),n&2){let e=y(2);_(),b("ngIf",e.allLitTexts&&e.allLitTexts.length)}}function Ng(n,i){n&1&&(d(0,"span"),p(1,"Normal"),h())}function Fg(n,i){n&1&&(d(0,"span"),p(1,"Italic"),h())}function Lg(n,i){if(n&1){let e=$();it(0),d(1,"span"),p(2),d(3,"label"),p(4,"Repet\u0103ri: "),h(),d(5,"input",53),P("ngModelChange",function(r){C(e);let s=y().$implicit,o=y();return O(o.getEditingSectionText(s.id).repetition,r)||(o.getEditingSectionText(s.id).repetition=r),T(r)}),h()(),d(6,"span",52)(7,"input",54),P("ngModelChange",function(r){C(e);let s=y().$implicit,o=y();return O(o.getEditingSectionText(s.id).start_time,r)||(o.getEditingSectionText(s.id).start_time=r),T(r)}),h(),p(8," \u2192 "),d(9,"input",55),P("ngModelChange",function(r){C(e);let s=y().$implicit,o=y();return O(o.getEditingSectionText(s.id).end_time,r)||(o.getEditingSectionText(s.id).end_time=r),T(r)}),h()(),d(10,"div",56)(11,"span"),p(12,"Stil: "),h(),d(13,"button",20),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.toggleSectionTextItalic(r.id))}),D(14,Ng,2,0,"span",0)(15,Fg,2,0,"span",0),h()(),nt()}if(n&2){let e,t,r=y(),s=r.$implicit,o=r.index,l=y();_(2),ve(" ",o+1,". ",s.text==null?null:s.text.title,", "),_(3),R("ngModel",l.getEditingSectionText(s.id).repetition),_(2),R("ngModel",l.getEditingSectionText(s.id).start_time),_(2),R("ngModel",l.getEditingSectionText(s.id).end_time),_(5),b("ngIf",!((e=l.getEditingSectionText(s.id))!=null&&e.italic)),_(),b("ngIf",(t=l.getEditingSectionText(s.id))==null?null:t.italic)}}function Vg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y(2).$implicit,s=y();return T(s.playSectionText(r))}),d(1,"i",61),p(2,"play_arrow"),h()()}}function jg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y(3);return T(r.pauseSectionText())}),d(1,"i",61),p(2,"pause"),h()()}}function Ug(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y(3);return T(r.stopPlayingSectionText())}),d(1,"i",61),p(2,"stop"),h()()}}function $g(n,i){if(n&1){let e=$();d(0,"div",57)(1,"button",58),S("click",function(){C(e);let r=y().index,s=y();return T(s.moveUp(r))}),p(2,"\u2191"),h(),d(3,"button",59),S("click",function(){C(e);let r=y().index,s=y();return T(s.moveDown(r))}),p(4,"\u2193"),h(),d(5,"button",20),S("click",function(){C(e);let r=y(),s=r.$implicit,o=r.index,l=y();return T(l.deleteSectionText(s,o))}),d(6,"i",60),p(7,"delete"),h()(),d(8,"button",20),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.addEditingSectionText(r))}),d(9,"i",42),p(10,"edit"),h()(),D(11,Vg,3,0,"button",2)(12,jg,3,0,"button",2)(13,Ug,3,0,"button",2),h()}if(n&2){let e=y(),t=e.$implicit,r=e.index,s=y();_(),b("disabled",r===0),_(2),b("disabled",r===s.sectionTexts.length-1),_(8),b("ngIf",s.playingSectionText==null||s.playingSectionText.id!==t.id||s.playingSectionText.id===t.id&&s.audio.paused),_(),b("ngIf",!s.audio.paused&&s.playingSectionText!==null&&s.playingSectionText.id===t.id),_(),b("ngIf",s.playingSectionText!==null&&s.playingSectionText.id===t.id)}}function Bg(n,i){if(n&1){let e=$();d(0,"div",57)(1,"button",20),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.saveSingleEditedSectionText(r.id))}),d(2,"i",43),p(3,"save"),h()(),d(4,"button",20),S("click",function(){C(e);let r=y().$implicit,s=y();return T(s.removeEditingSectionText(r.id))}),d(5,"i",62),p(6,"cancel"),h()()()}}function Hg(n,i){n&1&&(d(0,"p"),p(1,"Nu exist\u0103 texte ad\u0103ugate"),h())}function zg(n,i){n&1&&(d(0,"i",61),p(1,"pause"),h())}function Gg(n,i){n&1&&(d(0,"i",61),p(1,"play_arrow"),h())}function qg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y().index,s=y(2).$implicit,o=y();return T(o.setEndTimeToCurrentTime(s.id,r))}),d(1,"i",61),p(2,"timer"),h()()}}function Wg(n,i){if(n&1){let e=$();d(0,"button",20),S("click",function(){C(e);let r=y().index,s=y(2).$implicit,o=y();return T(o.deleteSectionTextElement(s.id,r))}),d(1,"i",71),p(2,"delete"),h()()}}function Yg(n,i){if(n&1){let e=$();d(0,"li")(1,"div",65)(2,"div",66),p(3),h(),d(4,"div",67)(5,"input",68),S("timeBlur",function(){let r=C(e).index,s=y(2).$implicit,o=y();return T(o.onTextElementStartTimeChanged(s.id,r))}),P("ngModelChange",function(r){let s=C(e).$implicit;return O(s.start_time,r)||(s.start_time=r),T(r)}),h(),p(6," \u2192 "),d(7,"input",69),S("timeBlur",function(){let r=C(e).index,s=y(2).$implicit,o=y();return T(o.onTextElementEndTimeChanged(s.id,r))}),P("ngModelChange",function(r){let s=C(e).$implicit;return O(s.end_time,r)||(s.end_time=r),T(r)}),h(),d(8,"span"),p(9),h(),d(10,"button",20),S("click",function(){let r=C(e).$implicit,s=y(3);return T(s.playAudioPart(r.start_time,r.end_time))}),D(11,zg,2,0,"i",70)(12,Gg,2,0,"i",70),h(),D(13,qg,3,0,"button",2)(14,Wg,3,0,"button",2),h()()()}if(n&2){let e,t=i.$implicit,r=i.index,s=y(2).$implicit,o=y();_(3),ce("",t.text_element.text," "),_(2),R("ngModel",t.start_time),_(2),b("disabled",r<((e=o.getEditingSectionText(s.id))==null?null:e.section_text_elements.length)-1),R("ngModel",t.end_time),_(2),ne(" "),_(2),b("ngIf",!o.audio.paused&&o.audio.currentTime>=t.start_time&&o.audio.currentTime<t.end_time),_(),b("ngIf",o.audio.paused||o.audio.currentTime>=t.end_time||o.audio.currentTime<t.start_time),_(),b("ngIf",!o.audio.paused&&o.audio.currentTime>=t.start_time&&o.audio.currentTime<t.end_time),_(),b("ngIf",o.audio.paused||o.audio.currentTime>=t.end_time||o.audio.currentTime<t.start_time)}}function Kg(n,i){if(n&1&&(it(0),d(1,"div",63)(2,"ol"),D(3,Hg,2,0,"p",0)(4,Yg,15,9,"li",64),h()(),nt()),n&2){let e,t,r=y().$implicit,s=y();_(3),b("ngIf",!(!((e=s.getEditingSectionText(r.id))==null||e.section_text_elements==null)&&e.section_text_elements.length)),_(),b("ngForOf",(t=s.getEditingSectionText(r.id))==null?null:t.section_text_elements)}}function Zg(n,i){n&1&&(d(0,"p"),p(1,"Nu exist\u0103 texte ad\u0103ugate"),h())}function Jg(n,i){if(n&1&&(d(0,"div")(1,"b"),p(2),d(3,"span"),p(4),It(5,"timeFormat"),h(),p(6," \u2192 "),d(7,"span"),p(8),It(9,"timeFormat"),h()()()),n&2){let e,t,r=y().$implicit,s=y(2).$implicit;_(2),ce(" ",r.text_element.text," "),_(2),ne(kt(5,3,((e=s.start_time)!==null&&e!==void 0?e:0)+r.start_time)),_(4),ne(kt(9,5,((t=s.start_time)!==null&&t!==void 0?t:0)+r.end_time))}}function Qg(n,i){if(n&1&&(d(0,"div"),p(1),d(2,"span"),p(3),It(4,"timeFormat"),h(),p(5," \u2192 "),d(6,"span"),p(7),It(8,"timeFormat"),h()()),n&2){let e,t,r=y().$implicit,s=y(2).$implicit;_(),ce(" ",r.text_element.text," "),_(2),ne(kt(4,3,((e=s.start_time)!==null&&e!==void 0?e:0)+r.start_time)),_(4),ne(kt(8,5,((t=s.start_time)!==null&&t!==void 0?t:0)+r.end_time))}}function Xg(n,i){if(n&1&&(d(0,"li"),D(1,Jg,10,7,"div",0)(2,Qg,9,7,"div",0),h()),n&2){let e=i.$implicit,t=y(2).$implicit,r=y();_(),b("ngIf",(!r.audio.paused||r.playingSectionText!=null&&r.playingSectionText.id===t.id)&&t.start_time+e.start_time<=r.currentTime&&t.start_time+e.end_time>r.currentTime),_(),b("ngIf",r.audio.paused&&(r.playingSectionText==null||r.playingSectionText.id!==t.id)||t.start_time+e.start_time>r.currentTime||t.start_time+e.end_time<r.currentTime)}}function e_(n,i){if(n&1&&(d(0,"div",63)(1,"ol"),D(2,Zg,2,0,"p",0)(3,Xg,3,2,"li",64),h()()),n&2){let e=y().$implicit;_(2),b("ngIf",!(e.section_text_elements!=null&&e.section_text_elements.length)),_(),b("ngForOf",e.section_text_elements)}}function t_(n,i){if(n&1&&(d(0,"li",45)(1,"div",46)(2,"div",47),D(3,Pg,2,1,"ng-container",0)(4,Lg,16,7,"ng-container",0),h(),d(5,"div",48),D(6,$g,14,5,"div",49)(7,Bg,7,0,"div",49),h()(),D(8,Kg,5,2,"ng-container",0),it(9),D(10,e_,4,2,"div",50),nt(),h()),n&2){let e=i.$implicit,t=y();_(3),b("ngIf",!t.isEditingSectionText(e.id)),_(),b("ngIf",t.isEditingSectionText(e.id)),_(2),b("ngIf",!t.isEditingSectionText(e.id)),_(),b("ngIf",t.isEditingSectionText(e.id)),_(),b("ngIf",t.isEditingSectionText(e.id)),_(2),b("ngIf",!t.isEditingSectionText(e.id))}}function i_(n,i){if(n&1&&(d(0,"option",72),p(1),h()),n&2){let e=i.$implicit;b("value",e.id),_(),ce(" ",e.title," ")}}function n_(n,i){if(n&1){let e=$();d(0,"tr")(1,"td")(2,"label",73),p(3,"Titlu:"),h()(),d(4,"td")(5,"input",74),P("ngModelChange",function(r){C(e);let s=y();return O(s.newLiturgicalText.title,r)||(s.newLiturgicalText.title=r),T(r)}),h()()()}if(n&2){let e=y();_(5),R("ngModel",e.newLiturgicalText.title)}}function r_(n,i){if(n&1&&(d(0,"option",72),p(1),h()),n&2){let e=i.$implicit;b("value",e),_(),ne(e)}}function s_(n,i){if(n&1){let e=$();d(0,"div",76)(1,"div",77)(2,"span"),p(3),d(4,"label",78),p(5,"Eviden\u021Biere prima liter\u0103: "),h(),d(6,"input",79),P("ngModelChange",function(r){let s=C(e).$implicit;return O(s.highlight,r)||(s.highlight=r),T(r)}),h(),d(7,"label"),p(8,"Tip text: "),h(),d(9,"select",25),P("ngModelChange",function(r){let s=C(e).$implicit;return O(s.type,r)||(s.type=r),T(r)}),D(10,r_,2,2,"option",11),h()(),d(11,"button",20),S("click",function(){let r=C(e).index,s=y(2);return T(s.deleteTextElementFromNewLiturgicalText(r))}),d(12,"i",61),p(13,"delete"),h()()(),d(14,"textarea",80),P("ngModelChange",function(r){let s=C(e).$implicit;return O(s.text,r)||(s.text=r),T(r)}),h()()}if(n&2){let e=i.$implicit,t=i.index,r=y(2);_(3),ce("Text ",t+1,", "),_(),yr("for","highlight",t,""),_(2),yr("id","highlight",t,""),R("ngModel",e.highlight),_(3),R("ngModel",e.type),_(),b("ngForOf",r.textTypes),_(4),yr("id","newTextElement",t,""),R("ngModel",e.text)}}function o_(n,i){if(n&1){let e=$();it(0),D(1,s_,15,11,"div",75),d(2,"button",20),S("click",function(){C(e);let r=y();return T(r.addTextElementToNewLiturgicalText())}),ee(3,"i",19),p(4," Ad\u0103uga\u021Bi fraz\u0103 nou\u0103 "),h(),ee(5,"br"),nt()}if(n&2){let e=y();_(),b("ngForOf",e.newLiturgicalText.texts)}}var Vs=class n{constructor(i,e,t,r,s,o,l,a){this.route=i;this.router=e;this.sectionsService=t;this.sectionTextsService=r;this.litTextsService=s;this.sectionTextElementsService=o;this.textElementsService=l;this.supabaseService=a}sectionId;section=null;sectionTexts=[];textTypes=Object.values(sr);allLitTexts=[];editedSection={};audio=new Audio;timeOut;newSectionText={};newLiturgicalText={};editingSectionTexts=[];currentTime=0;uploadedFile=null;floor=Math.floor;playingSectionText=null;ngOnInit(){return f(this,null,function*(){this.sectionId=this.route.snapshot.paramMap.get("id")||"",this.newSectionText={prayer_section_id:this.sectionId,sequence:0,liturgical_text_id:"new",repetition:1},this.newLiturgicalText={texts:[]},this.addTextElementToNewLiturgicalText(),yield this.loadSection(),yield this.loadAllLitTexts(),yield this.loadSectionTexts()})}loadSection(){return f(this,null,function*(){this.section=yield this.sectionsService.getById(this.sectionId),this.section&&(this.audio.src=this.section.audio_url,this.audio.ontimeupdate=()=>{this.currentTime=this.audio.currentTime},this.editedSection=E({},this.section))})}deleteSection(){return f(this,null,function*(){if(confirm("\u0218terge aceast\u0103 sec\u021Biune?"))try{yield this.sectionsService.delete(this.sectionId),alert("Sec\u021Biune \u0219tears\u0103 cu succes!"),this.router.navigate(["/sections"])}catch(i){console.error("Eroare la \u0219tergere:",i)}})}loadAllLitTexts(){return f(this,null,function*(){this.allLitTexts=yield this.litTextsService.getAll()})}loadSectionTexts(){return f(this,null,function*(){let{data:i,error:e}=yield this.sectionTextsService.client.from("section_texts").select("*, text: liturgical_texts(*, texts: text_elements(*)), section_text_elements: section_text_elements(*, text_element: text_elements(*))").eq("prayer_section_id",this.sectionId).order("sequence",{ascending:!0}).order("sequence",{ascending:!0,foreignTable:"liturgical_texts.text_elements"}).order("sequence",{ascending:!0,foreignTable:"section_text_elements"});!e&&i&&(this.sectionTexts=i,this.newSectionText.start_time=this.sectionTexts.length>0?this.sectionTexts[this.sectionTexts.length-1].end_time:0)})}saveSection(){return f(this,null,function*(){if(this.section){if(this.uploadedFile){let i=this.uploadedFile.name;try{let e=yield this.supabaseService.uploadFile(this.uploadedFile,i);this.editedSection.audio_url=e}catch(e){alert("Eroare la \xEEnc\u0103rcarea fi\u0219ierului: "+e.name+" - "+e.message),this.editedSection.audio_url=""}}this.editedSection.texts=null,delete this.editedSection.texts;try{let i=yield this.sectionsService.update(this.section.id,this.editedSection);i&&(this.section.title=i.title,this.section.subtitle=i.subtitle,this.section.audio_url=i.audio_url,this.section.image_url=i.image_url,alert("Sec\u021Biune salvat\u0103 cu succes!"))}catch(i){console.error("Eroare la salvarea sec\u021Biunii:",i)}}})}addLiturgicalTextToSection(){return f(this,null,function*(){if(!this.newSectionText.liturgical_text_id)return;let i=0;this.sectionTexts.length>0&&(i=Math.max(...this.sectionTexts.map(e=>e.sequence)));try{if(this.newSectionText.liturgical_text_id==="new"){let s=yield this.litTextsService.create({title:this.newLiturgicalText.title});this.newLiturgicalText.texts.forEach(o=>o.text_id=s.id),yield this.textElementsService.bulkUpdate(this.newLiturgicalText.texts),this.newSectionText.liturgical_text_id=s.id,this.newLiturgicalText={texts:[]}}let e=yield this.sectionTextsService.create({prayer_section_id:this.sectionId,liturgical_text_id:this.newSectionText.liturgical_text_id,sequence:i+1,repetition:this.newSectionText.repetition??1,start_time:this.newSectionText.start_time??null,end_time:this.newSectionText.end_time??null}),{data:t,error:r}=yield this.sectionTextElementsService.client.from("section_text_elements").select("*, text_element: text_elements(*)").eq("section_text_id",e.id).order("sequence",{ascending:!0});r||(e.section_text_elements=t),this.newSectionText.start_time=e.end_time??0,this.newSectionText.end_time=(e.end_time??0)+60,this.sectionTexts.push(e),this.editingSectionTexts.length&&this.addEditingSectionText(e)}catch(e){console.error("Eroare la ad\u0103ugarea textului:",e)}})}deleteSectionText(i,e){return f(this,null,function*(){if(confirm("\u0218terge acest text din sec\u021Biune?"))try{yield this.sectionTextsService.delete(i.id),this.sectionTexts.splice(e,1)}catch(t){console.error("Eroare la \u0219tergere:",t)}})}moveUp(i){return f(this,null,function*(){if(i===0)return;let e=this.sectionTexts[i],t=this.sectionTexts[i-1],r=e.sequence;e.sequence=t.sequence,t.sequence=r;try{yield this.sectionTextsService.update(e.id,{sequence:e.sequence}),yield this.sectionTextsService.update(t.id,{sequence:t.sequence}),this.sectionTexts[i]=t,this.sectionTexts[i-1]=e}catch(s){console.error("Eroare la mutare \xEEn sus:",s)}})}moveDown(i){return f(this,null,function*(){if(i===this.sectionTexts.length-1)return;let e=this.sectionTexts[i],t=this.sectionTexts[i+1],r=e.sequence;e.sequence=t.sequence,t.sequence=r;try{yield this.sectionTextsService.update(e.id,{sequence:e.sequence}),yield this.sectionTextsService.update(t.id,{sequence:t.sequence}),this.sectionTexts[i]=t,this.sectionTexts[i+1]=e}catch(s){console.error("Eroare la mutare \xEEn jos:",s)}})}editAllSectionTexts(){this.editingSectionTexts=JSON.parse(JSON.stringify(this.sectionTexts)),this.editingSectionTexts.forEach(i=>{i.section_text_elements?.forEach(e=>{e.start_time=(i?.start_time??0)+e.start_time,e.end_time=(i?.start_time??0)+e.end_time})})}cancelAllEditedSectionTexts(){this.editingSectionTexts=[]}addEditingSectionText(i){var e=JSON.parse(JSON.stringify(i));e.section_text_elements?.forEach(t=>{t.start_time=(e?.start_time??0)+t.start_time,t.end_time=(e?.start_time??0)+t.end_time}),this.editingSectionTexts.push(e)}removeEditingSectionText(i){let e=this.editingSectionTexts.findIndex(t=>t.id===i);e>=0&&this.editingSectionTexts.splice(e,1)}saveSingleEditedSectionText(i){return f(this,null,function*(){let e=this.editingSectionTexts.findIndex(a=>a.id===i);if(e<0)return;let t=this.editingSectionTexts[e],r=yield this.sectionTextsService.update(t.id,{start_time:t.start_time,end_time:t.end_time,repetition:t.repetition,italic:t.italic}),s=this.sectionTexts.find(a=>a.id===t?.id),o=s?.section_text_elements?.filter(a=>!t.section_text_elements?.find(c=>c.text_element_id===a.text_element_id))??[];o.length&&(yield this.sectionTextElementsService.deleteMany(o),s.section_text_elements=s?.section_text_elements?.filter(a=>!o.find(c=>c.text_element_id===a.text_element_id))??[]);let l=t.section_text_elements?.map(a=>({start_time:a.start_time-(t?.start_time??0),end_time:a.end_time-(t?.start_time??0),text_element_id:a.text_element_id,section_text_id:a.section_text_id}))??[];yield this.sectionTextElementsService.bulkUpdate(l),s.section_text_elements=t.section_text_elements?.map(a=>({start_time:a.start_time-(t?.start_time??0),end_time:a.end_time-(t?.start_time??0),text_element_id:a.text_element_id,section_text_id:a.section_text_id,text_element:a.text_element}))??[],s.repetition=r.repetition,s.start_time=r.start_time,s.end_time=r.end_time,this.editingSectionTexts.splice(e,1)})}saveAllEditedSectionTexts(){return f(this,null,function*(){for(let i=0;i<this.editingSectionTexts.length;i++){let e=this.editingSectionTexts[i],t=yield this.sectionTextsService.update(e.id,{start_time:e.start_time,end_time:e.end_time,repetition:e.repetition,italic:e.italic}),r=this.sectionTexts.find(l=>l.id===e?.id),s=r?.section_text_elements?.filter(l=>!e.section_text_elements?.find(a=>a.text_element_id===l.text_element_id))??[];s.length&&(yield this.sectionTextElementsService.deleteMany(s),r.section_text_elements=r?.section_text_elements?.filter(l=>!s.find(a=>a.text_element_id===l.text_element_id))??[]);let o=e.section_text_elements?.map(l=>({start_time:l.start_time-(e?.start_time??0),end_time:l.end_time-(e?.start_time??0),text_element_id:l.text_element_id,section_text_id:l.section_text_id}))??[];yield this.sectionTextElementsService.bulkUpdate(o),r.section_text_elements=e.section_text_elements?.map(l=>({start_time:l.start_time-(e?.start_time??0),end_time:l.end_time-(e?.start_time??0),text_element_id:l.text_element_id,section_text_id:l.section_text_id,text_element:l.text_element}))??[],r.repetition=t.repetition,r.start_time=t.start_time,r.end_time=t.end_time}this.editingSectionTexts=[]})}goBack(){window.history.back()}onFileSelected(i){let t=i.target?.files?.[0];t?(this.uploadedFile=t,this.editedSection.audio_url=t.name):this.uploadedFile=null}onLitTextSelected(i){let e=i.target;this.newSectionText.liturgical_text_id=e.value,this.newSectionText.end_time=this.newSectionText.start_time??0}playAudioPart(i,e){!this.section||!this.section.audio_url?.length||(this.audio.src!==this.section?.audio_url&&(this.audio.src=this.section?.audio_url??""),this.audio.paused||this.audio.currentTime>=e||this.audio.currentTime<i?(clearTimeout(this.timeOut),this.currentTime=i,this.audio.currentTime=i,this.audio.play(),this.audio.loop=!1,this.timeOut=setTimeout(()=>{this.audio.pause()},(e-i)*1e3)):(this.audio.pause(),clearTimeout(this.timeOut),this.currentTime=0))}forcePlayAudioPart(i,e){clearTimeout(this.timeOut),this.audio.pause(),this.audio.currentTime=i,this.audio.play(),this.audio.loop=!1,this.timeOut=setTimeout(()=>{this.currentTime=0,this.audio.pause(),this.playingSectionText=null},(e-i)*1e3)}playSectionText(i){if(this.playingSectionText!=null&&this.playingSectionText.id===i.id){this.audio.paused?this.audio.play():this.audio.pause();return}this.playingSectionText=i,this.playAudioPart(i.start_time??0,i.end_time??0)}pauseSectionText(){this.audio.pause()}stopPlayingSectionText(){this.audio.pause(),clearTimeout(this.timeOut),this.currentTime=0,this.playingSectionText=null}onTextElementStartTimeChanged(i,e){let t=this.sectionTexts.findIndex(a=>a.id===i),r=t>0?this.sectionTexts[t-1]?.id:null,s=this.editingSectionTexts.find(a=>a.id===i),o=this.editingSectionTexts.find(a=>a.id===r);if(!s)return;let l=s.section_text_elements[e];if(e===0&&(s.start_time=l.start_time,o!=null&&(o.end_time=l.start_time,o.section_text_elements?.length))){let a=o.section_text_elements[o.section_text_elements.length-1];a.end_time=l.start_time}if(e>0){let a=s.section_text_elements[e-1];a.end_time=l.start_time}l.end_time<=l.start_time&&(l.end_time=l.start_time+60),this.forcePlayAudioPart(l.start_time,l.end_time)}onTextElementEndTimeChanged(i,e){let t=this.sectionTexts.findIndex(a=>a.id===i),r=t<this.sectionTexts.length-1?this.sectionTexts[t+1]?.id:null,s=this.editingSectionTexts.find(a=>a.id===i),o=this.editingSectionTexts.find(a=>a.id===r);if(!s)return;let l=s.section_text_elements[e];if(e===s.section_text_elements.length-1&&(s.end_time=l.end_time),e<s.section_text_elements.length-1){let a=s.section_text_elements[e+1];a.start_time=l.end_time,a.end_time<=a.start_time&&(a.end_time=a.start_time+60),this.forcePlayAudioPart(a.start_time,a.end_time)}else if(e===s.section_text_elements.length-1&&o!=null){o.start_time=l.end_time,(!o.end_time||o.end_time<=o.start_time)&&(o.end_time=o.start_time+60);let a=o.section_text_elements[0];a&&(a.start_time=o.start_time,a.end_time<=a.start_time&&(a.end_time=a.start_time+60)),this.forcePlayAudioPart(a.start_time,a.end_time)}}setEndTimeToCurrentTime(i,e){let t=this.editingSectionTexts.find(s=>s.id===i);if(!t||e>=t.section_text_elements.length||e<0)return;let r=t.section_text_elements[e];r.end_time=Math.floor(this.currentTime),this.onTextElementEndTimeChanged(i,e)}addTextElementToNewLiturgicalText(){this.newLiturgicalText.texts.push({text:"",sequence:this.newLiturgicalText.texts.length+1,type:"plainText",highlight:!1})}deleteTextElementFromNewLiturgicalText(i){this.newLiturgicalText.texts.splice(i,1)}isEditingSectionText(i){return this.editingSectionTexts.find(e=>e.id===i)!=null}getEditingSectionText(i){return this.editingSectionTexts.find(e=>e.id===i)}deleteSectionTextElement(i,e){if(!confirm("\u0218tergi aceast\u0103 fraz\u0103 de text din sec\u021Biune? (doar \xEEn aceast\u0103 sec\u021Biune)"))return;let t=this.editingSectionTexts.find(r=>r.id===i);t&&t.section_text_elements?.splice(e,1)}toggleShowTitle(){this.editedSection.show_title=!this.editedSection.show_title}toggleShowSubtitle(){this.editedSection.show_subtitle=!this.editedSection.show_subtitle}toggleSectionTextItalic(i){let e=this.getEditingSectionText(i);e&&(e.italic=!e.italic)}static \u0275fac=function(e){return new(e||n)(I(ke),I(be),I(Vt),I(Fs),I(jt),I(Ls),I(Hi),I(J))};static \u0275cmp=X({type:n,selectors:[["app-section-detail"]],decls:55,vars:16,consts:[[4,"ngIf"],[3,"align"],[3,"click",4,"ngIf"],[2,"display","flex","justify-content","left"],[1,"sections-texts",2,"margin-top","20px","padding-left","0"],["style","padding: 8px; display: flex; justify-content: center; align-items: left; flex-direction:column;",4,"ngFor","ngForOf"],[2,"border-collapse","collapse"],["for","litTextSelect"],["id","litTextSelect",3,"ngModelChange","change","ngModel"],["value",""],["value","new","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","startTime"],["id","startTime","type","text","placeholder","Ex: 0","timeInput","",3,"ngModelChange","ngModel"],["for","endTime"],["id","endTime","type","text","placeholder","Ex: 20","timeInput","",3,"ngModelChange","ngModel"],["for","repetitions"],["id","repetitions","type","number","placeholder","Ex: 1",3,"ngModelChange","ngModel"],[2,"width","100px","margin","10px auto",3,"click"],[1,"fa","fa-plus"],[3,"click"],["title","\xCEnapoi",1,"material-icons",2,"font-size","16px"],["title","\u0218terge",1,"material-icons",2,"font-size","16px"],[2,"display","flex","justify-content","space-between"],[1,"section-edit-fields",2,"border-collapse","collapse"],[3,"ngModelChange","ngModel"],["class","material-icons","style","font-size:12px","title","Afiseaza titlul",4,"ngIf"],["class","material-icons","style","font-size:12px","title","Ascunde titlul",4,"ngIf"],["class","material-icons","style","font-size:12px","title","Afiseaza subtitlul",4,"ngIf"],["class","material-icons","style","font-size:12px","title","Ascunde subtitlul",4,"ngIf"],["type","file",3,"change"],["colspan","2",2,"text-align","left"],[1,"fa","fa-save"],["controls","",4,"ngIf"],["alt","Section Image","style","margin-left: 20px; max-width: 200px; max-height: 200px;",3,"src",4,"ngIf"],["title","Afiseaza titlul",1,"material-icons",2,"font-size","12px"],["title","Ascunde titlul",1,"material-icons",2,"font-size","12px"],["title","Afiseaza subtitlul",1,"material-icons",2,"font-size","12px"],["title","Ascunde subtitlul",1,"material-icons",2,"font-size","12px"],["controls",""],["type","audio/mpeg",3,"src"],["alt","Section Image",2,"margin-left","20px","max-width","200px","max-height","200px",3,"src"],["title","Editeaz\u0103",1,"material-icons",2,"font-size","12px"],["title","Salveaza",1,"material-icons",2,"font-size","12px"],["title","anuleaza",1,"material-icons",2,"font-size","12px"],[2,"padding","8px","display","flex","justify-content","center","align-items","left","flex-direction","column"],[2,"display","flex","justify-content","space-between","width","fit-content","gap","2rem"],[2,"display","flex"],[2,"display","flex","justify-content","center","align-items","center"],["style","display: flex; gap: 0.1rem",4,"ngIf"],["style","width: 800px;",4,"ngIf"],[3,"routerLink"],[2,"margin-left","10px"],["type","number",2,"width","60px",3,"ngModelChange","ngModel"],["id","startTime","type","text","timeInput","",2,"width","60px",3,"ngModelChange","ngModel"],["id","endTime","type","text","timeInput","",2,"width","60px",3,"ngModelChange","ngModel"],[2,"height","48px","display","flex","align-items","center","gap","0.5rem"],[2,"display","flex","gap","0.1rem"],["title","Mut\u0103 \xEEn sus",3,"click","disabled"],["title","Mut\u0103 \xEEn jos",3,"click","disabled"],["title","\u0218terge",1,"material-icons",2,"font-size","12px"],["title","Play",1,"material-icons",2,"font-size","12px"],["title","Renun\u021B\u0103",1,"material-icons",2,"font-size","12px"],[2,"width","800px"],[4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","justify-content","center","align-items","end"],[2,"width","800px","min-height","64px"],[2,"width","400px"],["type","text","timeInput","",2,"width","60px",3,"timeBlur","ngModelChange","ngModel"],["type","text","timeInput","",2,"width","60px",3,"timeBlur","ngModelChange","disabled","ngModel"],["class","material-icons","style","font-size:12px","title","Play",4,"ngIf"],["title","Sterge",1,"material-icons",2,"font-size","12px"],[3,"value"],["for","newTextTitle"],["id","newTextTitle","type","text","placeholder","Ex: N\u0103sc\u0103toare de Dumnezeu",3,"ngModelChange","ngModel"],["style","margin: 0!important;",4,"ngFor","ngForOf"],[2,"margin","0!important"],[2,"display","flex","justify-content","space-between","width","80%","margin","0!important"],[3,"for"],["type","checkbox",3,"ngModelChange","ngModel","id"],["type","text","rows","4",2,"width","80%",3,"ngModelChange","id","ngModel"]],template:function(e,t){e&1&&(D(0,kg,53,12,"div",0),ee(1,"hr"),d(2,"div")(3,"h3",1),p(4,"Texte \xEEn sec\u021Biune "),D(5,Ag,3,0,"button",2)(6,Dg,3,0,"button",2)(7,Rg,3,0,"button",2),h(),d(8,"h3"),p(9," Timp curent: "),d(10,"span"),p(11),It(12,"timeFormat"),h()(),d(13,"div",3)(14,"ol",4),D(15,t_,11,6,"li",5),h()()(),ee(16,"hr"),d(17,"div")(18,"h3"),p(19,"Ad\u0103uga\u021Bi un text nou \xEEn sec\u021Biune"),h(),d(20,"table",6)(21,"tr")(22,"td")(23,"label",7),p(24,"Selecta\u021Bi un text liturgic:"),h()(),d(25,"td")(26,"select",8),P("ngModelChange",function(s){return O(t.newSectionText.liturgical_text_id,s)||(t.newSectionText.liturgical_text_id=s),s}),S("change",function(s){return t.onLitTextSelected(s)}),d(27,"option",9),p(28,"-- Alege\u021Bi --"),h(),d(29,"option",10),p(30,"-- Text nou --"),h(),D(31,i_,2,2,"option",11),h()()(),D(32,n_,6,1,"tr",0),d(33,"tr")(34,"td")(35,"label",12),p(36,"Timp \xEEnceput:"),h()(),d(37,"td")(38,"input",13),P("ngModelChange",function(s){return O(t.newSectionText.start_time,s)||(t.newSectionText.start_time=s),s}),h()()(),d(39,"tr")(40,"td")(41,"label",14),p(42,"Timp sf\xE2r\u0219it:"),h()(),d(43,"td")(44,"input",15),P("ngModelChange",function(s){return O(t.newSectionText.end_time,s)||(t.newSectionText.end_time=s),s}),h()()(),d(45,"tr")(46,"td")(47,"label",16),p(48,"Repet\u0103ri:"),h()(),d(49,"td")(50,"input",17),P("ngModelChange",function(s){return O(t.newSectionText.repetition,s)||(t.newSectionText.repetition=s),s}),h()()()(),D(51,o_,6,1,"ng-container",0),d(52,"button",18),S("click",function(){return t.addLiturgicalTextToSection()}),ee(53,"i",19),p(54,"Salveaz\u0103 "),h()()),e&2&&(b("ngIf",t.section),_(3),b("align","left"),_(2),b("ngIf",!(t.editingSectionTexts!=null&&t.editingSectionTexts.length)),_(),b("ngIf",t.editingSectionTexts==null?null:t.editingSectionTexts.length),_(),b("ngIf",t.editingSectionTexts==null?null:t.editingSectionTexts.length),_(4),ne(kt(12,14,t.floor(t.currentTime))),_(4),b("ngForOf",t.sectionTexts),_(11),R("ngModel",t.newSectionText.liturgical_text_id),_(5),b("ngForOf",t.allLitTexts),_(),b("ngIf",t.newSectionText.liturgical_text_id==="new"),_(6),R("ngModel",t.newSectionText.start_time),_(6),R("ngModel",t.newSectionText.end_time),_(6),R("ngModel",t.newSectionText.repetition),_(),b("ngIf",t.newSectionText.liturgical_text_id==="new"))},dependencies:[ae,we,Ue,ge,Ft,Lt,ue,rr,nr,dt,pe,he,Be,Os,Ps,_u,or],styles:[".section_edit_fields[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:10px;gap:1rem}.highlight[_ngcontent-%COMP%]{font-weight:700}.sections-texts[_ngcontent-%COMP%]{list-style-type:upper-roman!important}"]})};var vu=[{path:"",redirectTo:"prayers",pathMatch:"full"},{path:"prayers",component:Ss,canActivate:[ht]},{path:"prayers/:id",component:Es,canActivate:[ht]},{path:"prayerTypes",component:Is,canActivate:[ht]},{path:"liturgicalTexts",component:Ds,canActivate:[ht]},{path:"liturgicalTexts/:id",component:As,canActivate:[ht]},{path:"sections",component:Rs,canActivate:[ht]},{path:"sections/:id",component:Vs,canActivate:[ht]},{path:"login",component:ks}];var g=function(n){return n.SEPARATOR="separator",n.PERCENT="percent",n.IP="IP",n.CPF_CNPJ="CPF_CNPJ",n.MONTH="M",n.MONTHS="M0",n.MINUTE="m",n.HOUR="h",n.HOURS="H",n.MINUTES="m0",n.HOURS_HOUR="Hh",n.SECONDS="s0",n.HOURS_MINUTES_SECONDS="Hh:m0:s0",n.EMAIL_MASK="A*@A*.A*",n.HOURS_MINUTES="Hh:m0",n.MINUTES_SECONDS="m0:s0",n.DAYS_MONTHS_YEARS="d0/M0/0000",n.DAYS_MONTHS="d0/M0",n.DAYS="d0",n.DAY="d",n.SECOND="s",n.LETTER_S="S",n.DOT=".",n.COMMA=",",n.CURLY_BRACKETS_LEFT="{",n.CURLY_BRACKETS_RIGHT="}",n.MINUS="-",n.OR="||",n.HASH="#",n.EMPTY_STRING="",n.SYMBOL_STAR="*",n.SYMBOL_QUESTION="?",n.SLASH="/",n.WHITE_SPACE=" ",n.NUMBER_ZERO="0",n.NUMBER_NINE="9",n.BACKSPACE="Backspace",n.DELETE="Delete",n.ARROW_LEFT="ArrowLeft",n.ARROW_UP="ArrowUp",n.DOUBLE_ZERO="00",n}(g||{}),Va=new G("ngx-mask config"),yu=new G("new ngx-mask config"),bu=new G("initial ngx-mask config"),a_={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:n=>n,outputTransformFn:n=>n,maskFilled:new fe,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},jw=[g.HOURS_MINUTES_SECONDS,g.HOURS_MINUTES,g.MINUTES_SECONDS],Uw=[g.PERCENT,g.HOURS_HOUR,g.SECONDS,g.MINUTES,g.SEPARATOR,g.DAYS_MONTHS_YEARS,g.DAYS_MONTHS,g.DAYS,g.MONTHS],l_=(()=>{class n{_config=A(Va);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression="";deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(e,t,r=0,s=!1,o=!1,l=()=>{}){if(!t||typeof e!="string")return g.EMPTY_STRING;let a=0,c="",u=!1,v=!1,x=1,w=!1,m=e,M=r;m.slice(0,this.prefix.length)===this.prefix&&(m=m.slice(this.prefix.length,m.length)),this.suffix&&m.length>0&&(m=this.checkAndRemoveSuffix(m)),m==="("&&this.prefix&&(m="");let F=m.toString().split(g.EMPTY_STRING);if(this.allowNegativeNumbers&&m.slice(a,a+1)===g.MINUS&&(c+=m.slice(a,a+1)),t===g.IP){let W=m.split(g.DOT);this.ipError=this._validIP(W),t="099.099.099.099"}let Z=[];for(let W=0;W<m.length;W++)m[W]?.match("\\d")&&Z.push(m[W]??g.EMPTY_STRING);if(t===g.CPF_CNPJ&&(this.cpfCnpjError=Z.length!==11&&Z.length!==14,Z.length>11?t="00.000.000/0000-00":t="000.000.000-00"),t.startsWith(g.PERCENT)){if(m.match("[a-z]|[A-Z]")||m.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!o){m=this._stripToDecimal(m);let ft=this.getPrecision(t);m=this.checkInputPrecision(m,ft,this.decimalMarker)}let W=typeof this.decimalMarker=="string"?this.decimalMarker:g.DOT;if(m.indexOf(W)>0&&!this.percentage(m.substring(0,m.indexOf(W)))){let ft=m.substring(0,m.indexOf(W)-1);this.allowNegativeNumbers&&m.slice(a,a+1)===g.MINUS&&!o&&(ft=m.substring(0,m.indexOf(W))),m=`${ft}${m.substring(m.indexOf(W),m.length)}`}let L="";this.allowNegativeNumbers&&m.slice(a,a+1)===g.MINUS?L=`${g.MINUS}${m.slice(a+1,a+m.length)}`:L=m,this.percentage(L)?c=this._splitPercentZero(m):c=this._splitPercentZero(m.substring(0,m.length-1))}else if(t.startsWith(g.SEPARATOR)){(m.match("[w\u0430-\u044F\u0410-\u042F]")||m.match("[\u0401\u0451\u0410-\u044F]")||m.match("[a-z]|[A-Z]")||m.match(/[-@#!$%\\^&*()_'+|~=`{}\]:";<>.?/]/)||m.match("[^A-Za-z0-9,]"))&&(m=this._stripToDecimal(m));let W=this.getPrecision(t),L=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?L=this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:L=this.decimalMarker.find(Q=>Q!==this.thousandSeparator)),o){let{decimalMarkerIndex:Q,nonZeroIndex:le}=this._findFirstNonZeroAndDecimalIndex(m,L),mt=m[0]===g.MINUS,lr=m[0]===g.NUMBER_ZERO,cr=m[0]===L,Gi=m[1]===L;(cr&&!le||mt&&Gi&&!le||lr&&!Q&&!le)&&(m=g.NUMBER_ZERO),Q&&le&&mt&&M===1&&(Q<le||Q>le)&&(m=g.MINUS+m.slice(le)),!Q&&le&&m.length>le&&(m=mt?g.MINUS+m.slice(le):m.slice(le)),Q&&le&&M===0&&(Q<le&&(m=m.slice(Q-1)),Q>le&&(m=m.slice(le)))}W===0?m=this.allowNegativeNumbers?m.length>2&&m[0]===g.MINUS&&m[1]===g.NUMBER_ZERO&&m[2]!==this.thousandSeparator&&m[2]!==g.COMMA&&m[2]!==g.DOT?"-"+m.slice(2,m.length):m[0]===g.NUMBER_ZERO&&m.length>1&&m[1]!==this.thousandSeparator&&m[1]!==g.COMMA&&m[1]!==g.DOT?m.slice(1,m.length):m:m.length>1&&m[0]===g.NUMBER_ZERO&&m[1]!==this.thousandSeparator&&m[1]!==g.COMMA&&m[1]!==g.DOT?m.slice(1,m.length):m:(m[0]===L&&m.length>1&&!o&&(m=g.NUMBER_ZERO+m.slice(0,m.length+1),this.plusOnePosition=!0),m[0]===g.NUMBER_ZERO&&m[1]!==L&&m[1]!==this.thousandSeparator&&!o&&(m=m.length>1?m.slice(0,1)+L+m.slice(1,m.length+1):m,this.plusOnePosition=!0),this.allowNegativeNumbers&&!o&&m[0]===g.MINUS&&(m[1]===L||m[1]===g.NUMBER_ZERO)&&(m=m[1]===L&&m.length>2?m.slice(0,1)+g.NUMBER_ZERO+m.slice(1,m.length):m[1]===g.NUMBER_ZERO&&m.length>2&&m[2]!==L?m.slice(0,2)+L+m.slice(2,m.length):m,this.plusOnePosition=!0));let ft=this._charToRegExpExpression(this.thousandSeparator),Re='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(ft,"");if(Array.isArray(this.decimalMarker))for(let Q of this.decimalMarker)Re=Re.replace(this._charToRegExpExpression(Q),g.EMPTY_STRING);else Re=Re.replace(this._charToRegExpExpression(this.decimalMarker),"");let ai=new RegExp("["+Re+"]");m.match(ai)&&(m=m.substring(0,m.length-1)),m=this.checkInputPrecision(m,W,this.decimalMarker);let Ut=m.replace(new RegExp(ft,"g"),"");c=this._formatWithSeparators(Ut,this.thousandSeparator,this.decimalMarker,W);let js=c.indexOf(g.COMMA)-m.indexOf(g.COMMA),Xe=c.length-m.length,ar=o&&c.length<e.length&&this.separatorLimit;if((c[M-1]===this.thousandSeparator||c[M-this.prefix.length])&&this.prefix&&o)M=M-1;else if(Xe>0&&c[M]!==this.thousandSeparator||ar){v=!0;let Q=0;do this._shift.add(M+Q),Q++;while(Q<Xe)}else c[M-1]===this.thousandSeparator||Xe===-4||Xe===-3||c[M]===this.thousandSeparator?(this._shift.clear(),this._shift.add(M-1)):js!==0&&M>0&&!(c.indexOf(g.COMMA)>=M&&M>3)||!(c.indexOf(g.DOT)>=M&&M>3)&&Xe<=0?(this._shift.clear(),v=!0,x=Xe,M+=Xe,this._shift.add(M)):this._shift.clear()}else for(let W=0,L=F[0];W<F.length&&a!==t.length;W++,L=F[W]??g.EMPTY_STRING){let ft=g.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(L,t[a]??g.EMPTY_STRING)&&t[a+1]===g.SYMBOL_QUESTION)c+=L,a+=2;else if(t[a+1]===g.SYMBOL_STAR&&u&&this._checkSymbolMask(L,t[a+2]??g.EMPTY_STRING))c+=L,a+=3,u=!1;else if(this._checkSymbolMask(L,t[a]??g.EMPTY_STRING)&&t[a+1]===g.SYMBOL_STAR&&!ft)c+=L,u=!0;else if(t[a+1]===g.SYMBOL_QUESTION&&this._checkSymbolMask(L,t[a+2]??g.EMPTY_STRING))c+=L,a+=3;else if(this._checkSymbolMask(L,t[a]??g.EMPTY_STRING)){if(t[a]===g.HOURS&&(this.apm?Number(L)>9:Number(L)>2)){M=this.leadZeroDateTime?M:M+1,a+=1,this._shiftStep(a),W--,this.leadZeroDateTime&&(c+="0");continue}if(t[a]===g.HOUR&&(this.apm?c.length===1&&Number(c)>1||c==="1"&&Number(L)>2||m.slice(a-1,a).length===1&&Number(m.slice(a-1,a))>2||m.slice(a-1,a)==="1"&&Number(L)>2:c==="2"&&Number(L)>3||(c.slice(a-2,a)==="2"||c.slice(a-3,a)==="2"||c.slice(a-4,a)==="2"||c.slice(a-1,a)==="2")&&Number(L)>3&&a>10)){M=M+1,a+=1,W--;continue}if((t[a]===g.MINUTE||t[a]===g.SECOND)&&Number(L)>5){M=this.leadZeroDateTime?M:M+1,a+=1,this._shiftStep(a),W--,this.leadZeroDateTime&&(c+="0");continue}let Re=31,ai=m[a],Ut=m[a+1],js=m[a+2],Xe=m[a-1],ar=m[a-2],Q=m.slice(a-3,a-1),le=m.slice(a-1,a+1),mt=m.slice(a,a+2),lr=m.slice(a-2,a);if(t[a]===g.DAY){let cr=t.slice(0,2)===g.MONTHS,Gi=t.slice(0,2)===g.MONTHS&&this.specialCharacters.includes(ar);if(Number(L)>3&&this.leadZeroDateTime||!cr&&(Number(mt)>Re||Number(le)>Re||this.specialCharacters.includes(Ut))||(Gi?Number(le)>Re||!this.specialCharacters.includes(ai)&&this.specialCharacters.includes(js)||this.specialCharacters.includes(ai):Number(mt)>Re||this.specialCharacters.includes(Ut)&&!o)){M=this.leadZeroDateTime?M:M+1,a+=1,this._shiftStep(a),W--,this.leadZeroDateTime&&(c+="0");continue}}if(t[a]===g.MONTH){let Gi=a===0&&(Number(L)>2||Number(mt)>12||this.specialCharacters.includes(Ut)&&!o),wu=t.slice(a+2,a+3),Cu=Q.includes(wu)&&t.includes("d0")&&(this.specialCharacters.includes(ar)&&Number(le)>12&&!this.specialCharacters.includes(ai)||this.specialCharacters.includes(ai)),Tu=Number(Q)<=Re&&!this.specialCharacters.includes(Q)&&this.specialCharacters.includes(Xe)&&(Number(mt)>12||this.specialCharacters.includes(Ut)),Eu=Number(mt)>12&&a===5||this.specialCharacters.includes(Ut)&&a===5,Mu=Number(Q)>Re&&!this.specialCharacters.includes(Q)&&!this.specialCharacters.includes(lr)&&Number(lr)>12&&t.includes("d0"),Iu=Number(Q)<=Re&&!this.specialCharacters.includes(Q)&&!this.specialCharacters.includes(Xe)&&Number(le)>12;if(Number(L)>1&&this.leadZeroDateTime||Gi||Cu||Iu||Mu||Tu||Eu&&!this.leadZeroDateTime){M=this.leadZeroDateTime?M:M+1,a+=1,this._shiftStep(a),W--,this.leadZeroDateTime&&(c+="0");continue}}c+=L,a++}else this.specialCharacters.includes(L)&&t[a]===L?(c+=L,a++):this.specialCharacters.indexOf(t[a]??g.EMPTY_STRING)!==-1?(c+=t[a],a++,this._shiftStep(a),W--):t[a]===g.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(a):this.patterns[t[a]??g.EMPTY_STRING]&&this.patterns[t[a]??g.EMPTY_STRING]?.optional?(F[a]&&t!=="099.099.099.099"&&t!=="000.000.000-00"&&t!=="00.000.000/0000-00"&&!t.match(/^9+\.0+$/)&&!this.patterns[t[a]??g.EMPTY_STRING]?.optional&&(c+=F[a]),t.includes(g.NUMBER_NINE+g.SYMBOL_STAR)&&t.includes(g.NUMBER_ZERO+g.SYMBOL_STAR)&&a++,a++,W--):this.maskExpression[a+1]===g.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[a+2]??g.EMPTY_STRING)&&this._findSpecialChar(L)===this.maskExpression[a+2]&&u||this.maskExpression[a+1]===g.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[a+2]??g.EMPTY_STRING)&&this._findSpecialChar(L)===this.maskExpression[a+2]&&u?(a+=3,c+=L):this.showMaskTyped&&this.specialCharacters.indexOf(L)<0&&L!==this.placeHolderCharacter&&this.placeHolderCharacter.length===1&&(w=!0)}c[M-1]&&c.length+1===t.length&&this.specialCharacters.indexOf(t[t.length-1]??g.EMPTY_STRING)!==-1&&(c+=t[t.length-1]);let Ee=M+1;for(;this._shift.has(Ee);)x++,Ee++;let _e=s&&!t.startsWith(g.SEPARATOR)?a:this._shift.has(M)?x:0;w&&_e--,l(_e,v),x<0&&this._shift.clear();let Me=!1;o&&(Me=F.every(W=>this.specialCharacters.includes(W)));let De=`${this.prefix}${Me?g.EMPTY_STRING:c}${this.showMaskTyped?"":this.suffix}`;c.length===0&&(De=this.instantPrefix?`${this.prefix}${c}`:`${c}`);let wt=m.length===1&&this.specialCharacters.includes(t[0])&&m!==t[0];if(!this._checkSymbolMask(m,t[1])&&wt)return"";if(c.includes(g.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(o&&c===g.MINUS)return"";De=`${g.MINUS}${this.prefix}${c.split(g.MINUS).join(g.EMPTY_STRING)}${this.suffix}`}return De}_findDropSpecialChar(e){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(t=>t===e):this._findSpecialChar(e)}_findSpecialChar(e){return this.specialCharacters.find(t=>t===e)}_checkSymbolMask(e,t){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[t]?.pattern&&this.patterns[t]?.pattern.test(e))??!1}_formatWithSeparators=(e,t,r,s)=>{let o=[],l="";if(Array.isArray(r)){let x=new RegExp(r.map(w=>"[\\^$.|?*+()".indexOf(w)>=0?`\\${w}`:w).join("|"));o=e.split(x),l=e.match(x)?.[0]??g.EMPTY_STRING}else o=e.split(r),l=r;let a=o.length>1?`${l}${o[1]}`:g.EMPTY_STRING,c=o[0]??g.EMPTY_STRING,u=this.separatorLimit.replace(/\s/g,g.EMPTY_STRING);u&&+u&&(c[0]===g.MINUS?c=`-${c.slice(1,c.length).slice(0,u.length)}`:c=c.slice(0,u.length));let v=/(\d+)(\d{3})/;for(;t&&v.test(c);)c=c.replace(v,"$1"+t+"$2");return typeof s>"u"?c+a:s===0?c:c+a.substring(0,s+1)};percentage=e=>{let t=e.replace(",","."),r=Number(this.allowNegativeNumbers&&e.includes(g.MINUS)?t.slice(1,e.length):t);return!isNaN(r)&&r>=0&&r<=100};getPrecision=e=>{let t=e.split(g.DOT);return t.length>1?Number(t[t.length-1]):1/0};checkAndRemoveSuffix=e=>{for(let t=this.suffix?.length-1;t>=0;t--){let r=this.suffix.substring(t,this.suffix?.length);if(e.includes(r)&&t!==this.suffix?.length-1&&(t-1<0||!e.includes(this.suffix.substring(t-1,this.suffix?.length))))return e.replace(r,g.EMPTY_STRING)}return e};checkInputPrecision=(e,t,r)=>{let s=e,o=r;if(t<1/0){if(Array.isArray(o)){let u=o.find(v=>v!==this.thousandSeparator);o=u||o[0]}let l=new RegExp(this._charToRegExpExpression(o)+`\\d{${t}}.*$`),a=s.match(l),c=(a&&a[0]?.length)??0;if(c-1>t){let u=c-1-t;s=s.substring(0,s.length-u)}t===0&&this._compareOrIncludes(s[s.length-1],o,this.thousandSeparator)&&(s=s.substring(0,s.length-1))}return s};_stripToDecimal(e){return e.split(g.EMPTY_STRING).filter((t,r)=>{let s=typeof this.decimalMarker=="string"?t===this.decimalMarker:this.decimalMarker.includes(t);return t.match("^-?\\d")||t===this.thousandSeparator||s||t===g.MINUS&&r===0&&this.allowNegativeNumbers}).join(g.EMPTY_STRING)}_charToRegExpExpression(e){return e&&(e===" "?"\\s":"[\\^$.|?*+()".indexOf(e)>=0?`\\${e}`:e)}_shiftStep(e){this._shift.add(e+this.prefix.length||0)}_compareOrIncludes(e,t,r){return Array.isArray(t)?t.filter(s=>s!==r).includes(e):e===t}_validIP(e){return!(e.length===4&&!e.some((t,r)=>e.length!==r+1?t===g.EMPTY_STRING||Number(t)>255:t===g.EMPTY_STRING||Number(t.substring(0,3))>255))}_splitPercentZero(e){if(e===g.MINUS&&this.allowNegativeNumbers)return e;let t=typeof this.decimalMarker=="string"?e.indexOf(this.decimalMarker):e.indexOf(g.DOT),r=this.allowNegativeNumbers&&e.includes(g.MINUS)?"-":"";if(t===-1){let s=parseInt(r?e.slice(1,e.length):e,10);return isNaN(s)?g.EMPTY_STRING:`${r}${s}`}else{let s=parseInt(e.replace("-","").substring(0,t),10),o=e.substring(t+1),l=isNaN(s)?"":s.toString(),a=typeof this.decimalMarker=="string"?this.decimalMarker:g.DOT;return l===g.EMPTY_STRING?g.EMPTY_STRING:`${r}${l}${a}${o}`}}_findFirstNonZeroAndDecimalIndex(e,t){let r=null,s=null;for(let o=0;o<e.length;o++){let l=e[o];if(l===t&&r===null&&(r=o),l&&l>="1"&&l<="9"&&s===null&&(s=o),r!==null&&s!==null)break}return{decimalMarkerIndex:r,nonZeroIndex:s}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),c_=(()=>{class n extends l_{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];triggerOnMaskChange=!1;previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=e=>{};_elementRef=A(Pe,{optional:!0});document=A(ye);_config=A(Va);_renderer=A(Ye,{optional:!0});applyMask(e,t,r=0,s=!1,o=!1,l=()=>{}){if(!t)return e!==this.actualValue?this.actualValue:e;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():g.EMPTY_STRING,this.maskExpression===g.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(e||g.HASH)),this.maskExpression===g.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(e||g.HASH)),!e&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;let a=e&&typeof this.selStart=="number"?e[this.selStart]??g.EMPTY_STRING:g.EMPTY_STRING,c="",u=r;if((this.hiddenInput||e&&e.indexOf(g.SYMBOL_STAR)>=0)&&!this.writingValue){let m=e&&e.length===1?e.split(g.EMPTY_STRING):this.actualValue.split(g.EMPTY_STRING);o&&(m=m.slice(0,r).concat(m.slice(r+1))),this.showMaskTyped&&(e=this.removeMask(e),m=this.removeMask(m.join("")).split(g.EMPTY_STRING)),typeof this.selStart=="object"&&typeof this.selEnd=="object"?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):e!==g.EMPTY_STRING&&m.length?typeof this.selStart=="number"&&typeof this.selEnd=="number"&&(e.length>m.length?m.splice(this.selStart,0,a):e.length<m.length&&(m.length-e.length===1?o?m.splice(this.selStart-1,1):m.splice(e.length-1,1):m.splice(this.selStart,this.selEnd-this.selStart))):m=[],this.showMaskTyped&&!this.hiddenInput&&(c=this.removeMask(e)),this.actualValue.length?m.length<e.length?c=this.shiftTypedSymbols(m.join(g.EMPTY_STRING)):m.length===e.length?c=m.join(g.EMPTY_STRING):c=e:c=e}if(s&&(this.hiddenInput||!this.hiddenInput)&&(c=e),o&&this.specialCharacters.indexOf(this.maskExpression[u]??g.EMPTY_STRING)!==-1&&this.showMaskTyped&&!this.prefix&&(c=this.currentValue),this.deletedSpecialCharacter&&u&&(this.specialCharacters.includes(this.actualValue.slice(u,u+1))?u=u+1:t.slice(u-1,u+1)!==g.MONTHS&&(u=u-2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&this.placeHolderCharacter.length===1&&!this.leadZeroDateTime&&(c=this.removeMask(c)),this.maskChanged?c=e:c=c&&c.length?c:e,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!s&&!this.writingValue){let m=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(m),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}let v=super.applyMask(c,t,u,s,o,l);if(this.actualValue=this.getActualValue(v),this.thousandSeparator===g.DOT&&this.decimalMarker===g.DOT&&(this.decimalMarker=g.COMMA),this.maskExpression.startsWith(g.SEPARATOR)&&this.dropSpecialCharacters===!0&&(this.specialCharacters=this.specialCharacters.filter(m=>!this._compareOrIncludes(m,this.decimalMarker,this.thousandSeparator))),(v||v==="")&&(this.previousValue=this.currentValue,this.currentValue=v,this._emitValue=this.previousValue!==this.currentValue||this.maskChanged||this.writingValue||this.previousValue===this.currentValue&&s),this._emitValue&&(this.writingValue&&this.triggerOnMaskChange?requestAnimationFrame(()=>this.formControlResult(v)):this.formControlResult(v)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(v,this.maskExpression)}${this.maskIsShown.slice(v.length)}`:v;let x=v.length,w=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(g.HOURS)){let m=this._numberSkipedSymbols(v);return`${v}${w.slice(x+m)}`}else if(this.maskExpression===g.IP||this.maskExpression===g.CPF_CNPJ)return`${v}${w}`;return`${v}${w.slice(x)}`}_numberSkipedSymbols(e){let t=/(^|\D)(\d\D)/g,r=t.exec(e),s=0;for(;r!=null;)s+=1,r=t.exec(e);return s}applyValueChanges(e,t,r,s=()=>{}){let o=this._elementRef?.nativeElement;o&&(o.value=this.applyMask(o.value,this.maskExpression,e,t,r,s),o!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(e,t){return e.split(g.EMPTY_STRING).map((r,s)=>this.patterns&&this.patterns[t[s]??g.EMPTY_STRING]&&this.patterns[t[s]??g.EMPTY_STRING]?.symbol?this.patterns[t[s]??g.EMPTY_STRING]?.symbol:r).join(g.EMPTY_STRING)}getActualValue(e){let t=e.split(g.EMPTY_STRING).filter((r,s)=>{let o=this.maskExpression[s]??g.EMPTY_STRING;return this._checkSymbolMask(r,o)||this.specialCharacters.includes(o)&&r===o});return t.join(g.EMPTY_STRING)===e?t.join(g.EMPTY_STRING):e}shiftTypedSymbols(e){let t="";return(e&&e.split(g.EMPTY_STRING).map((s,o)=>{if(this.specialCharacters.includes(e[o+1]??g.EMPTY_STRING)&&e[o+1]!==this.maskExpression[o+1])return t=s,e[o+1];if(t.length){let l=t;return t=g.EMPTY_STRING,l}return s})||[]).join(g.EMPTY_STRING)}numberToString(e){return!e&&e!==0||this.maskExpression.startsWith(g.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(g.SEPARATOR)&&this.separatorLimit.length>14&&String(e).length>14?String(e):Number(e).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${g.MINUS}/`,g.MINUS)}showMaskInInput(e){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}else if(this.showMaskTyped){if(e){if(this.maskExpression===g.IP)return this._checkForIp(e);if(this.maskExpression===g.CPF_CNPJ)return this._checkForCpfCnpj(e)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){let e=this._elementRef?.nativeElement;e&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==e.value.replace(this.placeHolderCharacter,g.EMPTY_STRING).length&&(this.formElementProperty=["value",g.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([e,t]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,e,t))}checkDropSpecialCharAmount(e){return e.split(g.EMPTY_STRING).filter(r=>this._findDropSpecialChar(r)).length}removeMask(e){return this._removeMask(this._removeSuffix(this._removePrefix(e)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(e){if(e===g.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;let t=[];for(let r=0;r<e.length;r++){let s=e[r]??g.EMPTY_STRING;s&&s.match("\\d")&&t.push(s)}return t.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:t.length>3&&t.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:t.length>6&&t.length<=9?this.placeHolderCharacter:(t.length>9&&t.length<=12,"")}_checkForCpfCnpj(e){let t=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,r=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(e===g.HASH)return t;let s=[];for(let o=0;o<e.length;o++){let l=e[o]??g.EMPTY_STRING;l&&l.match("\\d")&&s.push(l)}return s.length<=3?t.slice(s.length,t.length):s.length>3&&s.length<=6?t.slice(s.length+1,t.length):s.length>6&&s.length<=9?t.slice(s.length+2,t.length):s.length>9&&s.length<11?t.slice(s.length+3,t.length):s.length===11?"":s.length===12?e.length===17?r.slice(16,r.length):r.slice(15,r.length):s.length>12&&s.length<=14?r.slice(s.length+4,r.length):""}_getActiveElement(e=this.document){let t=e?.activeElement?.shadowRoot;return t?.activeElement?this._getActiveElement(t):e.activeElement}formControlResult(e){if(this.writingValue&&!e){this.onChange(this.outputTransformFn(null));return}if(this.writingValue||!this.triggerOnMaskChange&&this.maskChanged){this.triggerOnMaskChange&&this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(e)))))),this.writingValue=!1,this.maskChanged=!1;return}Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(e)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===e?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(e)))))):this.onChange(this.outputTransformFn(this._toNumber(e)))}_toNumber(e){if(!this.isNumberValue||e===g.EMPTY_STRING||this.maskExpression.startsWith(g.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return e;if(String(e).length>14&&this.maskExpression.startsWith(g.SEPARATOR))return String(e);let t=Number(e);if(this.maskExpression.startsWith(g.SEPARATOR)&&Number.isNaN(t)){let r=String(e).replace(",",".");return Number(r)}return Number.isNaN(t)?e:t}_removeMask(e,t){return this.maskExpression.startsWith(g.PERCENT)&&e.includes(g.DOT)?e:e&&e.replace(this._regExpForRemove(t),g.EMPTY_STRING)}_removePrefix(e){return this.prefix?e&&e.replace(this.prefix,g.EMPTY_STRING):e}_removeSuffix(e){return this.suffix?e&&e.replace(this.suffix,g.EMPTY_STRING):e}_retrieveSeparatorValue(e){let t=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(r=>this.dropSpecialCharacters.includes(r)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&e.includes(g.WHITE_SPACE)&&this.maskExpression.includes(g.SYMBOL_STAR)&&(t=t.filter(r=>r!==g.WHITE_SPACE)),this._removeMask(e,t)}_regExpForRemove(e){return new RegExp(e.map(t=>`\\${t}`).join("|"),"gi")}_replaceDecimalMarkerToDot(e){let t=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return e.replace(this._regExpForRemove(t),g.DOT)}_checkSymbols(e){let t=e;if(t===g.EMPTY_STRING)return t;this.maskExpression.startsWith(g.PERCENT)&&this.decimalMarker===g.COMMA&&(t=t.replace(g.COMMA,g.DOT));let r=this._retrieveSeparatorPrecision(this.maskExpression),s=this.specialCharacters.length===0?this._retrieveSeparatorValue(t):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(t));return this.isNumberValue&&r?t===this.decimalMarker?null:s.length>14?String(s):this._checkPrecision(this.maskExpression,s):s}_checkPatternForSpace(){for(let e in this.patterns)if(this.patterns[e]&&this.patterns[e]?.hasOwnProperty("pattern")){let t=this.patterns[e]?.pattern.toString(),r=this.patterns[e]?.pattern;if(t?.includes(g.WHITE_SPACE)&&r?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(e){let t=e.match(new RegExp("^separator\\.([^d]*)"));return t?Number(t[1]):null}_checkPrecision(e,t){let r=this.getPrecision(e),s=t;return e.indexOf("2")>0||this.leadZero&&Number(r)>0?(this.decimalMarker===g.COMMA&&this.leadZero&&(s=s.replace(",",".")),this.leadZero?Number(s).toFixed(Number(r)):Number(s).toFixed(2)):this.numberToString(s)}_repeatPatternSymbols(e){return e.match(/{[0-9]+}/)&&e.split(g.EMPTY_STRING).reduce((t,r,s)=>{if(this._start=r===g.CURLY_BRACKETS_LEFT?s:this._start,r!==g.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(r)?t+r:t;this._end=s;let o=Number(e.slice(this._start+1,this._end)),l=new Array(o+1).join(e[this._start-1]);if(e.slice(0,this._start).length>1&&e.includes(g.LETTER_S)){let a=e.slice(0,this._start-1);return a.includes(g.CURLY_BRACKETS_LEFT)?t+l:a+t+l}else return t+l},"")||e}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=We(n)))(r||n)}})();static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function d_(){let n=A(bu),i=A(yu);return i instanceof Function?E(E({},n),i()):E(E({},n),i)}function u_(n){return[{provide:yu,useValue:n},{provide:bu,useValue:a_},{provide:Va,useFactory:d_},c_]}function xu(n){return Bt(u_(n))}var h_="@",f_=(()=>{class n{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=A(tl,{optional:!0});loadingSchedulerFn=A(m_,{optional:!0});_engine;constructor(e,t,r,s,o){this.doc=e,this.delegate=t,this.zone=r,this.animationType=s,this.moduleImpl=o}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-ORBL6W3P.js").then(r=>r),t;return this.loadingSchedulerFn?t=this.loadingSchedulerFn(e):t=e(),t.catch(r=>{throw new ie(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(e,t){let r=this.delegate.createRenderer(e,t);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let s=new ja(r);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let l=o.createRenderer(e,t);s.use(l),this.scheduler?.notify(11)}).catch(o=>{s.use(r)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(t){pr()};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),ja=class{delegate;replay=[];\u0275type=1;constructor(i){this.delegate=i}use(i){if(this.delegate=i,this.replay!==null){for(let e of this.replay)e(i);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(i,e){return this.delegate.createElement(i,e)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}get destroyNode(){return this.delegate.destroyNode}appendChild(i,e){this.delegate.appendChild(i,e)}insertBefore(i,e,t,r){this.delegate.insertBefore(i,e,t,r)}removeChild(i,e,t){this.delegate.removeChild(i,e,t)}selectRootElement(i,e){return this.delegate.selectRootElement(i,e)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,e,t,r){this.delegate.setAttribute(i,e,t,r)}removeAttribute(i,e,t){this.delegate.removeAttribute(i,e,t)}addClass(i,e){this.delegate.addClass(i,e)}removeClass(i,e){this.delegate.removeClass(i,e)}setStyle(i,e,t,r){this.delegate.setStyle(i,e,t,r)}removeStyle(i,e,t){this.delegate.removeStyle(i,e,t)}setProperty(i,e,t){this.shouldReplay(e)&&this.replay.push(r=>r.setProperty(i,e,t)),this.delegate.setProperty(i,e,t)}setValue(i,e){this.delegate.setValue(i,e)}listen(i,e,t){return this.shouldReplay(e)&&this.replay.push(r=>r.listen(i,e,t)),this.delegate.listen(i,e,t)}shouldReplay(i){return this.replay!==null&&i.startsWith(h_)}},m_=new G("");function Su(n="animations"){return sl("NgAsyncAnimations"),Bt([{provide:gr,useFactory:(i,e,t)=>new f_(i,e,t,n),deps:[ye,wr,Ie]},{provide:Zs,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}function p_(n){return()=>n.initSession()}Ol(hs,{providers:[Ec(vu),xu(),{provide:Ji,useFactory:p_,deps:[ct],multi:!0},Su()]});export{p_ as initSessionFactory};
